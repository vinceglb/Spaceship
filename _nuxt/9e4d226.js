/*! For license information please see LICENSES */
(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{403:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return lr})),n.d(e,"b",(function(){return dr})),n.d(e,"c",(function(){return pr})),n.d(e,"d",(function(){return vr})),n.d(e,"e",(function(){return yr})),n.d(e,"f",(function(){return gr})),n.d(e,"g",(function(){return cr})),n.d(e,"h",(function(){return fr}));var r=function(t,b){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,b){t.__proto__=b}||function(t,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(t[p]=b[p])})(t,b)};function o(t){var s="function"==typeof Symbol&&Symbol.iterator,e=s&&t[s],i=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")}var c,h="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},f=f||{},l=h||self;function d(){}function v(a){var b=typeof a;return"array"==(b="object"!=b?b:a?Array.isArray(a)?"array":b:"null")||"object"==b&&"number"==typeof a.length}function y(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}var m="closure_uid_"+(1e9*Math.random()>>>0),w=0;function _(a,b,t){return a.call.apply(a.bind,arguments)}function E(a,b,t){if(!a)throw Error();if(2<arguments.length){var e=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,e),a.apply(b,t)}}return function(){return a.apply(b,arguments)}}function p(a,b,t){return(p=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?_:E).apply(null,arguments)}function I(a,b){var t=Array.prototype.slice.call(arguments,1);return function(){var e=t.slice();return e.push.apply(e,arguments),a.apply(this,e)}}function q(){return Date.now()}function O(a,b){function t(){}t.prototype=b.prototype,a.X=b.prototype,a.prototype=new t,a.prototype.constructor=a,a.Kb=function(t,e,n){for(var g=Array(arguments.length-2),r=2;r<arguments.length;r++)g[r-2]=arguments[r];return b.prototype[e].apply(t,g)}}function T(){this.j=this.j,this.i=this.i}T.prototype.j=!1,T.prototype.ja=function(){if(!this.j&&(this.j=!0,this.G(),0))(function(a){Object.prototype.hasOwnProperty.call(a,m)&&a[m]||(a[m]=++w)})(this)},T.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var j=Array.prototype.indexOf?function(a,b){return Array.prototype.indexOf.call(a,b,void 0)}:function(a,b){if("string"==typeof a)return"string"!=typeof b||1!=b.length?-1:a.indexOf(b,0);for(var t=0;t<a.length;t++)if(t in a&&a[t]===b)return t;return-1},N=Array.prototype.forEach?function(a,b,t){Array.prototype.forEach.call(a,b,t)}:function(a,b,t){for(var e=a.length,n="string"==typeof a?a.split(""):a,r=0;r<e;r++)r in n&&b.call(t,n[r],r,a)};function A(a){return Array.prototype.concat.apply([],arguments)}function S(a){var b=a.length;if(0<b){for(var t=Array(b),e=0;e<b;e++)t[e]=a[e];return t}return[]}function x(a){return/^[\s\xa0]*$/.test(a)}var D,k=String.prototype.trim?function(a){return a.trim()}:function(a){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(a)[1]};function P(a,b){return-1!=a.indexOf(b)}function C(a,b){return a<b?-1:a>b?1:0}t:{var R=l.navigator;if(R){var L=R.userAgent;if(L){D=L;break t}}D=""}function V(a,b,t){for(var e in a)b.call(t,a[e],e,a)}function M(a){var b={};for(var t in a)b[t]=a[t];return b}var U="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function F(a,b){for(var t,e,n=1;n<arguments.length;n++){for(t in e=arguments[n])a[t]=e[t];for(var r=0;r<U.length;r++)t=U[r],Object.prototype.hasOwnProperty.call(e,t)&&(a[t]=e[t])}}function z(a){return z[" "](a),a}z[" "]=d;var B,a,G=P(D,"Opera"),H=P(D,"Trident")||P(D,"MSIE"),Q=P(D,"Edge"),Y=Q||H,K=P(D,"Gecko")&&!(P(D.toLowerCase(),"webkit")&&!P(D,"Edge"))&&!(P(D,"Trident")||P(D,"MSIE"))&&!P(D,"Edge"),X=P(D.toLowerCase(),"webkit")&&!P(D,"Edge");function W(){var a=l.document;return a?a.documentMode:void 0}t:{var J="",Z=(a=D,K?/rv:([^\);]+)(\)|;)/.exec(a):Q?/Edge\/([\d\.]+)/.exec(a):H?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a):X?/WebKit\/(\S+)/.exec(a):G?/(?:Version)[ \/]?(\S+)/.exec(a):void 0);if(Z&&(J=Z?Z[1]:""),H){var $=W();if(null!=$&&$>parseFloat(J)){B=String($);break t}}B=J}var tt,et={};function nt(a){return function(a,b){var t=et;return Object.prototype.hasOwnProperty.call(t,a)?t[a]:t[a]=b(a)}(a,(function(){for(var b=0,t=k(String(B)).split("."),e=k(String(a)).split("."),g=Math.max(t.length,e.length),n=0;0==b&&n<g;n++){var r=t[n]||"",o=e[n]||"";do{if(r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==r[0].length&&0==o[0].length)break;b=C(0==r[1].length?0:parseInt(r[1],10),0==o[1].length?0:parseInt(o[1],10))||C(0==r[2].length,0==o[2].length)||C(r[2],o[2]),r=r[3],o=o[3]}while(0==b)}return 0<=b}))}if(l.document&&H){var it=W();tt=it||(parseInt(B,10)||void 0)}else tt=void 0;var ot=tt,st=!H||9<=Number(ot),ut=H&&!nt("9"),at=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},"passive",{get:function(){a=!0}});try{l.addEventListener("test",d,b),l.removeEventListener("test",d,b)}catch(t){}return a}();function ct(a,b){this.type=a,this.a=this.target=b,this.defaultPrevented=!1}function ht(a,b){if(ct.call(this,a?a.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,a){var t=this.type=a.type,e=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.a=b,b=a.relatedTarget){if(K){t:{try{z(b.nodeName);var n=!0;break t}catch(t){}n=!1}n||(b=null)}}else"mouseover"==t?b=a.fromElement:"mouseout"==t&&(b=a.toElement);this.relatedTarget=b,e?(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0):(this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType="string"==typeof a.pointerType?a.pointerType:ft[a.pointerType]||"",this.c=a,a.defaultPrevented&&this.b()}}ct.prototype.b=function(){this.defaultPrevented=!0},O(ht,ct);var ft={2:"touch",3:"pen",4:"mouse"};ht.prototype.b=function(){ht.X.b.call(this);var a=this.c;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,ut)try{(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)&&(a.keyCode=-1)}catch(t){}};var lt="closure_listenable_"+(1e6*Math.random()|0),pt=0;function vt(a,b,t,e,n){this.listener=a,this.proxy=null,this.src=b,this.type=t,this.capture=!!e,this.ca=n,this.key=++pt,this.Y=this.Z=!1}function yt(a){a.Y=!0,a.listener=null,a.proxy=null,a.src=null,a.ca=null}function gt(a){this.src=a,this.a={},this.b=0}function bt(a,b){var t=b.type;if(t in a.a){var e,n=a.a[t],r=j(n,b);(e=0<=r)&&Array.prototype.splice.call(n,r,1),e&&(yt(b),0==a.a[t].length&&(delete a.a[t],a.b--))}}function mt(a,b,t,e){for(var n=0;n<a.length;++n){var r=a[n];if(!r.Y&&r.listener==b&&r.capture==!!t&&r.ca==e)return n}return-1}gt.prototype.add=function(a,b,t,e,n){var r=a.toString();(a=this.a[r])||(a=this.a[r]=[],this.b++);var g=mt(a,b,e,n);return-1<g?(b=a[g],t||(b.Z=!1)):((b=new vt(b,this.src,r,!!e,n)).Z=t,a.push(b)),b};var wt="closure_lm_"+(1e6*Math.random()|0),_t={};function Et(a,b,t,e,n){if(e&&e.once)return Ot(a,b,t,e,n);if(Array.isArray(b)){for(var r=0;r<b.length;r++)Et(a,b[r],t,e,n);return null}return t=kt(t),a&&a[lt]?a.va(b,t,y(e)?!!e.capture:!!e,n):It(a,b,t,!1,e,n)}function It(a,b,t,e,n,r){if(!b)throw Error("Invalid event type");var g=y(n)?!!n.capture:!!n;if(g&&!st)return null;var o=xt(a);if(o||(a[wt]=o=new gt(a)),(t=o.add(b,t,e,g,r)).proxy)return t;if(e=function(){var a=St,b=st?function(t){return a.call(b.src,b.listener,t)}:function(t){if(!(t=a.call(b.src,b.listener,t)))return t};return b}(),t.proxy=e,e.src=a,e.listener=t,a.addEventListener)at||(n=g),void 0===n&&(n=!1),a.addEventListener(b.toString(),e,n);else if(a.attachEvent)a.attachEvent(Nt(b.toString()),e);else{if(!a.addListener||!a.removeListener)throw Error("addEventListener and attachEvent are unavailable.");a.addListener(e)}return t}function Ot(a,b,t,e,n){if(Array.isArray(b)){for(var r=0;r<b.length;r++)Ot(a,b[r],t,e,n);return null}return t=kt(t),a&&a[lt]?a.wa(b,t,y(e)?!!e.capture:!!e,n):It(a,b,t,!0,e,n)}function Tt(a,b,t,e,n){if(Array.isArray(b))for(var r=0;r<b.length;r++)Tt(a,b[r],t,e,n);else e=y(e)?!!e.capture:!!e,t=kt(t),a&&a[lt]?(a=a.c,(b=String(b).toString())in a.a&&(-1<(t=mt(r=a.a[b],t,e,n))&&(yt(r[t]),Array.prototype.splice.call(r,t,1),0==r.length&&(delete a.a[b],a.b--)))):a&&(a=xt(a))&&(b=a.a[b.toString()],a=-1,b&&(a=mt(b,t,e,n)),(t=-1<a?b[a]:null)&&jt(t))}function jt(a){if("number"!=typeof a&&a&&!a.Y){var b=a.src;if(b&&b[lt])bt(b.c,a);else{var t=a.type,e=a.proxy;b.removeEventListener?b.removeEventListener(t,e,a.capture):b.detachEvent?b.detachEvent(Nt(t),e):b.addListener&&b.removeListener&&b.removeListener(e),(t=xt(b))?(bt(t,a),0==t.b&&(t.src=null,b[wt]=null)):yt(a)}}}function Nt(a){return a in _t?_t[a]:_t[a]="on"+a}function At(a,b){var t=a.listener,e=a.ca||a.src;return a.Z&&jt(a),t.call(e,b)}function St(a,b){if(a.Y)return!0;if(!st){if(!b)t:{b=["window","event"];for(var t=l,e=0;e<b.length;e++)if(null==(t=t[b[e]])){b=null;break t}b=t}return At(a,b=new ht(b,this))}return At(a,new ht(b,this))}function xt(a){return(a=a[wt])instanceof gt?a:null}var Dt="__closure_events_fn_"+(1e9*Math.random()>>>0);function kt(a){return"function"==typeof a?a:(a[Dt]||(a[Dt]=function(b){return a.handleEvent(b)}),a[Dt])}function Pt(){T.call(this),this.c=new gt(this),this.J=this,this.C=null}function Ct(a,b){var t,e=a.C;if(e)for(t=[];e;e=e.C)t.push(e);if(a=a.J,e=b.type||b,"string"==typeof b)b=new ct(b,a);else if(b instanceof ct)b.target=b.target||a;else{var n=b;F(b=new ct(e,a),n)}if(n=!0,t)for(var r=t.length-1;0<=r;r--){var g=b.a=t[r];n=Rt(g,e,!0,b)&&n}if(n=Rt(g=b.a=a,e,!0,b)&&n,n=Rt(g,e,!1,b)&&n,t)for(r=0;r<t.length;r++)n=Rt(g=b.a=t[r],e,!1,b)&&n}function Rt(a,b,t,e){if(!(b=a.c.a[String(b)]))return!0;b=b.concat();for(var n=!0,r=0;r<b.length;++r){var g=b[r];if(g&&!g.Y&&g.capture==t){var o=g.listener,c=g.ca||g.src;g.Z&&bt(a.c,g),n=!1!==o.call(c,e)&&n}}return n&&!e.defaultPrevented}O(Pt,T),Pt.prototype[lt]=!0,(c=Pt.prototype).addEventListener=function(a,b,t,e){Et(this,a,b,t,e)},c.removeEventListener=function(a,b,t,e){Tt(this,a,b,t,e)},c.G=function(){if(Pt.X.G.call(this),this.c){var t,a=this.c;for(t in a.a){for(var e=a.a[t],n=0;n<e.length;n++)yt(e[n]);delete a.a[t],a.b--}}this.C=null},c.va=function(a,b,t,e){return this.c.add(String(a),b,!1,t,e)},c.wa=function(a,b,t,e){return this.c.add(String(a),b,!0,t,e)};var Lt=l.JSON.stringify;function Vt(){this.b=this.a=null}var Mt,Ut=new(function(){function t(a,b){this.c=a,this.f=b,this.b=0,this.a=null}return t.prototype.get=function(){var a;return 0<this.b?(this.b--,a=this.a,this.a=a.next,a.next=null):a=this.c(),a},t}())((function(){return new qt}),(function(a){a.reset()}));function Ft(){var a=Ht,b=null;return a.a&&(b=a.a,a.a=a.a.next,a.a||(a.b=null),b.next=null),b}function qt(){this.next=this.b=this.a=null}function zt(a){l.setTimeout((function(){throw a}),0)}function Bt(a,b){Mt||function(){var a=l.Promise.resolve(void 0);Mt=function(){a.then(Qt)}}(),Gt||(Mt(),Gt=!0),Ht.add(a,b)}Vt.prototype.add=function(a,b){var t=Ut.get();t.set(a,b),this.b?this.b.next=t:this.a=t,this.b=t},qt.prototype.set=function(a,b){this.a=a,this.b=b,this.next=null},qt.prototype.reset=function(){this.next=this.b=this.a=null};var Gt=!1,Ht=new Vt;function Qt(){for(var a;a=Ft();){try{a.a.call(a.b)}catch(t){zt(t)}var b=Ut;b.f(a),100>b.b&&(b.b++,a.next=b.a,b.a=a)}Gt=!1}function Yt(a,b){Pt.call(this),this.b=a||1,this.a=b||l,this.f=p(this.Za,this),this.g=q()}function Kt(a){a.aa=!1,a.M&&(a.a.clearTimeout(a.M),a.M=null)}function Xt(a,b,t){if("function"==typeof a)t&&(a=p(a,t));else{if(!a||"function"!=typeof a.handleEvent)throw Error("Invalid listener argument");a=p(a.handleEvent,a)}return 2147483647<Number(b)?-1:l.setTimeout(a,b||0)}function Wt(a){a.a=Xt((function(){a.a=null,a.c&&(a.c=!1,Wt(a))}),a.h);var b=a.b;a.b=null,a.g.apply(null,b)}O(Yt,Pt),(c=Yt.prototype).aa=!1,c.M=null,c.Za=function(){if(this.aa){var a=q()-this.g;0<a&&a<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-a):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Ct(this,"tick"),this.aa&&(Kt(this),this.start()))}},c.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=q())},c.G=function(){Yt.X.G.call(this),Kt(this),delete this.a};var Jt=function(t){function e(a,b){var e=t.call(this)||this;return e.g=a,e.h=b,e.b=null,e.c=!1,e.a=null,e}return function(t,b){function e(){this.constructor=t}r(t,b),t.prototype=null===b?Object.create(b):(e.prototype=b.prototype,new e)}(e,t),e.prototype.f=function(a){this.b=arguments,this.a?this.c=!0:Wt(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(l.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(T);function Zt(a){T.call(this),this.b=a,this.a={}}O(Zt,T);var $t=[];function te(a,b,t,e){Array.isArray(t)||(t&&($t[0]=t.toString()),t=$t);for(var n=0;n<t.length;n++){var r=Et(b,t[n],e||a.handleEvent,!1,a.b||a);if(!r)break;a.a[r.key]=r}}function ee(a){V(a.a,(function(b,t){this.a.hasOwnProperty(t)&&jt(b)}),a),a.a={}}function ne(){this.a=!0}function re(a,b,t,e){a.info((function(){return"XMLHTTP TEXT ("+b+"): "+function(a,b){if(!a.a)return b;if(!b)return null;try{var t=JSON.parse(b);if(t)for(a=0;a<t.length;a++)if(Array.isArray(t[a])){var e=t[a];if(!(2>e.length)){var n=e[1];if(Array.isArray(n)&&!(1>n.length)){var r=n[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var g=1;g<n.length;g++)n[g]=""}}}return Lt(t)}catch(t){return b}}(a,t)+(e?" "+e:"")}))}Zt.prototype.G=function(){Zt.X.G.call(this),ee(this)},Zt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ne.prototype.info=function(){};var ie={},oe=null;function se(){return oe=oe||new Pt}function ue(a){ct.call(this,ie.Fa,a)}function ae(a){var b=se();Ct(b,new ue(b,a))}function ce(a,b){ct.call(this,ie.STAT_EVENT,a),this.stat=b}function he(a){var b=se();Ct(b,new ce(b,a))}function fe(a){ct.call(this,ie.Ga,a)}function le(a,b){if("function"!=typeof a)throw Error("Fn must not be null and must be a function");return l.setTimeout((function(){a()}),b)}ie.Fa="serverreachability",O(ue,ct),ie.STAT_EVENT="statevent",O(ce,ct),ie.Ga="timingevent",O(fe,ct);var pe={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},de={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function ve(){}function ye(a){var b;return(b=a.a)||(b=a.a={}),b}function ge(){}ve.prototype.a=null;var be,me={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function we(){ct.call(this,"d")}function _e(){ct.call(this,"c")}function Ee(){}function Ie(a,b,t,e){this.g=a,this.c=b,this.f=t,this.S=e||1,this.J=new Zt(this),this.P=Oe,a=Y?125:void 0,this.R=new Yt(a),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}O(we,ct),O(_e,ct),O(Ee,ve),be=new Ee;var Oe=45e3,Te={},je={};function Ne(a,b,t){a.H=1,a.i=Xe(Be(b)),a.j=t,a.I=!0,Ae(a,null)}function Ae(a,b){a.u=q(),De(a),a.l=Be(a.i);var t=a.l,e=a.S;Array.isArray(e)||(e=[String(e)]),an(t.b,"t",e),a.D=0,a.a=nr(a.g,a.g.C?b:null),0<a.O&&(a.F=new Jt(p(a.Ca,a,a.a),a.O)),te(a.J,a.a,"readystatechange",a.Xa),b=a.B?M(a.B):{},a.j?(a.m||(a.m="POST"),b["Content-Type"]="application/x-www-form-urlencoded",a.a.ba(a.l,a.m,a.j,b)):(a.m="GET",a.a.ba(a.l,a.m,null,b)),ae(1),function(a,b,t,e,n,r){a.info((function(){if(a.a)if(r)for(var g="",o=r.split("&"),c=0;c<o.length;c++){var u=o[c].split("=");if(1<u.length){var h=u[0];u=u[1];var f=h.split("_");g=2<=f.length&&"type"==f[1]?g+(h+"=")+u+"&":g+(h+"=redacted&")}}else g=null;else g=r;return"XMLHTTP REQ ("+e+") [attempt "+n+"]: "+b+"\n"+t+"\n"+g}))}(a.c,a.m,a.l,a.f,a.S,a.j)}function Se(a,b,t){for(var e=!0;!a.A&&a.D<t.length;){var n=xe(a,t);if(n==je){4==b&&(a.h=4,he(14),e=!1),re(a.c,a.f,null,"[Incomplete Response]");break}if(n==Te){a.h=4,he(15),re(a.c,a.f,t,"[Invalid Chunk]"),e=!1;break}re(a.c,a.f,n,null),Le(a,n)}4==b&&0==t.length&&(a.h=1,he(16),e=!1),a.b=a.b&&e,e?0<t.length&&!a.V&&(a.V=!0,(b=a.g).a==a&&b.U&&!b.F&&(b.c.info("Great, no buffering proxy detected. Bytes received: "+t.length),Yn(b),b.F=!0,he(11))):(re(a.c,a.f,t,"[Invalid Chunked Response]"),Re(a),Ce(a))}function xe(a,b){var t=a.D,e=b.indexOf("\n",t);return-1==e?je:(t=Number(b.substring(t,e)),isNaN(t)?Te:(e+=1)+t>b.length?je:(b=b.substr(e,t),a.D=e+t,b))}function De(a){a.T=q()+a.P,ke(a,a.P)}function ke(a,b){if(null!=a.o)throw Error("WatchDog timer not null");a.o=le(p(a.Va,a),b)}function Pe(a){a.o&&(l.clearTimeout(a.o),a.o=null)}function Ce(a){0==a.g.v||a.A||Wn(a.g,a)}function Re(a){Pe(a);var b=a.F;b&&"function"==typeof b.ja&&b.ja(),a.F=null,Kt(a.R),ee(a.J),a.a&&(b=a.a,a.a=null,b.abort(),b.ja())}function Le(a,b){try{var t=a.g;if(0!=t.v&&(t.a==a||vn(t.b,a)))if(t.I=a.N,!a.C&&vn(t.b,a)&&3==t.v){try{var e=t.ka.a.parse(b)}catch(t){e=null}if(Array.isArray(e)&&3==e.length){var n=e;if(0==n[0]){t:if(!t.j){if(t.a){if(!(t.a.u+3e3<a.u))break t;Xn(t),Mn(t)}Qn(t),he(18)}}else t.oa=n[1],0<t.oa-t.P&&37500>n[2]&&t.H&&0==t.o&&!t.m&&(t.m=le(p(t.Sa,t),6e3));if(1>=dn(t.b)&&t.ea){try{t.ea()}catch(t){}t.ea=void 0}}else Zn(t,11)}else if((a.C||t.a==a)&&Xn(t),!x(b))for(b=e=t.ka.a.parse(b),e=0;e<b.length;e++)if(n=b[e],t.P=n[0],n=n[1],2==t.v)if("c"==n[0]){t.J=n[1],t.ga=n[2];var r=n[3];null!=r&&(t.ha=r,t.c.info("VER="+t.ha));var g=n[4];null!=g&&(t.pa=g,t.c.info("SVER="+t.pa));var o=n[5];if(null!=o&&"number"==typeof o&&0<o){var c=1.5*o;t.D=c,t.c.info("backChannelRequestTimeoutMs_="+c)}c=t;var u=a.a;if(u){var h=u.a?u.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var f=c.b;!f.a&&(P(h,"spdy")||P(h,"quic")||P(h,"h2"))&&(f.f=f.g,f.a=new Set,f.b&&(yn(f,f.b),f.b=null))}if(c.A){var l=u.a?u.a.getResponseHeader("X-HTTP-Session-Id"):null;l&&(c.na=l,Ke(c.B,c.A,l))}}t.v=3,t.f&&t.f.ta(),t.U&&(t.N=q()-a.u,t.c.info("Handshake RTT: "+t.N+"ms"));var d=a;if((c=t).la=er(c,c.C?c.ga:null,c.fa),d.C){gn(c.b,d);var v=d,y=c.D;y&&v.setTimeout(y),v.o&&(Pe(v),De(v)),c.a=d}else Hn(c);0<t.g.length&&qn(t)}else"stop"!=n[0]&&"close"!=n[0]||Zn(t,7);else 3==t.v&&("stop"==n[0]||"close"==n[0]?"stop"==n[0]?Zn(t,7):Vn(t):"noop"!=n[0]&&t.f&&t.f.sa(n),t.o=0);ae(4)}catch(t){}}function Ve(a,b){if(a.forEach&&"function"==typeof a.forEach)a.forEach(b,void 0);else if(v(a)||"string"==typeof a)N(a,b,void 0);else{if(a.L&&"function"==typeof a.L)var t=a.L();else if(a.K&&"function"==typeof a.K)t=void 0;else if(v(a)||"string"==typeof a){t=[];for(var e=a.length,n=0;n<e;n++)t.push(n)}else for(n in t=[],e=0,a)t[e++]=n;n=(e=function(a){if(a.K&&"function"==typeof a.K)return a.K();if("string"==typeof a)return a.split("");if(v(a)){for(var b=[],t=a.length,e=0;e<t;e++)b.push(a[e]);return b}for(e in b=[],t=0,a)b[t++]=a[e];return b}(a)).length;for(var r=0;r<n;r++)b.call(void 0,e[r],t&&t[r],a)}}function Me(a,b){this.b={},this.a=[],this.c=0;var t=arguments.length;if(1<t){if(t%2)throw Error("Uneven number of arguments");for(var e=0;e<t;e+=2)this.set(arguments[e],arguments[e+1])}else if(a)if(a instanceof Me)for(t=a.L(),e=0;e<t.length;e++)this.set(t[e],a.get(t[e]));else for(e in a)this.set(e,a[e])}function Ue(a){if(a.c!=a.a.length){for(var b=0,t=0;b<a.a.length;){var e=a.a[b];Fe(a.b,e)&&(a.a[t++]=e),b++}a.a.length=t}if(a.c!=a.a.length){var n={};for(t=b=0;b<a.a.length;)Fe(n,e=a.a[b])||(a.a[t++]=e,n[e]=1),b++;a.a.length=t}}function Fe(a,b){return Object.prototype.hasOwnProperty.call(a,b)}(c=Ie.prototype).setTimeout=function(a){this.P=a},c.Xa=function(a){a=a.target;var b=this.F;b&&3==Pn(a)?b.f():this.Ca(a)},c.Ca=function(a){try{if(a==this.a)t:{var b=Pn(this.a),t=this.a.ua(),e=this.a.W();if(!(3>b||3==b&&!Y&&!this.a.$())){this.A||4!=b||7==t||ae(8==t||0>=e?3:2),Pe(this);var n=this.a.W();this.N=n;var r=this.a.$();if(this.b=200==n,function(a,b,t,e,n,r,g){a.info((function(){return"XMLHTTP RESP ("+e+") [ attempt "+n+"]: "+b+"\n"+t+"\n"+r+" "+g}))}(this.c,this.m,this.l,this.f,this.S,b,n),this.b){if(this.U&&!this.C){e:{if(this.a){var g,o=this.a;if((g=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!x(g)){var c=g;break e}}c=null}if(!c){this.b=!1,this.h=3,he(12),Re(this),Ce(this);break t}re(this.c,this.f,c,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Le(this,c)}this.I?(Se(this,b,r),Y&&this.b&&3==b&&(te(this.J,this.R,"tick",this.Wa),this.R.start())):(re(this.c,this.f,r,null),Le(this,r)),4==b&&Re(this),this.b&&!this.A&&(4==b?Wn(this.g,this):(this.b=!1,De(this)))}else 400==n&&0<r.indexOf("Unknown SID")?(this.h=3,he(12)):(this.h=0,he(13)),Re(this),Ce(this)}}}catch(t){}},c.Wa=function(){if(this.a){var a=Pn(this.a),b=this.a.$();this.D<b.length&&(Pe(this),Se(this,a,b),this.b&&4!=a&&De(this))}},c.cancel=function(){this.A=!0,Re(this)},c.Va=function(){this.o=null;var a=q();0<=a-this.T?(function(a,b){a.info((function(){return"TIMEOUT: "+b}))}(this.c,this.l),2!=this.H&&(ae(3),he(17)),Re(this),this.h=2,Ce(this)):ke(this,this.T-a)},(c=Me.prototype).K=function(){Ue(this);for(var a=[],b=0;b<this.a.length;b++)a.push(this.b[this.a[b]]);return a},c.L=function(){return Ue(this),this.a.concat()},c.get=function(a,b){return Fe(this.b,a)?this.b[a]:b},c.set=function(a,b){Fe(this.b,a)||(this.c++,this.a.push(a)),this.b[a]=b},c.forEach=function(a,b){for(var t=this.L(),e=0;e<t.length;e++){var n=t[e],r=this.get(n);a.call(b,r,n,this)}};var qe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function ze(a,b){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,a instanceof ze){this.a=void 0!==b?b:a.a,Ge(this,a.f),this.j=a.j,He(this,a.c),Qe(this,a.h),this.g=a.g,b=a.b;var t=new rn;t.c=b.c,b.a&&(t.a=new Me(b.a),t.b=b.b),Ye(this,t),this.i=a.i}else a&&(t=String(a).match(qe))?(this.a=!!b,Ge(this,t[1]||"",!0),this.j=We(t[2]||""),He(this,t[3]||"",!0),Qe(this,t[4]),this.g=We(t[5]||"",!0),Ye(this,t[6]||"",!0),this.i=We(t[7]||"")):(this.a=!!b,this.b=new rn(null,this.a))}function Be(a){return new ze(a)}function Ge(a,b,t){a.f=t?We(b,!0):b,a.f&&(a.f=a.f.replace(/:$/,""))}function He(a,b,t){a.c=t?We(b,!0):b}function Qe(a,b){if(b){if(b=Number(b),isNaN(b)||0>b)throw Error("Bad port number "+b);a.h=b}else a.h=null}function Ye(a,b,t){b instanceof rn?(a.b=b,function(a,b){b&&!a.f&&(on(a),a.c=null,a.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(sn(this,e),an(this,n,t))}),a)),a.f=b}(a.b,a.a)):(t||(b=Je(b,en)),a.b=new rn(b,a.a))}function Ke(a,b,t){a.b.set(b,t)}function Xe(a){return Ke(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^q()).toString(36)),a}function We(a,b){return a?b?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function Je(a,b,t){return"string"==typeof a?(a=encodeURI(a).replace(b,dd),t&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function dd(a){return"%"+((a=a.charCodeAt(0))>>4&15).toString(16)+(15&a).toString(16)}ze.prototype.toString=function(){var a=[],b=this.f;b&&a.push(Je(b,Ze,!0),":");var t=this.c;return(t||"file"==b)&&(a.push("//"),(b=this.j)&&a.push(Je(b,Ze,!0),"@"),a.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.h)&&a.push(":",String(t))),(t=this.g)&&(this.c&&"/"!=t.charAt(0)&&a.push("/"),a.push(Je(t,"/"==t.charAt(0)?tn:$e,!0))),(t=this.b.toString())&&a.push("?",t),(t=this.i)&&a.push("#",Je(t,nn)),a.join("")};var Ze=/[#\/\?@]/g,$e=/[#\?:]/g,tn=/[#\?]/g,en=/[#\?@]/g,nn=/#/g;function rn(a,b){this.b=this.a=null,this.c=a||null,this.f=!!b}function on(a){a.a||(a.a=new Me,a.b=0,a.c&&function(a,b){if(a){a=a.split("&");for(var t=0;t<a.length;t++){var e=a[t].indexOf("="),n=null;if(0<=e){var r=a[t].substring(0,e);n=a[t].substring(e+1)}else r=a[t];b(r,n?decodeURIComponent(n.replace(/\+/g," ")):"")}}}(a.c,(function(b,t){a.add(decodeURIComponent(b.replace(/\+/g," ")),t)})))}function sn(a,b){on(a),b=cn(a,b),Fe(a.a.b,b)&&(a.c=null,a.b-=a.a.get(b).length,Fe((a=a.a).b,b)&&(delete a.b[b],a.c--,a.a.length>2*a.c&&Ue(a)))}function un(a,b){return on(a),b=cn(a,b),Fe(a.a.b,b)}function an(a,b,t){sn(a,b),0<t.length&&(a.c=null,a.a.set(cn(a,b),S(t)),a.b+=t.length)}function cn(a,b){return b=String(b),a.f&&(b=b.toLowerCase()),b}(c=rn.prototype).add=function(a,b){on(this),this.c=null,a=cn(this,a);var t=this.a.get(a);return t||this.a.set(a,t=[]),t.push(b),this.b+=1,this},c.forEach=function(a,b){on(this),this.a.forEach((function(t,e){N(t,(function(t){a.call(b,t,e,this)}),this)}),this)},c.L=function(){on(this);for(var a=this.a.K(),b=this.a.L(),t=[],e=0;e<b.length;e++)for(var n=a[e],r=0;r<n.length;r++)t.push(b[e]);return t},c.K=function(a){on(this);var b=[];if("string"==typeof a)un(this,a)&&(b=A(b,this.a.get(cn(this,a))));else{a=this.a.K();for(var t=0;t<a.length;t++)b=A(b,a[t])}return b},c.set=function(a,b){return on(this),this.c=null,un(this,a=cn(this,a))&&(this.b-=this.a.get(a).length),this.a.set(a,[b]),this.b+=1,this},c.get=function(a,b){return a&&0<(a=this.K(a)).length?String(a[0]):b},c.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var a=[],b=this.a.L(),t=0;t<b.length;t++){var e=b[t],n=encodeURIComponent(String(e));e=this.K(e);for(var r=0;r<e.length;r++){var g=n;""!==e[r]&&(g+="="+encodeURIComponent(String(e[r]))),a.push(g)}}return this.c=a.join("&")};var hn=function(a,b){this.b=a,this.a=b};function fn(a){this.g=a||ln,l.PerformanceNavigationTiming?a=0<(a=l.performance.getEntriesByType("navigation")).length&&("hq"==a[0].nextHopProtocol||"h2"==a[0].nextHopProtocol):a=!!(l.ia&&l.ia.ya&&l.ia.ya()&&l.ia.ya().Lb),this.f=a?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var ln=10;function pn(a){return!!a.b||!!a.a&&a.a.size>=a.f}function dn(a){return a.b?1:a.a?a.a.size:0}function vn(a,b){return a.b?a.b==b:!!a.a&&a.a.has(b)}function yn(a,b){a.a?a.a.add(b):a.b=b}function gn(a,b){a.b&&a.b==b?a.b=null:a.a&&a.a.has(b)&&a.a.delete(b)}function bn(a){var t,e;if(null!=a.b)return a.c.concat(a.b.s);if(null!=a.a&&0!==a.a.size){var b=a.c;try{for(var n=o(a.a.values()),r=n.next();!r.done;r=n.next()){var c=r.value;b=b.concat(c.s)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return b}return S(a.c)}function mn(){}function wn(){this.a=new mn}function _n(a,b,t){var e=t||"";try{Ve(a,(function(t,n){var g=t;y(t)&&(g=Lt(t)),b.push(e+n+"="+encodeURIComponent(g))}))}catch(t){throw b.push(e+"type="+encodeURIComponent("_badmap")),t}}function En(a,b,t,e,n){try{b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null,n(e)}catch(t){}}fn.prototype.cancel=function(){var t,e;if(this.c=bn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=o(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},mn.prototype.stringify=function(a){return l.JSON.stringify(a,void 0)},mn.prototype.parse=function(a){return l.JSON.parse(a,void 0)};var In=l.JSON.parse;function On(a){Pt.call(this),this.headers=new Me,this.H=a||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Tn,this.D=this.F=!1}O(On,Pt);var Tn="",jn=/^https?$/i,td=["POST","PUT"];function Nn(a){return"content-type"==a.toLowerCase()}function An(a,b){a.b=!1,a.a&&(a.g=!0,a.a.abort(),a.g=!1),a.f=b,a.h=5,Sn(a),Dn(a)}function Sn(a){a.u||(a.u=!0,Ct(a,"complete"),Ct(a,"error"))}function xn(a){if(a.b&&void 0!==f&&(!a.s[1]||4!=Pn(a)||2!=a.W()))if(a.l&&4==Pn(a))Xt(a.za,0,a);else if(Ct(a,"readystatechange"),4==Pn(a)){a.b=!1;try{var t,e=a.W();t:switch(e){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break t;default:b=!1}if(!(t=b)){var n;if(n=0===e){var r=String(a.B).match(qe)[1]||null;if(!r&&l.self&&l.self.location){var o=l.self.location.protocol;r=o.substr(0,o.length-1)}n=!jn.test(r?r.toLowerCase():"")}t=n}if(t)Ct(a,"complete"),Ct(a,"success");else{a.h=6;try{var c=2<Pn(a)?a.a.statusText:""}catch(e){c=""}a.f=c+" ["+a.W()+"]",Sn(a)}}finally{Dn(a)}}}function Dn(a,b){if(a.a){kn(a);var t=a.a,e=a.s[0]?d:null;a.a=null,a.s=null,b||Ct(a,"ready");try{t.onreadystatechange=e}catch(t){}}}function kn(a){a.a&&a.D&&(a.a.ontimeout=null),a.m&&(l.clearTimeout(a.m),a.m=null)}function Pn(a){return a.a?a.a.readyState:0}function Cn(a,b,t){t:{for(e in t){var e=!1;break t}e=!0}e||(t=function(a){var b="";return V(a,(function(t,e){b+=e,b+=":",b+=t,b+="\r\n"})),b}(t),"string"==typeof a?null!=t&&encodeURIComponent(String(t)):Ke(a,b,t))}function Rn(a,b,t){return t&&t.internalChannelParams&&t.internalChannelParams[a]||b}function Ln(a){this.pa=0,this.g=[],this.c=new ne,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Rn("failFast",!1,a),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Rn("baseRetryDelayMs",5e3,a),this.Ra=Rn("retryDelaySeedMs",1e4,a),this.Ma=Rn("forwardChannelMaxRetries",2,a),this.ma=Rn("forwardChannelRequestTimeoutMs",2e4,a),this.Na=a&&a.g||void 0,this.D=void 0,this.C=a&&a.supportsCrossDomainXhr||!1,this.J="",this.b=new fn(a&&a.concurrentRequestLimit),this.ka=new wn,this.da=a&&a.fastHandshake||!1,this.Ia=a&&a.b||!1,a&&a.f&&(this.c.a=!1),a&&a.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&a&&a.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=a&&a.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Vn(a){if(Un(a),3==a.v){var b=a.R++,t=Be(a.B);Ke(t,"SID",a.J),Ke(t,"RID",b),Ke(t,"TYPE","terminate"),Bn(a,t),(b=new Ie(a,a.c,b,void 0)).H=2,b.i=Xe(Be(t)),t=!1,l.navigator&&l.navigator.sendBeacon&&(t=l.navigator.sendBeacon(b.i.toString(),"")),!t&&l.Image&&((new Image).src=b.i,t=!0),t||(b.a=nr(b.g,null),b.a.ba(b.i)),b.u=q(),De(b)}$n(a)}function Mn(a){a.a&&(Yn(a),a.a.cancel(),a.a=null)}function Un(a){Mn(a),a.j&&(l.clearTimeout(a.j),a.j=null),Xn(a),a.b.cancel(),a.h&&("number"==typeof a.h&&l.clearTimeout(a.h),a.h=null)}function Fn(a,b){a.g.push(new hn(a.Oa++,b)),3==a.v&&qn(a)}function qn(a){pn(a.b)||a.h||(a.h=!0,Bt(a.Ba,a),a.u=0)}function zn(a,b){var t;t=b?b.f:a.R++;var e=Be(a.B);Ke(e,"SID",a.J),Ke(e,"RID",t),Ke(e,"AID",a.P),Bn(a,e),a.i&&a.l&&Cn(e,a.i,a.l),t=new Ie(a,a.c,t,a.u+1),null===a.i&&(t.B=a.l),b&&(a.g=b.s.concat(a.g)),b=Gn(a,t,1e3),t.setTimeout(Math.round(.5*a.ma)+Math.round(.5*a.ma*Math.random())),yn(a.b,t),Ne(t,e,b)}function Bn(a,b){a.f&&Ve({},(function(t,e){Ke(b,e,t)}))}function Gn(a,b,t){t=Math.min(a.g.length,t);var e=a.f?p(a.f.Ja,a.f,a):null;t:for(var n=a.g,r=-1;;){var g=["count="+t];-1==r?0<t?(r=n[0].b,g.push("ofs="+r)):r=0:g.push("ofs="+r);for(var o=!0,c=0;c<t;c++){var u=n[c].b,h=n[c].a;if(0>(u-=r))r=Math.max(0,n[c].b-100),o=!1;else try{_n(h,g,"req"+u+"_")}catch(t){e&&e(h)}}if(o){e=g.join("&");break t}}return a=a.g.splice(0,t),b.s=a,e}function Hn(a){a.a||a.j||(a.T=1,Bt(a.Aa,a),a.o=0)}function Qn(a){return!(a.a||a.j||3<=a.o)&&(a.T++,a.j=le(p(a.Aa,a),Jn(a,a.o)),a.o++,!0)}function Yn(a){null!=a.s&&(l.clearTimeout(a.s),a.s=null)}function Kn(a){a.a=new Ie(a,a.c,"rpc",a.T),null===a.i&&(a.a.B=a.l),a.a.O=0;var b=Be(a.la);Ke(b,"RID","rpc"),Ke(b,"SID",a.J),Ke(b,"CI",a.H?"0":"1"),Ke(b,"AID",a.P),Bn(a,b),Ke(b,"TYPE","xmlhttp"),a.i&&a.l&&Cn(b,a.i,a.l),a.D&&a.a.setTimeout(a.D);var t=a.a;a=a.ga,t.H=1,t.i=Xe(Be(b)),t.j=null,t.I=!0,Ae(t,a)}function Xn(a){null!=a.m&&(l.clearTimeout(a.m),a.m=null)}function Wn(a,b){var t=null;if(a.a==b){Xn(a),Yn(a),a.a=null;var e=2}else{if(!vn(a.b,b))return;t=b.s,gn(a.b,b),e=1}if(a.I=b.N,0!=a.v)if(b.b)if(1==e){t=b.j?b.j.length:0,b=q()-b.u;var n=a.u;Ct(e=se(),new fe(e,t,b,n)),qn(a)}else Hn(a);else if(3==(n=b.h)||0==n&&0<a.I||!(1==e&&function(a,b){return!(dn(a.b)>=a.b.f-(a.h?1:0)||(a.h?(a.g=b.s.concat(a.g),0):1==a.v||2==a.v||a.u>=(a.La?0:a.Ma)||(a.h=le(p(a.Ba,a,b),Jn(a,a.u)),a.u++,0)))}(a,b)||2==e&&Qn(a)))switch(t&&0<t.length&&(b=a.b,b.c=b.c.concat(t)),n){case 1:Zn(a,5);break;case 4:Zn(a,10);break;case 3:Zn(a,6);break;default:Zn(a,2)}}function Jn(a,b){var t=a.Ha+Math.floor(Math.random()*a.Ra);return a.f||(t*=2),t*b}function Zn(a,b){if(a.c.info("Error code "+b),2==b){var t=null;a.f&&(t=null);var e=p(a.Ya,a);t||(t=new ze("//www.google.com/images/cleardot.gif"),l.location&&"http"==l.location.protocol||Ge(t,"https"),Xe(t)),function(a,b){var t=new ne;if(l.Image){var e=new Image;e.onload=I(En,t,e,"TestLoadImage: loaded",!0,b),e.onerror=I(En,t,e,"TestLoadImage: error",!1,b),e.onabort=I(En,t,e,"TestLoadImage: abort",!1,b),e.ontimeout=I(En,t,e,"TestLoadImage: timeout",!1,b),l.setTimeout((function(){e.ontimeout&&e.ontimeout()}),1e4),e.src=a}else b(!1)}(t.toString(),e)}else he(2);a.v=0,a.f&&a.f.ra(b),$n(a),Un(a)}function $n(a){a.v=0,a.I=-1,a.f&&(0==bn(a.b).length&&0==a.g.length||(a.b.c.length=0,S(a.g),a.g.length=0),a.f.qa())}function er(a,b,t){var e=function(a){return a instanceof ze?Be(a):new ze(a,void 0)}(t);if(""!=e.c)b&&He(e,b+"."+e.c),Qe(e,e.h);else{var n=l.location;e=function(a,b,t,e){var n=new ze(null,void 0);return a&&Ge(n,a),b&&He(n,b),t&&Qe(n,t),e&&(n.g=e),n}(n.protocol,b?b+"."+n.hostname:n.hostname,+n.port,t)}return a.V&&V(a.V,(function(t,g){Ke(e,g,t)})),b=a.A,t=a.na,b&&t&&Ke(e,b,t),Ke(e,"VER",a.ha),Bn(a,e),e}function nr(a,b){if(b&&!a.C)throw Error("Can't create secondary domain capable XhrIo object.");return(b=new On(a.Na)).F=a.C,b}function rr(){}function ir(){if(H&&!(10<=Number(ot)))throw Error("Environmental error: no available transport.")}function or(a,b){Pt.call(this),this.a=new Ln(b),this.o=a,this.b=b&&b.messageUrlParams||null,a=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.a.l=a,a=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(a?a["X-WebChannel-Content-Type"]=b.messageContentType:a={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.a&&(a?a["X-WebChannel-Client-Profile"]=b.a:a={"X-WebChannel-Client-Profile":b.a}),this.a.O=a,(a=b&&b.httpHeadersOverwriteParam)&&!x(a)&&(this.a.i=a),this.m=b&&b.supportsCrossDomainXhr||!1,this.l=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!x(b)&&(this.a.A=b,null!==(a=this.b)&&b in a&&(b in(a=this.b)&&delete a[b])),this.f=new ar(this)}function sr(a){we.call(this);var b=a.__sm__;if(b){t:{for(var t in b){a=t;break t}a=void 0}(this.c=a)?(a=this.c,this.data=null!==b&&a in b?b[a]:void 0):this.data=b}else this.data=a}function ur(){_e.call(this),this.status=1}function ar(a){this.a=a}(c=On.prototype).ba=function(a,b,t,e){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+a);b=b?b.toUpperCase():"GET",this.B=a,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?ye(this.H):ye(be),this.a.onreadystatechange=p(this.za,this);try{this.A=!0,this.a.open(b,String(a),!0),this.A=!1}catch(t){return void An(this,t)}a=t||"";var n=new Me(this.headers);e&&Ve(e,(function(t,g){n.set(g,t)})),e=function(a){t:{for(var b=Nn,t=a.length,e="string"==typeof a?a.split(""):a,n=0;n<t;n++)if(n in e&&b.call(void 0,e[n],n,a)){b=n;break t}b=-1}return 0>b?null:"string"==typeof a?a.charAt(b):a[b]}(n.L()),t=l.FormData&&a instanceof l.FormData,!(0<=j(td,b))||e||t||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),n.forEach((function(t,g){this.a.setRequestHeader(g,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{kn(this),0<this.o&&((this.D=function(a){return H&&nt(9)&&"number"==typeof a.timeout&&void 0!==a.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=p(this.xa,this)):this.m=Xt(this.xa,this.o,this)),this.l=!0,this.a.send(a),this.l=!1}catch(t){An(this,t)}},c.xa=function(){void 0!==f&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Ct(this,"timeout"),this.abort(8))},c.abort=function(a){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=a||7,Ct(this,"complete"),Ct(this,"abort"),Dn(this))},c.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Dn(this,!0)),On.X.G.call(this)},c.za=function(){this.j||(this.A||this.l||this.g?xn(this):this.Ua())},c.Ua=function(){xn(this)},c.W=function(){try{return 2<Pn(this)?this.a.status:-1}catch(t){return-1}},c.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},c.Pa=function(a){if(this.a){var b=this.a.responseText;return a&&0==b.indexOf(a)&&(b=b.substring(a.length)),In(b)}},c.ua=function(){return this.h},c.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(c=Ln.prototype).ha=8,c.v=1,c.Ba=function(a){if(this.h)if(this.h=null,1==this.v){if(!a){this.R=Math.floor(1e5*Math.random()),a=this.R++;var t,b=new Ie(this,this.c,a,void 0),e=this.l;if(this.O&&(e?F(e=M(e),this.O):e=this.O),null===this.i&&(b.B=e),this.da)t:{for(var n=t=0;n<this.g.length;n++){var r=this.g[n];if(void 0===(r="__data__"in r.a&&"string"==typeof(r=r.a.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break t}if(4096===t||n===this.g.length-1){t=n+1;break t}}t=1e3}else t=1e3;t=Gn(this,b,t),Ke(n=Be(this.B),"RID",a),Ke(n,"CVER",22),this.A&&Ke(n,"X-HTTP-Session-Id",this.A),Bn(this,n),this.i&&e&&Cn(n,this.i,e),yn(this.b,b),this.Ia&&Ke(n,"TYPE","init"),this.da?(Ke(n,"$req",t),Ke(n,"SID","null"),b.U=!0,Ne(b,n,null)):Ne(b,n,t),this.v=2}}else 3==this.v&&(a?zn(this,a):0==this.g.length||pn(this.b)||zn(this))},c.Aa=function(){if(this.j=null,Kn(this),this.U&&!(this.F||null==this.a||0>=this.N)){var a=2*this.N;this.c.info("BP detection timer enabled: "+a),this.s=le(p(this.Ta,this),a)}},c.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,he(10),Mn(this),Kn(this))},c.Sa=function(){null!=this.m&&(this.m=null,Mn(this),Qn(this),he(19))},c.Ya=function(a){a?(this.c.info("Successfully pinged google.com"),he(2)):(this.c.info("Failed to ping google.com"),he(1))},(c=rr.prototype).ta=function(){},c.sa=function(){},c.ra=function(){},c.qa=function(){},c.Ja=function(){},ir.prototype.a=function(a,b){return new or(a,b)},O(or,Pt),or.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var a=this.a,b=this.o,t=this.b||void 0;he(0),a.fa=b,a.V=t||{},a.H=a.S,a.B=er(a,null,a.fa),qn(a)},or.prototype.close=function(){Vn(this.a)},or.prototype.h=function(a){if("string"==typeof a){var b={};b.__data__=a,Fn(this.a,b)}else this.l?((b={}).__data__=Lt(a),Fn(this.a,b)):Fn(this.a,a)},or.prototype.G=function(){this.a.f=null,delete this.f,Vn(this.a),delete this.a,or.X.G.call(this)},O(sr,we),O(ur,_e),O(ar,rr),ar.prototype.ta=function(){Ct(this.a,"a")},ar.prototype.sa=function(a){Ct(this.a,new sr(a))},ar.prototype.ra=function(a){Ct(this.a,new ur(a))},ar.prototype.qa=function(){Ct(this.a,"b")},ir.prototype.createWebChannel=ir.prototype.a,or.prototype.send=or.prototype.h,or.prototype.open=or.prototype.g,or.prototype.close=or.prototype.close,pe.NO_ERROR=0,pe.TIMEOUT=8,pe.HTTP_ERROR=6,de.COMPLETE="complete",ge.EventType=me,me.OPEN="a",me.CLOSE="b",me.ERROR="c",me.MESSAGE="d",Pt.prototype.listen=Pt.prototype.va,On.prototype.listenOnce=On.prototype.wa,On.prototype.getLastError=On.prototype.Qa,On.prototype.getLastErrorCode=On.prototype.ua,On.prototype.getStatus=On.prototype.W,On.prototype.getResponseJson=On.prototype.Pa,On.prototype.getResponseText=On.prototype.$,On.prototype.send=On.prototype.ba;var cr=function(){return new ir},fr=function(){return se()},lr=pe,pr=de,dr=ie,vr={gb:0,jb:1,kb:2,Db:3,Ib:4,Fb:5,Gb:6,Eb:7,Cb:8,Hb:9,PROXY:10,NOPROXY:11,Ab:12,wb:13,xb:14,vb:15,yb:16,zb:17,bb:18,ab:19,cb:20},yr=ge,gr=On}).call(this,n(56))},425:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return gc})),n.d(e,"b",(function(){return mc})),n.d(e,"c",(function(){return F})),n.d(e,"d",(function(){return fc})),n.d(e,"e",(function(){return pc})),n.d(e,"f",(function(){return lc})),n.d(e,"g",(function(){return vc})),n.d(e,"h",(function(){return ja})),n.d(e,"i",(function(){return Ta})),n.d(e,"j",(function(){return Lu})),n.d(e,"k",(function(){return Ic})),n.d(e,"l",(function(){return Dc})),n.d(e,"m",(function(){return Tc})),n.d(e,"n",(function(){return Ac})),n.d(e,"o",(function(){return yc})),n.d(e,"p",(function(){return xc})),n.d(e,"q",(function(){return Nc})),n.d(e,"r",(function(){return Oc}));var r=n(373),o=n(372),c=n(403),h=n(369),f=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},l=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),d=new r.b("@firebase/firestore");function v(){return d.logLevel}function y(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(d.logLevel<=r.a.DEBUG){var i=e.map(_);d.debug.apply(d,Object(h.g)(["Firestore (8.2.9): "+t],i))}}function m(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(d.logLevel<=r.a.ERROR){var i=e.map(_);d.error.apply(d,Object(h.g)(["Firestore (8.2.9): "+t],i))}}function w(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(d.logLevel<=r.a.WARN){var i=e.map(_);d.warn.apply(d,Object(h.g)(["Firestore (8.2.9): "+t],i))}}function _(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function E(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.2.9) INTERNAL ASSERTION FAILED: "+t;throw m(e),new Error(e)}function I(t,e){t||E()}function O(t,e){return t}function T(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var j=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=T(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function N(t,e){return t<e?-1:t>e?1:0}function A(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function S(t){return t+"\0"}var x=function(){function t(t){this.h=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.h,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.h)},t.prototype.l=function(){return 2*this.h.length},t.prototype._=function(t){return N(this.h,t.h)},t.prototype.isEqual=function(t){return this.h===t.h},t}();x.T=new x("");var D={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},q=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Object(h.c)(e,t),e}(Error),k=function(){function t(t){this.I=t}return t.fromBase64String=function(e){try{return new t(x.fromBase64String(e))}catch(e){throw new q(D.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(x.fromUint8Array(e))},t.prototype.toBase64=function(){return this.I.toBase64()},t.prototype.toUint8Array=function(){return this.I.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.I.isEqual(t.I)},t}(),P=function(){function t(t){this.uid=t}return t.prototype.m=function(){return null!=this.uid},t.prototype.A=function(){return this.m()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();P.UNAUTHENTICATED=new P(null),P.R=new P("google-credentials-uid"),P.P=new P("first-party-uid");var C=function(t,e){this.user=e,this.type="OAuth",this.g={},this.g.Authorization="Bearer "+t},R=function(){function t(){this.V=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.p=function(){},t.prototype.v=function(t){this.V=t,t(P.UNAUTHENTICATED)},t.prototype.S=function(){this.V=null},t}(),L=function(){function t(t){var e=this;this.D=null,this.currentUser=P.UNAUTHENTICATED,this.C=!1,this.N=0,this.V=null,this.forceRefresh=!1,this.D=function(){e.N++,e.currentUser=e.$(),e.C=!0,e.V&&e.V(e.currentUser)},this.N=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.D):(this.D(null),t.get().then((function(t){e.auth=t,e.D&&e.auth.addAuthTokenListener(e.D)}),(function(){})))}return t.prototype.getToken=function(){var t=this,e=this.N,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.N!==e?(y("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(I("string"==typeof n.accessToken),new C(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.p=function(){this.forceRefresh=!0},t.prototype.v=function(t){this.V=t,this.C&&t(this.currentUser)},t.prototype.S=function(){this.auth&&this.auth.removeAuthTokenListener(this.D),this.D=null,this.V=null},t.prototype.$=function(){var t=this.auth&&this.auth.getUid();return I(null===t||"string"==typeof t),new P(t)},t}(),V=function(){function t(t,e){this.F=t,this.O=e,this.type="FirstParty",this.user=P.P}return Object.defineProperty(t.prototype,"g",{get:function(){var t={"X-Goog-AuthUser":this.O},e=this.F.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),M=function(){function t(t,e){this.F=t,this.O=e}return t.prototype.getToken=function(){return Promise.resolve(new V(this.F,this.O))},t.prototype.v=function(t){t(P.P)},t.prototype.S=function(){},t.prototype.p=function(){},t}(),U=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.k=function(t){return n.M(t)},this.L=function(t){return e.B(t)})}return t.prototype.M=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.L&&this.L(t),t},t}();U.q=-1;var F=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new q(D.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new q(D.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new q(D.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new q(D.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.U=function(t){return this.seconds===t.seconds?N(this.nanoseconds,t.nanoseconds):N(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),z=function(){function t(t){this.timestamp=t}return t.K=function(e){return new t(e)},t.min=function(){return new t(new F(0,0))},t.prototype._=function(t){return this.timestamp.U(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.W=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.j=function(){return this.timestamp},t}(),B=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&E(),void 0===n?n=t.length-e:n>t.length-e&&E(),this.segments=t,this.offset=e,this.G=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.G},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.H(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.J(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.Y=function(t){return t=void 0===t?1:t,this.J(this.segments,this.offset+t,this.length-t)},t.prototype.X=function(){return this.J(this.segments,this.offset,this.length-1)},t.prototype.Z=function(){return this.segments[this.offset]},t.prototype.tt=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.et=function(){return 0===this.length},t.prototype.nt=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.st=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.it=function(){return this.segments.slice(this.offset,this.limit())},t.H=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),G=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(h.c)(e,t),e.prototype.J=function(t,n,r){return new e(t,n,r)},e.prototype.rt=function(){return this.it().join("/")},e.prototype.toString=function(){return this.rt()},e.ot=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var u=o[i];if(u.indexOf("//")>=0)throw new q(D.INVALID_ARGUMENT,"Invalid segment ("+u+"). Paths must not contain // in them.");r.push.apply(r,u.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.ct=function(){return new e([])},e}(B),H=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(h.c)(e,t),e.prototype.J=function(t,n,r){return new e(t,n,r)},e.at=function(t){return H.test(t)},e.prototype.rt=function(){return this.it().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.at(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.rt()},e.prototype.ut=function(){return 1===this.length&&"__name__"===this.get(0)},e.ht=function(){return new e(["__name__"])},e.lt=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new q(D.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},u=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new q(D.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new q(D.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=a,i+=2}else"`"===s?(u=!u,i++):"."!==s||u?(r+=s,i++):(o(),i++)}if(o(),u)throw new q(D.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.ct=function(){return new e([])},e}(B),Y=function(){function t(t){this.path=t}return t._t=function(e){return new t(G.ot(e))},t.ft=function(e){return new t(G.ot(e).Y(5))},t.prototype.dt=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===G.H(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.H=function(t,e){return G.H(t.path,e.path)},t.wt=function(t){return t.length%2==0},t.Et=function(e){return new t(new G(e.slice()))},t}();function K(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function X(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function rt(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var W=function(){function t(t){this.fields=t,t.sort(Q.H)}return t.prototype.Tt=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].nt(t))return!0;return!1},t.prototype.isEqual=function(t){return A(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),J=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Z(t){if(I(!!t),"string"==typeof t){var e=0,n=J.exec(t);if(I(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:$(t.seconds),nanos:$(t.nanos)}}function $(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function tt(t){return"string"==typeof t?x.fromBase64String(t):x.fromUint8Array(t)}function et(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function nt(t){var e=t.mapValue.fields.__previous_value__;return et(e)?nt(e):e}function it(t){var e=Z(t.mapValue.fields.__local_write_time__.timestampValue);return new F(e.seconds,e.nanos)}function ot(t){return null==t}function st(t){return 0===t&&1/t==-1/0}function dt(t){return"number"==typeof t&&Number.isInteger(t)&&!st(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function ut(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?et(t)?4:10:E()}function at(t,e){var n=ut(t);if(n!==ut(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return it(t).isEqual(it(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=Z(t.timestampValue),r=Z(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return tt(t.bytesValue).isEqual(tt(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return $(t.geoPointValue.latitude)===$(e.geoPointValue.latitude)&&$(t.geoPointValue.longitude)===$(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return $(t.integerValue)===$(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=$(t.doubleValue),r=$(e.doubleValue);return n===r?st(n)===st(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return A(t.arrayValue.values||[],e.arrayValue.values||[],at);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(K(n)!==K(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!at(n[i],r[i])))return!1;return!0}(t,e);default:return E()}}function ct(t,e){return void 0!==(t.values||[]).find((function(t){return at(t,e)}))}function ht(t,e){var n=ut(t),r=ut(e);if(n!==r)return N(n,r);switch(n){case 0:return 0;case 1:return N(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=$(t.integerValue||t.doubleValue),r=$(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return ft(t.timestampValue,e.timestampValue);case 4:return ft(it(t),it(e));case 5:return N(t.stringValue,e.stringValue);case 6:return function(t,e){var n=tt(t),r=tt(e);return n._(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=N(n[i],r[i]);if(0!==o)return o}return N(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=N($(t.latitude),$(e.latitude));return 0!==n?n:N($(t.longitude),$(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=ht(n[i],r[i]);if(o)return o}return N(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var u=0;u<r.length&&u<o.length;++u){var s=N(r[u],o[u]);if(0!==s)return s;var a=ht(n[r[u]],i[o[u]]);if(0!==a)return a}return N(r.length,o.length)}(t.mapValue,e.mapValue);default:throw E()}}function ft(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return N(t,e);var n=Z(t),r=Z(e),i=N(n.seconds,r.seconds);return 0!==i?i:N(n.nanos,r.nanos)}function lt(t){return pt(t)}function pt(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=Z(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?tt(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,Y.ft(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=pt(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+pt(t.fields[o])}return e+"}"}(t.mapValue):E();var e,n}function vt(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.rt()}}function yt(t){return!!t&&"integerValue"in t}function gt(t){return!!t&&"arrayValue"in t}function bt(t){return!!t&&"nullValue"in t}function mt(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function wt(t){return!!t&&"mapValue"in t}var _t=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.et())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!wt(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.tt()])||null},t.prototype.isEqual=function(t){return at(this.proto,t.proto)},t}(),Et=function(){function t(t){void 0===t&&(t=_t.empty()),this.It=t,this.At=new Map}return t.prototype.set=function(t,e){return this.Rt(t,e),this},t.prototype.delete=function(t){return this.Rt(t,null),this},t.prototype.Rt=function(t,e){for(var n=this.At,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===ut(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.tt(),e)},t.prototype.Pt=function(){var t=this.yt(Q.ct(),this.At);return null!=t?new _t(t):this.It},t.prototype.yt=function(t,e){var n=this,r=!1,i=this.It.field(t),o=wt(i)?Object.assign({},i.mapValue.fields):{};return e.forEach((function(e,i){if(e instanceof Map){var u=n.yt(t.child(i),e);null!=u&&(o[i]=u,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)})),r?{mapValue:{fields:o}}:null},t}();function It(t){var e=[];return X(t.fields||{},(function(t,n){var r=new Q([t]);if(wt(n)){var i=It(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,u=i;o<u.length;o++){var s=u[o];e.push(r.child(s))}}else e.push(r)})),new W(e)}var Ot=function(t,e){this.key=t,this.version=e},Tt=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).gt=r,o.Vt=!!i.Vt,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return Object(h.c)(e,t),e.prototype.field=function(t){return this.gt.field(t)},e.prototype.data=function(){return this.gt},e.prototype.bt=function(){return this.gt.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Vt===t.Vt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.gt.isEqual(t.gt)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.gt.toString()+", {hasLocalMutations: "+this.Vt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.Vt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(Ot),jt=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return Object(h.c)(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Ot),Nt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(h.c)(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Ot),At=function(t,e,n,r,i,o,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=u,this.vt=null};function St(t,e,n,r,i,o,u){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===u&&(u=null),new At(t,e,n,r,i,o,u)}function xt(t){var e=O(t);if(null===e.vt){var n=e.path.rt();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.rt()+t.op.toString()+lt(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.rt()+t.dir}(t)})).join(","),ot(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=Bt(e.startAt)),e.endAt&&(n+="|ub:",n+=Bt(e.endAt)),e.vt=n}return e.vt}function Dt(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!Ht(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!at(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Yt(t.startAt,e.startAt)&&Yt(t.endAt,e.endAt)}function kt(t){return Y.wt(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Pt=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Object(h.c)(e,t),e.create=function(t,n,r){return t.ut()?"in"===n||"not-in"===n?this.St(t,n,r):new Ct(t,n,r):"array-contains"===n?new Mt(t,r):"in"===n?new Ut(t,r):"not-in"===n?new Ft(t,r):"array-contains-any"===n?new qt(t,r):new e(t,n,r)},e.St=function(t,e,n){return"in"===e?new Rt(t,n):new Lt(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.Dt(ht(e,this.value)):null!==e&&ut(this.value)===ut(e)&&this.Dt(ht(e,this.value))},e.prototype.Dt=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return E()}},e.prototype.Ct=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),Ct=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=Y.ft(r.referenceValue),i}return Object(h.c)(e,t),e.prototype.matches=function(t){var e=Y.H(t.key,this.key);return this.Dt(e)},e}(Pt),Rt=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=Vt("in",n),r}return Object(h.c)(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Pt),Lt=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=Vt("not-in",n),r}return Object(h.c)(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Pt);function Vt(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return Y.ft(t.referenceValue)}))}var Mt=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return Object(h.c)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return gt(e)&&ct(e.arrayValue,this.value)},e}(Pt),Ut=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return Object(h.c)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&ct(this.value.arrayValue,e)},e}(Pt),Ft=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return Object(h.c)(e,t),e.prototype.matches=function(t){if(ct(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!ct(this.value.arrayValue,e)},e}(Pt),qt=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return Object(h.c)(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!gt(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return ct(e.value.arrayValue,t)}))},e}(Pt),zt=function(t,e){this.position=t,this.before=e};function Bt(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return lt(t)})).join(",")}var Gt=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Ht(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function Qt(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],u=t.position[i];if(r=o.field.ut()?Y.H(Y.ft(u.referenceValue),n.key):ht(u,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Yt(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!at(t.position[n],e.position[n]))return!1;return!0}var Kt=function(t,e,n,r,i,o,u,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===u&&(u=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.xt=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=u,this.endAt=s,this.Nt=null,this.$t=null,this.startAt,this.endAt};function Xt(t,e,n,r,i,o,u,s){return new Kt(t,e,n,r,i,o,u,s)}function Wt(t){return new Kt(t)}function Jt(t){return!ot(t.limit)&&"F"===t.limitType}function Zt(t){return!ot(t.limit)&&"L"===t.limitType}function $t(t){return t.xt.length>0?t.xt[0].field:null}function te(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.Ct())return r.field}return null}function ee(t){return null!==t.collectionGroup}function ne(t){var e=O(t);if(null===e.Nt){e.Nt=[];var n=te(e),r=$t(e);if(null!==n&&null===r)n.ut()||e.Nt.push(new Gt(n)),e.Nt.push(new Gt(Q.ht(),"asc"));else{for(var i=!1,o=0,u=e.xt;o<u.length;o++){var s=u[o];e.Nt.push(s),s.field.ut()&&(i=!0)}if(!i){var a=e.xt.length>0?e.xt[e.xt.length-1].dir:"asc";e.Nt.push(new Gt(Q.ht(),a))}}}return e.Nt}function re(t){var e=O(t);if(!e.$t)if("F"===e.limitType)e.$t=St(e.path,e.collectionGroup,ne(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=ne(e);r<i.length;r++){var o=i[r],u="desc"===o.dir?"asc":"desc";n.push(new Gt(o.field,u))}var s=e.endAt?new zt(e.endAt.position,!e.endAt.before):null,a=e.startAt?new zt(e.startAt.position,!e.startAt.before):null;e.$t=St(e.path,e.collectionGroup,n,e.filters,e.limit,s,a)}return e.$t}function ie(t,e,n){return new Kt(t.path,t.collectionGroup,t.xt.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function oe(t,e){return Dt(re(t),re(e))&&t.limitType===e.limitType}function se(t){return xt(re(t))+"|lt:"+t.limitType}function ue(t){return"Query(target="+function(t){var e=t.path.rt();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.rt()+" "+e.op+" "+lt(e.value);var e})).join(", ")+"]"),ot(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return function(t){return t.field.rt()+" ("+t.dir+")"}(t)})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+Bt(t.startAt)),t.endAt&&(e+=", endAt: "+Bt(t.endAt)),"Target("+e+")"}(re(t))+"; limitType="+t.limitType+")"}function ae(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.dt(t.collectionGroup)&&t.path.nt(n):Y.wt(t.path)?t.path.isEqual(n):t.path.st(n)}(t,e)&&function(t,e){for(var n=0,r=t.xt;n<r.length;n++){var i=r[n];if(!i.field.ut()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!Qt(t.startAt,ne(t),e)||t.endAt&&Qt(t.endAt,ne(t),e))}(t,e)}function ce(t){return function(e,n){for(var r=!1,i=0,o=ne(t);i<o.length;i++){var u=o[i],s=he(u,e,n);if(0!==s)return s;r=r||u.field.ut()}return 0}}function he(t,e,n){var r=t.field.ut()?Y.H(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?ht(r,i):E()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return E()}}var fe=function(){function t(t,e,n,r,i,o,u){void 0===i&&(i=z.min()),void 0===o&&(o=z.min()),void 0===u&&(u=x.T),this.target=t,this.targetId=e,this.Ft=n,this.sequenceNumber=r,this.Ot=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u}return t.prototype.kt=function(e){return new t(this.target,this.targetId,this.Ft,e,this.Ot,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.Mt=function(e,n){return new t(this.target,this.targetId,this.Ft,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.Lt=function(e){return new t(this.target,this.targetId,this.Ft,this.sequenceNumber,this.Ot,e,this.resumeToken)},t}();function le(t,e){if(t.Bt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:st(e)?"-0":e}}function pe(t){return{integerValue:""+t}}function de(t,e){return dt(e)?pe(e):le(t,e)}var ve=function(){this.qt=void 0};function ye(t,e,n){return t instanceof me?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof we?_e(t,e):t instanceof Ee?Ie(t,e):function(t,e){var n=be(t,e),r=Te(n)+Te(t.Ut);return yt(n)&&yt(t.Ut)?pe(r):le(t.Qt,r)}(t,e)}function ge(t,e,n){return t instanceof we?_e(t,e):t instanceof Ee?Ie(t,e):n}function be(t,e){return t instanceof Oe?yt(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var me=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(h.c)(e,t),e}(ve),we=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(h.c)(e,t),e}(ve);function _e(t,e){for(var n=je(e),r=function(t){n.some((function(e){return at(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Ee=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(h.c)(e,t),e}(ve);function Ie(t,e){for(var n=je(e),r=function(t){n=n.filter((function(e){return!at(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Oe=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Qt=e,r.Ut=n,r}return Object(h.c)(e,t),e}(ve);function Te(t){return $(t.integerValue||t.doubleValue)}function je(t){return gt(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Ne=function(t,e){this.field=t,this.transform=e},Ae=function(t,e){this.version=t,this.transformResults=e},Se=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.Kt=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"Wt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function xe(t,e){return void 0!==t.updateTime?e instanceof Tt&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Tt}var De=function(){};function ke(t,e,n){return t instanceof Ve?function(t,e,n){var r=t.value;if(n.transformResults){var i=Fe(t.fieldTransforms,e,n.transformResults);r=ze(t.fieldTransforms,r,i)}return new Tt(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof Me?function(t,e,n){if(!xe(t.jt,e))return new Nt(t.key,n.version);var r=Ue(t,e,n.transformResults?Fe(t.fieldTransforms,e,n.transformResults):[]);return new Tt(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new jt(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function Pe(t,e,n){return t instanceof Ve?function(t,e,n){if(!xe(t.jt,e))return e;var r=t.value,i=qe(t.fieldTransforms,n,e);r=ze(t.fieldTransforms,r,i);var o=Le(e);return new Tt(t.key,o,r,{Vt:!0})}(t,e,n):t instanceof Me?function(t,e,n){if(!xe(t.jt,e))return e;var r=Le(e),i=Ue(t,e,qe(t.fieldTransforms,n,e));return new Tt(t.key,r,i,{Vt:!0})}(t,e,n):function(t,e){return xe(t.jt,e)?new jt(t.key,z.min()):e}(t,e)}function Ce(t,e){return function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],u=e instanceof Tt?e.field(o.field):void 0,s=be(o.transform,u||null);null!=s&&(n=null==n?(new Et).set(o.field,s):n.set(o.field,s))}return n?n.Pt():null}(t.fieldTransforms,e)}function Re(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.jt.isEqual(e.jt)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&A(t,e,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof we&&e instanceof we||t instanceof Ee&&e instanceof Ee?A(t.elements,e.elements,at):t instanceof Oe&&e instanceof Oe?at(t.Ut,e.Ut):t instanceof me&&e instanceof me}(t.transform,e.transform)}(t,e)}))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.Gt.isEqual(e.Gt))}function Le(t){return t instanceof Tt?t.version:z.min()}var Ve=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.jt=r,o.fieldTransforms=i,o.type=0,o}return Object(h.c)(e,t),e}(De),Me=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var u=this;return(u=t.call(this)||this).key=e,u.data=n,u.Gt=r,u.jt=i,u.fieldTransforms=o,u.type=1,u}return Object(h.c)(e,t),e}(De);function Ue(t,e,n){var r;return r=function(t,e){var n=new Et(e);return t.Gt.fields.forEach((function(e){if(!e.et()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}})),n.Pt()}(t,r=e instanceof Tt?e.data():_t.empty()),ze(t.fieldTransforms,r,n)}function Fe(t,e,n){var r=[];I(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],u=o.transform,s=null;e instanceof Tt&&(s=e.field(o.field)),r.push(ge(u,s,n[i]))}return r}function qe(t,e,n){for(var r=[],i=0,o=t;i<o.length;i++){var u=o[i],s=u.transform,a=null;n instanceof Tt&&(a=n.field(u.field)),r.push(ye(s,a,e))}return r}function ze(t,e,n){for(var r=new Et(e),i=0;i<t.length;i++){var o=t[i];r.set(o.field,n[i])}return r.Pt()}var Be,Ge,He=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.jt=n,r.type=2,r.fieldTransforms=[],r}return Object(h.c)(e,t),e}(De),Qe=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.jt=n,r.type=3,r.fieldTransforms=[],r}return Object(h.c)(e,t),e}(De),Ye=function(t){this.count=t};function Ke(t){switch(t){case D.OK:return E();case D.CANCELLED:case D.UNKNOWN:case D.DEADLINE_EXCEEDED:case D.RESOURCE_EXHAUSTED:case D.INTERNAL:case D.UNAVAILABLE:case D.UNAUTHENTICATED:return!1;case D.INVALID_ARGUMENT:case D.NOT_FOUND:case D.ALREADY_EXISTS:case D.PERMISSION_DENIED:case D.FAILED_PRECONDITION:case D.ABORTED:case D.OUT_OF_RANGE:case D.UNIMPLEMENTED:case D.DATA_LOSS:return!0;default:return E()}}function Xe(t){if(void 0===t)return m("GRPC error has no .code"),D.UNKNOWN;switch(t){case Be.OK:return D.OK;case Be.CANCELLED:return D.CANCELLED;case Be.UNKNOWN:return D.UNKNOWN;case Be.DEADLINE_EXCEEDED:return D.DEADLINE_EXCEEDED;case Be.RESOURCE_EXHAUSTED:return D.RESOURCE_EXHAUSTED;case Be.INTERNAL:return D.INTERNAL;case Be.UNAVAILABLE:return D.UNAVAILABLE;case Be.UNAUTHENTICATED:return D.UNAUTHENTICATED;case Be.INVALID_ARGUMENT:return D.INVALID_ARGUMENT;case Be.NOT_FOUND:return D.NOT_FOUND;case Be.ALREADY_EXISTS:return D.ALREADY_EXISTS;case Be.PERMISSION_DENIED:return D.PERMISSION_DENIED;case Be.FAILED_PRECONDITION:return D.FAILED_PRECONDITION;case Be.ABORTED:return D.ABORTED;case Be.OUT_OF_RANGE:return D.OUT_OF_RANGE;case Be.UNIMPLEMENTED:return D.UNIMPLEMENTED;case Be.DATA_LOSS:return D.DATA_LOSS;default:return E()}}(Ge=Be||(Be={}))[Ge.OK=0]="OK",Ge[Ge.CANCELLED=1]="CANCELLED",Ge[Ge.UNKNOWN=2]="UNKNOWN",Ge[Ge.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ge[Ge.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ge[Ge.NOT_FOUND=5]="NOT_FOUND",Ge[Ge.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ge[Ge.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ge[Ge.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ge[Ge.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ge[Ge.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ge[Ge.ABORTED=10]="ABORTED",Ge[Ge.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ge[Ge.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ge[Ge.INTERNAL=13]="INTERNAL",Ge[Ge.UNAVAILABLE=14]="UNAVAILABLE",Ge[Ge.DATA_LOSS=15]="DATA_LOSS";var We=function(){function t(t,e){this.H=t,this.root=e||Ze.EMPTY}return t.prototype.zt=function(e,n){return new t(this.H,this.root.zt(e,n,this.H).copy(null,null,Ze.Ht,null,null))},t.prototype.remove=function(e){return new t(this.H,this.root.remove(e,this.H).copy(null,null,Ze.Ht,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.et();){var n=this.H(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.et();){var r=this.H(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.et=function(){return this.root.et()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.Jt=function(){return this.root.Jt()},t.prototype.Yt=function(){return this.root.Yt()},t.prototype.Xt=function(t){return this.root.Xt(t)},t.prototype.forEach=function(t){this.Xt((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.Xt((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.Zt=function(t){return this.root.Zt(t)},t.prototype.te=function(){return new Je(this.root,null,this.H,!1)},t.prototype.ee=function(t){return new Je(this.root,t,this.H,!1)},t.prototype.ne=function(){return new Je(this.root,null,this.H,!0)},t.prototype.se=function(t){return new Je(this.root,t,this.H,!0)},t}(),Je=function(){function t(t,e,n,r){this.ie=r,this.re=[];for(var i=1;!t.et();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.ie?t.left:t.right;else{if(0===i){this.re.push(t);break}this.re.push(t),t=this.ie?t.right:t.left}}return t.prototype.oe=function(){var t=this.re.pop(),e={key:t.key,value:t.value};if(this.ie)for(t=t.left;!t.et();)this.re.push(t),t=t.right;else for(t=t.right;!t.et();)this.re.push(t),t=t.left;return e},t.prototype.ce=function(){return this.re.length>0},t.prototype.ae=function(){if(0===this.re.length)return null;var t=this.re[this.re.length-1];return{key:t.key,value:t.value}},t}(),Ze=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.et=function(){return!1},t.prototype.Xt=function(t){return this.left.Xt(t)||t(this.key,this.value)||this.right.Xt(t)},t.prototype.Zt=function(t){return this.right.Zt(t)||t(this.key,this.value)||this.left.Zt(t)},t.prototype.min=function(){return this.left.et()?this:this.left.min()},t.prototype.Jt=function(){return this.min().key},t.prototype.Yt=function(){return this.right.et()?this.key:this.right.Yt()},t.prototype.zt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.zt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.zt(t,e,n))).ue()},t.prototype.he=function(){if(this.left.et())return t.EMPTY;var e=this;return e.left.le()||e.left.left.le()||(e=e._e()),(e=e.copy(null,null,null,e.left.he(),null)).ue()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.et()||i.left.le()||i.left.left.le()||(i=i._e()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.le()&&(i=i.fe()),i.right.et()||i.right.le()||i.right.left.le()||(i=i.de()),0===n(e,i.key)){if(i.right.et())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.he())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.ue()},t.prototype.le=function(){return this.color},t.prototype.ue=function(){var t=this;return t.right.le()&&!t.left.le()&&(t=t.we()),t.left.le()&&t.left.left.le()&&(t=t.fe()),t.left.le()&&t.right.le()&&(t=t.Ee()),t},t.prototype._e=function(){var t=this.Ee();return t.right.left.le()&&(t=(t=(t=t.copy(null,null,null,null,t.right.fe())).we()).Ee()),t},t.prototype.de=function(){var t=this.Ee();return t.left.left.le()&&(t=(t=t.fe()).Ee()),t},t.prototype.we=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.fe=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.Ee=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Te=function(){var t=this.Ie();return Math.pow(2,t)<=this.size+1},t.prototype.Ie=function(){if(this.le()&&this.left.le())throw E();if(this.right.le())throw E();var t=this.left.Ie();if(t!==this.right.Ie())throw E();return t+(this.le()?0:1)},t}();Ze.EMPTY=null,Ze.RED=!0,Ze.Ht=!1,Ze.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw E()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw E()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw E()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw E()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw E()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.zt=function(t,e,n){return new Ze(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.et=function(){return!0},t.prototype.Xt=function(t){return!1},t.prototype.Zt=function(t){return!1},t.prototype.Jt=function(){return null},t.prototype.Yt=function(){return null},t.prototype.le=function(){return!1},t.prototype.Te=function(){return!0},t.prototype.Ie=function(){return 0},t}());var $e=function(){function t(t){this.H=t,this.data=new We(this.H)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.Jt()},t.prototype.last=function(){return this.data.Yt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.Xt((function(e,n){return t(e),!1}))},t.prototype.me=function(t,e){for(var n=this.data.ee(t[0]);n.ce();){var r=n.oe();if(this.H(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Ae=function(t,e){var n;for(n=void 0!==e?this.data.ee(e):this.data.te();n.ce();)if(!t(n.oe().key))return},t.prototype.Re=function(t){var e=this.data.ee(t);return e.ce()?e.oe().key:null},t.prototype.te=function(){return new tn(this.data.te())},t.prototype.ee=function(t){return new tn(this.data.ee(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).zt(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.et=function(){return this.data.et()},t.prototype.Pe=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.te(),r=e.data.te();n.ce();){var i=n.oe().key,o=r.oe().key;if(0!==this.H(i,o))return!1}return!0},t.prototype.it=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.H);return n.data=e,n},t}(),tn=function(){function t(t){this.ye=t}return t.prototype.oe=function(){return this.ye.oe().key},t.prototype.ce=function(){return this.ye.ce()},t}(),en=new We(Y.H);function nn(){return en}function rn(){return nn()}var on=new We(Y.H);function sn(){return on}var un=new We(Y.H);function an(){return un}var cn=new $e(Y.H);function hn(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=cn,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var fn=new $e(N);function ln(){return fn}var pn=function(){function t(t){this.H=t?function(e,n){return t(e,n)||Y.H(e.key,n.key)}:function(t,e){return Y.H(t.key,e.key)},this.ge=sn(),this.Ve=new We(this.H)}return t.pe=function(e){return new t(e.H)},t.prototype.has=function(t){return null!=this.ge.get(t)},t.prototype.get=function(t){return this.ge.get(t)},t.prototype.first=function(){return this.Ve.Jt()},t.prototype.last=function(){return this.Ve.Yt()},t.prototype.et=function(){return this.Ve.et()},t.prototype.indexOf=function(t){var e=this.ge.get(t);return e?this.Ve.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.Ve.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.Ve.Xt((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.ge.zt(t.key,t),e.Ve.zt(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.ge.remove(t),this.Ve.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.Ve.te(),r=e.Ve.te();n.ce();){var i=n.oe().key,o=r.oe().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.H=this.H,r.ge=e,r.Ve=n,r},t}(),dn=function(){function t(){this.be=new We(Y.H)}return t.prototype.track=function(t){var e=t.doc.key,n=this.be.get(e);n?0!==t.type&&3===n.type?this.be=this.be.zt(e,t):3===t.type&&1!==n.type?this.be=this.be.zt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.be=this.be.zt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.be=this.be.zt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.be=this.be.remove(e):1===t.type&&2===n.type?this.be=this.be.zt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.be=this.be.zt(e,{type:2,doc:t.doc}):E():this.be=this.be.zt(e,t)},t.prototype.ve=function(){var t=[];return this.be.Xt((function(e,n){t.push(n)})),t},t}(),vn=function(){function t(t,e,n,r,i,o,u,s){this.query=t,this.docs=e,this.Se=n,this.docChanges=r,this.De=i,this.fromCache=o,this.Ce=u,this.xe=s}return t.Ne=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,pn.pe(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.De.et()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Ce===t.Ce&&this.De.isEqual(t.De)&&oe(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Se.isEqual(t.Se)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),yn=function(){function t(t,e,n,r,i){this.Ot=t,this.$e=e,this.Fe=n,this.Oe=r,this.ke=i}return t.Me=function(e,n){var r=new Map;return r.set(e,gn.Le(e,n)),new t(z.min(),r,ln(),nn(),hn())},t}(),gn=function(){function t(t,e,n,r,i){this.resumeToken=t,this.Be=e,this.qe=n,this.Ue=r,this.Qe=i}return t.Le=function(e,n){return new t(x.T,n,hn(),hn(),hn())},t}(),bn=function(t,e,n,r){this.Ke=t,this.removedTargetIds=e,this.key=n,this.We=r},mn=function(t,e){this.targetId=t,this.je=e},wn=function(t,e,n,r){void 0===n&&(n=x.T),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},_n=function(){function t(){this.Ge=0,this.ze=On(),this.He=x.T,this.Je=!1,this.Ye=!0}return Object.defineProperty(t.prototype,"Be",{get:function(){return this.Je},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.He},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Xe",{get:function(){return 0!==this.Ge},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Ze",{get:function(){return this.Ye},enumerable:!1,configurable:!0}),t.prototype.tn=function(t){t.l()>0&&(this.Ye=!0,this.He=t)},t.prototype.en=function(){var t=hn(),e=hn(),n=hn();return this.ze.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:E()}})),new gn(this.He,this.Je,t,e,n)},t.prototype.nn=function(){this.Ye=!1,this.ze=On()},t.prototype.sn=function(t,e){this.Ye=!0,this.ze=this.ze.zt(t,e)},t.prototype.rn=function(t){this.Ye=!0,this.ze=this.ze.remove(t)},t.prototype.on=function(){this.Ge+=1},t.prototype.cn=function(){this.Ge-=1},t.prototype.an=function(){this.Ye=!0,this.Je=!0},t}(),En=function(){function t(t){this.un=t,this.hn=new Map,this.ln=nn(),this._n=In(),this.fn=new $e(N)}return t.prototype.dn=function(t){for(var e=0,n=t.Ke;e<n.length;e++){var r=n[e];t.We instanceof Tt?this.wn(r,t.We):t.We instanceof jt&&this.En(r,t.key,t.We)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.En(r,t.key,t.We)},t.prototype.Tn=function(t){var e=this;this.In(t,(function(n){var r=e.mn(n);switch(t.state){case 0:e.An(n)&&r.tn(t.resumeToken);break;case 1:r.cn(),r.Xe||r.nn(),r.tn(t.resumeToken);break;case 2:r.cn(),r.Xe||e.removeTarget(n);break;case 3:e.An(n)&&(r.an(),r.tn(t.resumeToken));break;case 4:e.An(n)&&(e.Rn(n),r.tn(t.resumeToken));break;default:E()}}))},t.prototype.In=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.hn.forEach((function(t,r){n.An(r)&&e(r)}))},t.prototype.Pn=function(t){var e=t.targetId,n=t.je.count,r=this.yn(e);if(r){var i=r.target;if(kt(i))if(0===n){var o=new Y(i.path);this.En(e,o,new jt(o,z.min()))}else I(1===n);else this.gn(e)!==n&&(this.Rn(e),this.fn=this.fn.add(e))}},t.prototype.Vn=function(t){var e=this,n=new Map;this.hn.forEach((function(r,i){var o=e.yn(i);if(o){if(r.Be&&kt(o.target)){var u=new Y(o.target.path);null!==e.ln.get(u)||e.pn(i,u)||e.En(i,u,new jt(u,t))}r.Ze&&(n.set(i,r.en()),r.nn())}}));var r=hn();this._n.forEach((function(t,n){var i=!0;n.Ae((function(t){var n=e.yn(t);return!n||2===n.Ft||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new yn(t,n,this.fn,this.ln,r);return this.ln=nn(),this._n=In(),this.fn=new $e(N),i},t.prototype.wn=function(t,e){if(this.An(t)){var n=this.pn(t,e.key)?2:0;this.mn(t).sn(e.key,n),this.ln=this.ln.zt(e.key,e),this._n=this._n.zt(e.key,this.bn(e.key).add(t))}},t.prototype.En=function(t,e,n){if(this.An(t)){var r=this.mn(t);this.pn(t,e)?r.sn(e,1):r.rn(e),this._n=this._n.zt(e,this.bn(e).delete(t)),n&&(this.ln=this.ln.zt(e,n))}},t.prototype.removeTarget=function(t){this.hn.delete(t)},t.prototype.gn=function(t){var e=this.mn(t).en();return this.un.vn(t).size+e.qe.size-e.Qe.size},t.prototype.on=function(t){this.mn(t).on()},t.prototype.mn=function(t){var e=this.hn.get(t);return e||(e=new _n,this.hn.set(t,e)),e},t.prototype.bn=function(t){var e=this._n.get(t);return e||(e=new $e(N),this._n=this._n.zt(t,e)),e},t.prototype.An=function(t){var e=null!==this.yn(t);return e||y("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.yn=function(t){var e=this.hn.get(t);return e&&e.Xe?null:this.un.Sn(t)},t.prototype.Rn=function(t){var e=this;this.hn.set(t,new _n),this.un.vn(t).forEach((function(n){e.En(t,n,null)}))},t.prototype.pn=function(t,e){return this.un.vn(t).has(e)},t}();function In(){return new We(Y.H)}function On(){return new We(Y.H)}var Tn={asc:"ASCENDING",desc:"DESCENDING"},jn={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Nn=function(t,e){this.t=t,this.Bt=e};function An(t,e){return t.Bt?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Sn(t,e){return t.Bt?e.toBase64():e.toUint8Array()}function xn(t,e){return An(t,e.j())}function Dn(t){return I(!!t),z.K(function(t){var e=Z(t);return new F(e.seconds,e.nanos)}(t))}function kn(t,e){return function(t){return new G(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).rt()}function Pn(t){var e=G.ot(t);return I(hr(e)),e}function Cn(t,e){return kn(t.t,e.path)}function Rn(t,e){var n=Pn(e);if(n.get(1)!==t.t.projectId)throw new q(D.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.t.projectId);if(n.get(3)!==t.t.database)throw new q(D.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.t.database);return new Y(Un(n))}function Ln(t,e){return kn(t.t,e)}function Vn(t){var e=Pn(t);return 4===e.length?G.ct():Un(e)}function Mn(t){return new G(["projects",t.t.projectId,"databases",t.t.database]).rt()}function Un(t){return I(t.length>4&&"documents"===t.get(4)),t.Y(5)}function Fn(t,e,n){return{name:Cn(t,e),fields:n.proto.mapValue.fields}}function qn(t,e,n){var r=Rn(t,e.name),i=Dn(e.updateTime),o=new _t({mapValue:{fields:e.fields}});return new Tt(r,i,o,{hasCommittedMutations:!!n})}function zn(t,e){var n;if(e instanceof Ve)n={update:Fn(t,e.key,e.value)};else if(e instanceof He)n={delete:Cn(t,e.key)};else if(e instanceof Me)n={update:Fn(t,e.key,e.data),updateMask:nr(e.Gt)};else{if(!(e instanceof Qe))return E();n={verify:Cn(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof me)return{fieldPath:e.field.rt(),setToServerValue:"REQUEST_TIME"};if(n instanceof we)return{fieldPath:e.field.rt(),appendMissingElements:{values:n.elements}};if(n instanceof Ee)return{fieldPath:e.field.rt(),removeAllFromArray:{values:n.elements}};if(n instanceof Oe)return{fieldPath:e.field.rt(),increment:n.Ut};throw E()}(0,t)}))),e.jt.Wt||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:xn(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:E()}(t,e.jt)),n}function Bn(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Se.updateTime(Dn(t.updateTime)):void 0!==t.exists?Se.exists(t.exists):Se.Kt()}(e.currentDocument):Se.Kt(),r=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)I("REQUEST_TIME"===e.setToServerValue),n=new me;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new we(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new Ee(i)}else"increment"in e?n=new Oe(t,e.increment):E();var o=Q.lt(e.fieldPath);return new Ne(o,n)}(t,e)})):[];if(e.update){e.update.name;var i=Rn(t,e.update.name),o=new _t({mapValue:{fields:e.update.fields}});if(e.updateMask){var u=function(t){var e=t.fieldPaths||[];return new W(e.map((function(t){return Q.lt(t)})))}(e.updateMask);return new Me(i,o,u,n,r)}return new Ve(i,o,n,r)}if(e.delete){var s=Rn(t,e.delete);return new He(s,n)}if(e.verify){var a=Rn(t,e.verify);return new Qe(a,n)}return E()}function Gn(t,e){return{documents:[Ln(t,e.path)]}}function Hn(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Ln(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Ln(t,r.X()),n.structuredQuery.from=[{collectionId:r.tt()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(mt(t.value))return{unaryFilter:{field:Jn(t.field),op:"IS_NAN"}};if(bt(t.value))return{unaryFilter:{field:Jn(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(mt(t.value))return{unaryFilter:{field:Jn(t.field),op:"IS_NOT_NAN"}};if(bt(t.value))return{unaryFilter:{field:Jn(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Jn(t.field),op:Wn(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:Jn(t.field),direction:Xn(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var u=function(t,e){return t.Bt||ot(e)?e:{value:e}}(t,e.limit);return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=Yn(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Yn(e.endAt)),n}function Qn(t){var e=Vn(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){I(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var u=[];n.where&&(u=tr(n.where));var s=[];n.orderBy&&(s=n.orderBy.map((function(t){return function(t){return new Gt(Zn(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var a=null;n.limit&&(a=function(t){var e;return ot(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=Kn(n.startAt));var h=null;return n.endAt&&(h=Kn(n.endAt)),Xt(e,i,s,u,a,"F",c,h)}function tr(t){return t?void 0!==t.unaryFilter?[er(t)]:void 0!==t.fieldFilter?[$n(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return tr(t)})).reduce((function(t,e){return t.concat(e)})):E():[]}function Yn(t){return{before:t.before,values:t.position}}function Kn(t){var e=!!t.before,n=t.values||[];return new zt(n,e)}function Xn(t){return Tn[t]}function Wn(t){return jn[t]}function Jn(t){return{fieldPath:t.rt()}}function Zn(t){return Q.lt(t.fieldPath)}function $n(t){return Pt.create(Zn(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return E()}}(t.fieldFilter.op),t.fieldFilter.value)}function er(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Zn(t.unaryFilter.field);return Pt.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Zn(t.unaryFilter.field);return Pt.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Zn(t.unaryFilter.field);return Pt.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Zn(t.unaryFilter.field);return Pt.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return E()}}function nr(t){var e=[];return t.fields.forEach((function(t){return e.push(t.rt())})),{fieldPaths:e}}function hr(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var rr=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},ir=function(){function t(t){var e=this;this.Dn=null,this.Cn=null,this.result=void 0,this.error=void 0,this.xn=!1,this.Nn=!1,t((function(t){e.xn=!0,e.result=t,e.Dn&&e.Dn(t)}),(function(t){e.xn=!0,e.error=t,e.Cn&&e.Cn(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Nn&&E(),this.Nn=!0,this.xn?this.error?this.$n(n,this.error):this.Fn(e,this.result):new t((function(t,i){r.Dn=function(n){r.Fn(e,n).next(t,i)},r.Cn=function(e){r.$n(n,e).next(t,i)}}))},t.prototype.On=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.kn=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.Fn=function(e,n){return e?this.kn((function(){return e(n)})):t.resolve(n)},t.prototype.$n=function(e,n){return e?this.kn((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.Mn=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.Ln=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.Mn(r)},t}(),or=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.Bn=new rr,this.transaction.oncomplete=function(){n.Bn.resolve()},this.transaction.onabort=function(){e.error?n.Bn.reject(new ar(t,e.error)):n.Bn.resolve()},this.transaction.onerror=function(e){var r=pr(e.target.error);n.Bn.reject(new ar(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new ar(n,e)}},Object.defineProperty(t.prototype,"qn",{get:function(){return this.Bn.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.Bn.reject(t),this.aborted||(y("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new fr(e)},t}(),sr=function(){function e(t,n,i){this.name=t,this.version=n,this.Un=i,12.2===e.Qn(Object(o.g)())&&m("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return e.delete=function(t){return y("SimpleDb","Removing database:",t),lr(window.indexedDB.deleteDatabase(t)).On()},e.Kn=function(){if("undefined"==typeof indexedDB)return!1;if(e.Wn())return!0;var t=Object(o.g)(),n=e.Qn(t),i=0<n&&n<10,r=e.jn(t),u=0<r&&r<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||i||u)},e.Wn=function(){var e;return void 0!==t&&"YES"===(null===(e=t.env)||void 0===e?void 0:e.Gn)},e.zn=function(t,e){return t.store(e)},e.Qn=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},e.jn=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},e.prototype.Hn=function(t){return Object(h.b)(this,void 0,void 0,(function(){var e,n=this;return Object(h.d)(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(y("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new ar(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new q(D.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new ar(t,n))},i.onupgradeneeded=function(t){y("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.Un.Jn(e,i.transaction,t.oldVersion,n.version).next((function(){y("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.Yn&&(this.db.onversionchange=function(t){return n.Yn(t)}),this.db)]}}))}))},e.prototype.Xn=function(t){this.Yn=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},e.prototype.runTransaction=function(t,e,n,r){return Object(h.b)(this,void 0,void 0,(function(){var i,o,u,s,a;return Object(h.d)(this,(function(c){switch(c.label){case 0:i="readonly"===e,o=0,u=function(){var e,u,a,c,f;return Object(h.d)(this,(function(h){switch(h.label){case 0:++o,h.label=1;case 1:return h.trys.push([1,4,,5]),[4,s.Hn(t)];case 2:return s.db=h.sent(),e=or.open(s.db,t,i?"readonly":"readwrite",n),u=r(e).catch((function(t){return e.abort(t),ir.reject(t)})).On(),a={},u.catch((function(){})),[4,e.qn];case 3:return[2,(a.value=(h.sent(),u),a)];case 4:return c=h.sent(),f="FirebaseError"!==c.name&&o<3,y("SimpleDb","Transaction failed with error:",c.message,"Retrying:",f),s.close(),f?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}}))},s=this,c.label=1;case 1:return[5,u()];case 2:if("object"==typeof(a=c.sent()))return[2,a.value];c.label=3;case 3:return[3,1];case 4:return[2]}}))}))},e.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},e}(),ur=function(){function t(t){this.Zn=t,this.ts=!1,this.es=null}return Object.defineProperty(t.prototype,"xn",{get:function(){return this.ts},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ns",{get:function(){return this.es},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Zn=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.ts=!0},t.prototype.ss=function(t){this.es=t},t.prototype.delete=function(){return lr(this.Zn.delete())},t}(),ar=function(t){function e(e,n){var r=this;return(r=t.call(this,D.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Object(h.c)(e,t),e}(q);function cr(t){return"IndexedDbTransactionError"===t.name}var fr=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(y("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(y("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),lr(n)},t.prototype.add=function(t){return y("SimpleDb","ADD",this.store.name,t,t),lr(this.store.add(t))},t.prototype.get=function(t){var e=this;return lr(this.store.get(t)).next((function(n){return void 0===n&&(n=null),y("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return y("SimpleDb","DELETE",this.store.name,t),lr(this.store.delete(t))},t.prototype.count=function(){return y("SimpleDb","COUNT",this.store.name),lr(this.store.count())},t.prototype.rs=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.os(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.cs=function(t,e){y("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.us=!1;var r=this.cursor(n);return this.os(r,(function(t,e,n){return n.delete()}))},t.prototype.hs=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.os(r,e)},t.prototype.ls=function(t){var e=this.cursor({});return new ir((function(n,r){e.onerror=function(t){var e=pr(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.os=function(t,e){var n=[];return new ir((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new ur(i),u=e(i.primaryKey,i.value,o);if(u instanceof ir){var s=u.catch((function(t){return o.done(),ir.reject(t)}));n.push(s)}o.xn?r():null===o.ns?i.continue():i.continue(o.ns)}else r()}})).next((function(){return ir.Mn(n)}))},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.us?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function lr(t){return new ir((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=pr(t.target.error);n(e)}}))}var br=!1;function pr(t){var e=sr.Qn(Object(o.g)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var i=new q("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return br||(br=!0,setTimeout((function(){throw i}),0)),i}}return t}var dr=function(){function t(t,e,n,r,i){this._s=t,this.fs=e,this.ds=n,this.op=r,this.ws=i,this.Es=new rr,this.then=this.Es.promise.then.bind(this.Es.promise),this.Es.promise.catch((function(t){}))}return t.Ts=function(e,n,r,i,o){var u=new t(e,n,Date.now()+r,i,o);return u.start(r),u},t.prototype.start=function(t){var e=this;this.Is=setTimeout((function(){return e.As()}),t)},t.prototype.Rs=function(){return this.As()},t.prototype.cancel=function(t){null!==this.Is&&(this.clearTimeout(),this.Es.reject(new q(D.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.As=function(){var t=this;this._s.Ps((function(){return null!==t.Is?(t.clearTimeout(),t.op().then((function(e){return t.Es.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.Is&&(this.ws(this),clearTimeout(this.Is),this.Is=null)},t}();function vr(t,e){if(m("AsyncQueue",e+": "+t),cr(t))return new q(D.UNAVAILABLE,e+": "+t);throw t}var yr="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",gr=function(){function t(){this.ys=[]}return t.prototype.gs=function(t){this.ys.push(t)},t.prototype.Vs=function(){this.ys.forEach((function(t){return t()}))},t}();function mr(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=_r(e)),e=wr(t.get(n),e);return _r(e)}function wr(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function _r(t){return t+""}function Er(t){var e=t.length;if(I(e>=2),2===e)return I(""===t.charAt(0)&&""===t.charAt(1)),G.ct();for(var n=e-2,r=[],i="",o=0;o<e;){var u=t.indexOf("",o);switch((u<0||u>n)&&E(),t.charAt(u+1)){case"":var s=t.substring(o,u),a=void 0;0===i.length?a=s:(a=i+=s,i=""),r.push(a);break;case"":i+=t.substring(o,u),i+="\0";break;case"":i+=t.substring(o,u+1);break;default:E()}o=u+2}return new G(r)}var Ir=function(t,e){this.seconds=t,this.nanoseconds=e},Or=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Or.store="owner",Or.key="owner";var Tr=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Tr.store="mutationQueues",Tr.keyPath="userId";var jr=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};jr.store="mutations",jr.keyPath="batchId",jr.userMutationsIndex="userMutationsIndex",jr.userMutationsKeyPath=["userId","batchId"];var Nr=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,mr(e)]},t.key=function(t,e,n){return[t,mr(e),n]},t}();Nr.store="documentMutations",Nr.PLACEHOLDER=new Nr;var Ar=function(t,e){this.path=t,this.readTime=e},Sr=function(t,e){this.path=t,this.version=e},xr=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};xr.store="remoteDocuments",xr.readTimeIndex="readTimeIndex",xr.readTimeIndexPath="readTime",xr.collectionReadTimeIndex="collectionReadTimeIndex",xr.collectionReadTimeIndexPath=["parentPath","readTime"];var Dr=function(t){this.byteSize=t};Dr.store="remoteDocumentGlobal",Dr.key="remoteDocumentGlobalKey";var kr=function(t,e,n,r,i,o,u){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=u};kr.store="targets",kr.keyPath="targetId",kr.queryTargetsIndexName="queryTargetsIndex",kr.queryTargetsKeyPath=["canonicalId","targetId"];var Pr=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Pr.store="targetDocuments",Pr.keyPath=["targetId","path"],Pr.documentTargetsIndex="documentTargetsIndex",Pr.documentTargetsKeyPath=["path","targetId"];var Cr=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Cr.key="targetGlobalKey",Cr.store="targetGlobal";var Rr=function(t,e){this.collectionId=t,this.parent=e};Rr.store="collectionParents",Rr.keyPath=["collectionId","parent"];var Lr=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Lr.store="clientMetadata",Lr.keyPath="clientId";var Vr=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Vr.store="bundles",Vr.keyPath="bundleId";var Mr=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};Mr.store="namedQueries",Mr.keyPath="name";var Ur=Object(h.g)(Object(h.g)(Object(h.g)(Object(h.g)([Tr.store,jr.store,Nr.store,xr.store,kr.store,Or.store,Cr.store,Pr.store],[Lr.store]),[Dr.store]),[Rr.store]),[Vr.store,Mr.store]),Fr=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).ps=e,r.bs=n,r}return Object(h.c)(e,t),e}(gr);function qr(t,e){var n=O(t);return sr.zn(n.ps,e)}var zr=function(){function t(t,e,n,r){this.batchId=t,this.vs=e,this.baseMutations=n,this.mutations=r}return t.prototype.Ss=function(t,e,n){for(var r=n.Ds,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=ke(o,e,r[i]))}return e},t.prototype.Cs=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++)(u=r[n]).key.isEqual(t)&&(e=Pe(u,e,this.vs));for(var i=0,o=this.mutations;i<o.length;i++){var u;(u=o[i]).key.isEqual(t)&&(e=Pe(u,e,this.vs))}return e},t.prototype.xs=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.Cs(r.key,t.get(r.key));i&&(n=n.zt(r.key,i))})),n},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),hn())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&A(this.mutations,t.mutations,(function(t,e){return Re(t,e)}))&&A(this.baseMutations,t.baseMutations,(function(t,e){return Re(t,e)}))},t}(),Br=function(){function t(t,e,n,r){this.batch=t,this.Ns=e,this.Ds=n,this.$s=r}return t.from=function(e,n,r){I(e.mutations.length===r.length);for(var i=an(),o=e.mutations,u=0;u<o.length;u++)i=i.zt(o[u].key,r[u].version);return new t(e,n,r,i)},t}(),Gr=function(t){this.Fs=t};function Hr(t,e){if(e.document)return qn(t.Fs,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Y.Et(e.noDocument.path),r=Wr(e.noDocument.readTime);return new jt(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=Y.Et(e.unknownDocument.path);return r=Wr(e.unknownDocument.version),new Nt(i,r)}return E()}function Qr(t,e,n){var r=Yr(n),i=e.key.path.X().it();if(e instanceof Tt){var o=function(t,e){return{name:Cn(t,e.key),fields:e.bt().mapValue.fields,updateTime:An(t,e.version.j())}}(t.Fs,e),u=e.hasCommittedMutations;return new xr(null,null,o,u,r,i)}if(e instanceof jt){var s=e.key.path.it(),a=Xr(e.version);return u=e.hasCommittedMutations,new xr(null,new Ar(s,a),null,u,r,i)}if(e instanceof Nt){var c=e.key.path.it(),h=Xr(e.version);return new xr(new Sr(c,h),null,null,!0,r,i)}return E()}function Yr(t){var e=t.j();return[e.seconds,e.nanoseconds]}function Kr(t){var e=new F(t[0],t[1]);return z.K(e)}function Xr(t){var e=t.j();return new Ir(e.seconds,e.nanoseconds)}function Wr(t){var e=new F(t.seconds,t.nanoseconds);return z.K(e)}function Jr(t,e){for(var n=(e.baseMutations||[]).map((function(e){return Bn(t.Fs,e)})),r=0;r<e.mutations.length-1;++r){var i=e.mutations[r];if(r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform){var o=e.mutations[r+1];i.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(r+1,1),++r}}var u=e.mutations.map((function(e){return Bn(t.Fs,e)})),s=F.fromMillis(e.localWriteTimeMs);return new zr(e.batchId,s,n,u)}function Zr(t){var e,n,r=Wr(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?Wr(t.lastLimboFreeSnapshotVersion):z.min();return void 0!==t.query.documents?(I(1===(n=t.query).documents.length),e=re(Wt(Vn(n.documents[0])))):e=function(t){return re(Qn(t))}(t.query),new fe(e,t.targetId,0,t.lastListenSequenceNumber,r,i,x.fromBase64String(t.resumeToken))}function $r(t,e){var n,r=Xr(e.Ot),i=Xr(e.lastLimboFreeSnapshotVersion);n=kt(e.target)?Gn(t.Fs,e.target):Hn(t.Fs,e.target);var o=e.resumeToken.toBase64();return new kr(e.targetId,xt(e.target),r,o,e.sequenceNumber,i,n)}function ti(t){var e=Qn({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?ie(e,e.limit,"L"):e}var ei=function(){function t(){}return t.prototype.Os=function(t,e){return ni(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:Wr(e.createTime),version:e.version};var e}))},t.prototype.ks=function(t,e){return ni(t).put({bundleId:(n=e).id,createTime:Xr(Dn(n.createTime)),version:n.version});var n},t.prototype.Ms=function(t,e){return ri(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:ti(e.bundledQuery),readTime:Wr(e.readTime)};var e}))},t.prototype.Ls=function(t,e){return ri(t).put(function(t){return{name:t.name,readTime:Xr(Dn(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function ni(t){return qr(t,Vr.store)}function ri(t){return qr(t,Mr.store)}var ii=function(){function t(){this.Bs=new li}return t.prototype.qs=function(t,e){return this.Bs.add(e),ir.resolve()},t.prototype.Us=function(t,e){return ir.resolve(this.Bs.getEntries(e))},t}(),li=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.tt(),n=t.X(),r=this.index[e]||new $e(G.H),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.tt(),n=t.X(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new $e(G.H)).it()},t}(),oi=function(){function t(){this.Qs=new li}return t.prototype.qs=function(t,e){var n=this;if(!this.Qs.has(e)){var r=e.tt(),i=e.X();t.gs((function(){n.Qs.add(e)}));var o={collectionId:r,parent:mr(i)};return si(t).put(o)}return ir.resolve()},t.prototype.Us=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[S(e),""],!1,!0);return si(t).rs(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Er(o.parent))}return n}))},t}();function si(t){return qr(t,Rr.store)}var ui={Ks:!1,Ws:0,js:0,Gs:0},ai=function(){function t(t,e,n){this.zs=t,this.Hs=e,this.Js=n}return t.Ys=function(e){return new t(e,t.Xs,t.Zs)},t}();function ci(t){return Object(h.b)(this,void 0,void 0,(function(){return Object(h.d)(this,(function(e){if(t.code!==D.FAILED_PRECONDITION||t.message!==yr)throw t;return y("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}ai.Xs=10,ai.Zs=1e3,ai.ti=new ai(41943040,ai.Xs,ai.Zs),ai.ei=new ai(-1,0,0);var hi=function(){function t(t,e){this.ni=t,this.si=e,this.ii={}}return t.prototype.get=function(t){var e=this.ni(t),n=this.ii[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],u=o[0],s=o[1];if(this.si(u,t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.ni(t),r=this.ii[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.si(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.ii[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.ni(t),n=this.ii[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.si(n[r][0],t))return 1===n.length?delete this.ii[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){X(this.ii,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],u=o[0],s=o[1];t(u,s)}}))},t.prototype.et=function(){return rt(this.ii)},t}(),fi=function(){function t(){this.ri=new hi((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.oi=!1}return t.prototype.ci=function(t){var e=this.ri.get(t);return e?e.readTime:z.min()},t.prototype.ai=function(t,e){this.ui(),this.ri.set(t.key,{hi:t,readTime:e})},t.prototype.li=function(t,e){void 0===e&&(e=null),this.ui(),this.ri.set(t,{hi:null,readTime:e})},t.prototype._i=function(t,e){this.ui();var n=this.ri.get(e);return void 0!==n?ir.resolve(n.hi):this.fi(t,e)},t.prototype.getEntries=function(t,e){return this.di(t,e)},t.prototype.apply=function(t){return this.ui(),this.oi=!0,this.wi(t)},t.prototype.ui=function(){},t}();function pi(t,e,n){var r=t.store(jr.store),i=t.store(Nr.store),o=[],u=IDBKeyRange.only(n.batchId),s=0,a=r.hs({range:u},(function(t,e,n){return s++,n.delete()}));o.push(a.next((function(){I(1===s)})));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=Nr.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return ir.Mn(o).next((function(){return c}))}function di(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw E();e=t.noDocument}return JSON.stringify(e).length}var vi=function(){function t(t,e,n,r){this.userId=t,this.Qt=e,this.Ei=n,this.Ti=r,this.Ii={}}return t.mi=function(e,n,r,i){return I(""!==e.uid),new t(e.m()?e.uid:"",n,r,i)},t.prototype.Ai=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return gi(t).hs({index:jr.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.Ri=function(t,e,n,r){var i=this,o=bi(t),u=gi(t);return u.add({}).next((function(s){I("number"==typeof s);for(var a=new zr(s,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return zn(t.Fs,e)})),i=n.mutations.map((function(e){return zn(t.Fs,e)}));return new jr(e,n.batchId,n.vs.toMillis(),r,i)}(i.Qt,i.userId,a),h=[],f=new $e((function(t,e){return N(t.rt(),e.rt())})),l=0,p=r;l<p.length;l++){var d=p[l],v=Nr.key(i.userId,d.key.path,s);f=f.add(d.key.path.X()),h.push(u.put(c)),h.push(o.put(v,Nr.PLACEHOLDER))}return f.forEach((function(e){h.push(i.Ei.qs(t,e))})),t.gs((function(){i.Ii[s]=a.keys()})),ir.Mn(h).next((function(){return a}))}))},t.prototype.Pi=function(t,e){var n=this;return gi(t).get(e).next((function(t){return t?(I(t.userId===n.userId),Jr(n.Qt,t)):null}))},t.prototype.yi=function(t,e){var n=this;return this.Ii[e]?ir.resolve(this.Ii[e]):this.Pi(t,e).next((function(t){if(t){var r=t.keys();return n.Ii[e]=r,r}return null}))},t.prototype.gi=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return gi(t).hs({index:jr.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(I(e.batchId>=r),o=Jr(n.Qt,e)),i.done()})).next((function(){return o}))},t.prototype.Vi=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return gi(t).hs({index:jr.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.pi=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return gi(t).rs(jr.userMutationsIndex,n).next((function(t){return t.map((function(t){return Jr(e.Qt,t)}))}))},t.prototype.bi=function(t,e){var n=this,r=Nr.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return bi(t).hs({range:i},(function(r,i,u){var s=r[0],a=r[1],c=r[2],h=Er(a);if(s===n.userId&&e.path.isEqual(h))return gi(t).get(c).next((function(t){if(!t)throw E();I(t.userId===n.userId),o.push(Jr(n.Qt,t))}));u.done()})).next((function(){return o}))},t.prototype.vi=function(t,e){var n=this,r=new $e(N),i=[];return e.forEach((function(e){var o=Nr.prefixForPath(n.userId,e.path),u=IDBKeyRange.lowerBound(o),s=bi(t).hs({range:u},(function(t,i,o){var u=t[0],s=t[1],a=t[2],c=Er(s);u===n.userId&&e.path.isEqual(c)?r=r.add(a):o.done()}));i.push(s)})),ir.Mn(i).next((function(){return n.Si(t,r)}))},t.prototype.Di=function(t,e){var n=this,r=e.path,i=r.length+1,o=Nr.prefixForPath(this.userId,r),u=IDBKeyRange.lowerBound(o),s=new $e(N);return bi(t).hs({range:u},(function(t,e,o){var u=t[0],a=t[1],c=t[2],h=Er(a);u===n.userId&&r.nt(h)?h.length===i&&(s=s.add(c)):o.done()})).next((function(){return n.Si(t,s)}))},t.prototype.Si=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(gi(t).get(e).next((function(t){if(null===t)throw E();I(t.userId===n.userId),r.push(Jr(n.Qt,t))})))})),ir.Mn(i).next((function(){return r}))},t.prototype.Ci=function(t,e){var n=this;return pi(t.ps,this.userId,e).next((function(r){return t.gs((function(){n.xi(e.batchId)})),ir.forEach(r,(function(e){return n.Ti.Ni(t,e)}))}))},t.prototype.xi=function(t){delete this.Ii[t]},t.prototype.$i=function(t){var e=this;return this.Ai(t).next((function(n){if(!n)return ir.resolve();var r=IDBKeyRange.lowerBound(Nr.prefixForUser(e.userId)),i=[];return bi(t).hs({range:r},(function(t,n,r){if(t[0]===e.userId){var o=Er(t[1]);i.push(o)}else r.done()})).next((function(){I(0===i.length)}))}))},t.prototype.Fi=function(t,e){return yi(t,this.userId,e)},t.prototype.Oi=function(t){var e=this;return mi(t).get(this.userId).next((function(t){return t||new Tr(e.userId,-1,"")}))},t}();function yi(t,e,n){var r=Nr.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),u=!1;return bi(t).hs({range:o,us:!0},(function(t,n,r){var o=t[0],s=t[1];t[2],o===e&&s===i&&(u=!0),r.done()})).next((function(){return u}))}function gi(t){return qr(t,jr.store)}function bi(t){return qr(t,Nr.store)}function mi(t){return qr(t,Tr.store)}var wi=function(){function t(t){this.ki=t}return t.prototype.next=function(){return this.ki+=2,this.ki},t.Mi=function(){return new t(0)},t.Li=function(){return new t(-1)},t}(),_i=function(){function t(t,e){this.Ti=t,this.Qt=e}return t.prototype.Bi=function(t){var e=this;return this.qi(t).next((function(n){var r=new wi(n.highestTargetId);return n.highestTargetId=r.next(),e.Ui(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.Qi=function(t){return this.qi(t).next((function(t){return z.K(new F(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.Ki=function(t){return this.qi(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.Wi=function(t,e,n){var r=this;return this.qi(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.j()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Ui(t,i)}))},t.prototype.ji=function(t,e){var n=this;return this.Gi(t,e).next((function(){return n.qi(t).next((function(r){return r.targetCount+=1,n.zi(e,r),n.Ui(t,r)}))}))},t.prototype.Hi=function(t,e){return this.Gi(t,e)},t.prototype.Ji=function(t,e){var n=this;return this.Yi(t,e.targetId).next((function(){return Ei(t).delete(e.targetId)})).next((function(){return n.qi(t)})).next((function(e){return I(e.targetCount>0),e.targetCount-=1,n.Ui(t,e)}))},t.prototype.Xi=function(t,e,n){var r=this,i=0,o=[];return Ei(t).hs((function(u,s){var a=Zr(s);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.Ji(t,a)))})).next((function(){return ir.Mn(o)})).next((function(){return i}))},t.prototype.In=function(t,e){return Ei(t).hs((function(t,n){var r=Zr(n);e(r)}))},t.prototype.qi=function(t){return Ii(t).get(Cr.key).next((function(t){return I(null!==t),t}))},t.prototype.Ui=function(t,e){return Ii(t).put(Cr.key,e)},t.prototype.Gi=function(t,e){return Ei(t).put($r(this.Qt,e))},t.prototype.zi=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.Zi=function(t){return this.qi(t).next((function(t){return t.targetCount}))},t.prototype.tr=function(t,e){var n=xt(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Ei(t).hs({range:r,index:kr.queryTargetsIndexName},(function(t,n,r){var o=Zr(n);Dt(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.er=function(t,e,n){var r=this,i=[],o=Oi(t);return e.forEach((function(e){var u=mr(e.path);i.push(o.put(new Pr(n,u))),i.push(r.Ti.nr(t,n,e))})),ir.Mn(i)},t.prototype.sr=function(t,e,n){var r=this,i=Oi(t);return ir.forEach(e,(function(e){var o=mr(e.path);return ir.Mn([i.delete([n,o]),r.Ti.ir(t,n,e)])}))},t.prototype.Yi=function(t,e){var n=Oi(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.rr=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Oi(t),i=hn();return r.hs({range:n,us:!0},(function(t,e,n){var r=Er(t[1]),o=new Y(r);i=i.add(o)})).next((function(){return i}))},t.prototype.Fi=function(t,e){var n=mr(e.path),r=IDBKeyRange.bound([n],[S(n)],!1,!0),i=0;return Oi(t).hs({index:Pr.documentTargetsIndex,us:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.Sn=function(t,e){return Ei(t).get(e).next((function(t){return t?Zr(t):null}))},t}();function Ei(t){return qr(t,kr.store)}function Ii(t){return qr(t,Cr.store)}function Oi(t){return qr(t,Pr.store)}function Ti(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],u=N(n,i);return 0===u?N(r,o):u}var ji=function(){function t(t){this.cr=t,this.buffer=new $e(Ti),this.ar=0}return t.prototype.ur=function(){return++this.ar},t.prototype.hr=function(t){var e=[t,this.ur()];if(this.buffer.size<this.cr)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Ti(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),Ni=function(){function t(t,e){this.lr=t,this._s=e,this._r=!1,this.dr=null}return t.prototype.start=function(t){-1!==this.lr.params.zs&&this.wr(t)},t.prototype.stop=function(){this.dr&&(this.dr.cancel(),this.dr=null)},Object.defineProperty(t.prototype,"Er",{get:function(){return null!==this.dr},enumerable:!1,configurable:!0}),t.prototype.wr=function(t){var e=this,n=this._r?3e5:6e4;y("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.dr=this._s.Tr("lru_garbage_collection",n,(function(){return Object(h.b)(e,void 0,void 0,(function(){var e;return Object(h.d)(this,(function(n){switch(n.label){case 0:this.dr=null,this._r=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.Ir(this.lr)];case 2:return n.sent(),[3,7];case 3:return cr(e=n.sent())?(y("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,ci(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.wr(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),Ai=function(){function t(t,e){this.mr=t,this.params=e}return t.prototype.Ar=function(t,e){return this.mr.Rr(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.Pr=function(t,e){var n=this;if(0===e)return ir.resolve(U.q);var r=new ji(e);return this.mr.In(t,(function(t){return r.hr(t.sequenceNumber)})).next((function(){return n.mr.yr(t,(function(t){return r.hr(t)}))})).next((function(){return r.maxValue}))},t.prototype.Xi=function(t,e,n){return this.mr.Xi(t,e,n)},t.prototype.gr=function(t,e){return this.mr.gr(t,e)},t.prototype.Vr=function(t,e){var n=this;return-1===this.params.zs?(y("LruGarbageCollector","Garbage collection skipped; disabled"),ir.resolve(ui)):this.pr(t).next((function(r){return r<n.params.zs?(y("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.zs),ui):n.br(t,e)}))},t.prototype.pr=function(t){return this.mr.pr(t)},t.prototype.br=function(t,e){var n,i,o,u,s,a,c,h=this,f=Date.now();return this.Ar(t,this.params.Hs).next((function(e){return e>h.params.Js?(y("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.Js+" from "+e),i=h.params.Js):i=e,u=Date.now(),h.Pr(t,i)})).next((function(r){return n=r,s=Date.now(),h.Xi(t,n,e)})).next((function(e){return o=e,a=Date.now(),h.gr(t,n)})).next((function(t){return c=Date.now(),v()<=r.a.DEBUG&&y("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(u-f)+"ms\n\tDetermined least recently used "+i+" in "+(s-u)+"ms\n\tRemoved "+o+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),ir.resolve({Ks:!0,Ws:i,js:o,Gs:t})}))},t}(),Si=function(){function t(t,e){this.db=t,this.lr=function(t,e){return new Ai(t,e)}(this,e)}return t.prototype.Rr=function(t){var e=this.vr(t);return this.db.Sr().Zi(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.vr=function(t){var e=0;return this.yr(t,(function(t){e++})).next((function(){return e}))},t.prototype.In=function(t,e){return this.db.Sr().In(t,e)},t.prototype.yr=function(t,e){return this.Dr(t,(function(t,n){return e(n)}))},t.prototype.nr=function(t,e,n){return xi(t,n)},t.prototype.ir=function(t,e,n){return xi(t,n)},t.prototype.Xi=function(t,e,n){return this.db.Sr().Xi(t,e,n)},t.prototype.Ni=function(t,e){return xi(t,e)},t.prototype.Cr=function(t,e){return function(t,e){var n=!1;return mi(t).ls((function(r){return yi(t,r,e).next((function(t){return t&&(n=!0),ir.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.gr=function(t,e){var n=this,r=this.db.$r().Nr(),i=[],o=0;return this.Dr(t,(function(u,s){if(s<=e){var a=n.Cr(t,u).next((function(e){if(!e)return o++,r._i(t,u).next((function(){return r.li(u),Oi(t).delete([0,mr(u.path)])}))}));i.push(a)}})).next((function(){return ir.Mn(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.kt(t.bs);return this.db.Sr().Hi(t,n)},t.prototype.Fr=function(t,e){return xi(t,e)},t.prototype.Dr=function(t,e){var n,r=Oi(t),i=U.q;return r.hs({index:Pr.documentTargetsIndex},(function(t,r){var o=t[0],u=(t[1],r.path),s=r.sequenceNumber;0===o?(i!==U.q&&e(new Y(Er(n)),i),i=s,n=u):i=U.q})).next((function(){i!==U.q&&e(new Y(Er(n)),i)}))},t.prototype.pr=function(t){return this.db.$r().Or(t)},t}();function xi(t,e){return Oi(t).put(function(t,e){return new Pr(0,mr(t.path),e)}(e,t.bs))}var Di=function(){function t(t,e){this.Qt=t,this.Ei=e}return t.prototype.ai=function(t,e,n){return Ci(t).put(Ri(e),n)},t.prototype.li=function(t,e){var n=Ci(t),r=Ri(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.kr(t,r)}))},t.prototype._i=function(t,e){var n=this;return Ci(t).get(Ri(e)).next((function(t){return n.Mr(t)}))},t.prototype.Lr=function(t,e){var n=this;return Ci(t).get(Ri(e)).next((function(t){var e=n.Mr(t);return e?{hi:e,size:di(t)}:null}))},t.prototype.getEntries=function(t,e){var n=this,r=rn();return this.Br(t,e,(function(t,e){var i=n.Mr(e);r=r.zt(t,i)})).next((function(){return r}))},t.prototype.qr=function(t,e){var n=this,r=rn(),i=new We(Y.H);return this.Br(t,e,(function(t,e){var o=n.Mr(e);o?(r=r.zt(t,o),i=i.zt(t,di(e))):(r=r.zt(t,null),i=i.zt(t,0))})).next((function(){return{Ur:r,Qr:i}}))},t.prototype.Br=function(t,e,n){if(e.et())return ir.resolve();var r=IDBKeyRange.bound(e.first().path.it(),e.last().path.it()),i=e.te(),o=i.oe();return Ci(t).hs({range:r},(function(t,e,r){for(var u=Y.Et(t);o&&Y.H(o,u)<0;)n(o,null),o=i.oe();o&&o.isEqual(u)&&(n(o,e),o=i.ce()?i.oe():null),o?r.ss(o.path.it()):r.done()})).next((function(){for(;o;)n(o,null),o=i.ce()?i.oe():null}))},t.prototype.Kr=function(t,e,n){var r=this,i=sn(),o=e.path.length+1,u={};if(n.isEqual(z.min())){var s=e.path.it();u.range=IDBKeyRange.lowerBound(s)}else{var a=e.path.it(),c=Yr(n);u.range=IDBKeyRange.lowerBound([a,c],!0),u.index=xr.collectionReadTimeIndex}return Ci(t).hs(u,(function(t,n,u){if(t.length===o){var s=Hr(r.Qt,n);e.path.nt(s.key.path)?s instanceof Tt&&ae(e,s)&&(i=i.zt(s.key,s)):u.done()}})).next((function(){return i}))},t.prototype.Nr=function(t){return new ki(this,!!t&&t.Wr)},t.prototype.Or=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return Pi(t).get(Dr.key).next((function(t){return I(!!t),t}))},t.prototype.kr=function(t,e){return Pi(t).put(Dr.key,e)},t.prototype.Mr=function(t){if(t){var e=Hr(this.Qt,t);return e instanceof jt&&e.version.isEqual(z.min())?null:e}return null},t}(),ki=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).jr=e,r.Wr=n,r.Gr=new hi((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return Object(h.c)(e,t),e.prototype.wi=function(t){var e=this,n=[],r=0,i=new $e((function(t,e){return N(t.rt(),e.rt())}));return this.ri.forEach((function(o,u){var s=e.Gr.get(o);if(u.hi){var a=Qr(e.jr.Qt,u.hi,e.ci(o));i=i.add(o.path.X());var c=di(a);r+=c-s,n.push(e.jr.ai(t,o,a))}else if(r-=s,e.Wr){var h=Qr(e.jr.Qt,new jt(o,z.min()),e.ci(o));n.push(e.jr.ai(t,o,h))}else n.push(e.jr.li(t,o))})),i.forEach((function(r){n.push(e.jr.Ei.qs(t,r))})),n.push(this.jr.updateMetadata(t,r)),ir.Mn(n)},e.prototype.fi=function(t,e){var n=this;return this.jr.Lr(t,e).next((function(t){return null===t?(n.Gr.set(e,0),null):(n.Gr.set(e,t.size),t.hi)}))},e.prototype.di=function(t,e){var n=this;return this.jr.qr(t,e).next((function(t){var e=t.Ur;return t.Qr.forEach((function(t,e){n.Gr.set(t,e)})),e}))},e}(fi);function Pi(t){return qr(t,Dr.store)}function Ci(t){return qr(t,xr.store)}function Ri(t){return t.path.it()}var Li=function(){function t(t){this.Qt=t}return t.prototype.Jn=function(t,e,n,r){var i=this;I(n<r&&n>=0&&r<=11);var o=new or("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(Or.store)}(t),function(t){t.createObjectStore(Tr.store,{keyPath:Tr.keyPath}),t.createObjectStore(jr.store,{keyPath:jr.keyPath,autoIncrement:!0}).createIndex(jr.userMutationsIndex,jr.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Nr.store)}(t),Vi(t),function(t){t.createObjectStore(xr.store)}(t));var u=ir.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Pr.store),t.deleteObjectStore(kr.store),t.deleteObjectStore(Cr.store)}(t),Vi(t)),u=u.next((function(){return function(t){var e=t.store(Cr.store),n=new Cr(0,0,z.min().j(),0);return e.put(Cr.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(u=u.next((function(){return function(t,e){return e.store(jr.store).rs().next((function(n){t.deleteObjectStore(jr.store),t.createObjectStore(jr.store,{keyPath:jr.keyPath,autoIncrement:!0}).createIndex(jr.userMutationsIndex,jr.userMutationsKeyPath,{unique:!0});var r=e.store(jr.store),i=n.map((function(t){return r.put(t)}));return ir.Mn(i)}))}(t,o)}))),u=u.next((function(){!function(t){t.createObjectStore(Lr.store,{keyPath:Lr.keyPath})}(t)}))),n<5&&r>=5&&(u=u.next((function(){return i.zr(o)}))),n<6&&r>=6&&(u=u.next((function(){return function(t){t.createObjectStore(Dr.store)}(t),i.Hr(o)}))),n<7&&r>=7&&(u=u.next((function(){return i.Jr(o)}))),n<8&&r>=8&&(u=u.next((function(){return i.Yr(t,o)}))),n<9&&r>=9&&(u=u.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(xr.store);e.createIndex(xr.readTimeIndex,xr.readTimeIndexPath,{unique:!1}),e.createIndex(xr.collectionReadTimeIndex,xr.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(u=u.next((function(){return i.Xr(o)}))),n<11&&r>=11&&(u=u.next((function(){!function(t){t.createObjectStore(Vr.store,{keyPath:Vr.keyPath})}(t),function(t){t.createObjectStore(Mr.store,{keyPath:Mr.keyPath})}(t)}))),u},t.prototype.Hr=function(t){var e=0;return t.store(xr.store).hs((function(t,n){e+=di(n)})).next((function(){var n=new Dr(e);return t.store(Dr.store).put(Dr.key,n)}))},t.prototype.zr=function(t){var e=this,n=t.store(Tr.store),r=t.store(jr.store);return n.rs().next((function(n){return ir.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.rs(jr.userMutationsIndex,i).next((function(r){return ir.forEach(r,(function(r){I(r.userId===n.userId);var i=Jr(e.Qt,r);return pi(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.Jr=function(t){var e=t.store(Pr.store),n=t.store(xr.store);return t.store(Cr.store).get(Cr.key).next((function(t){var r=[];return n.hs((function(n,i){var o=new G(n),u=function(t){return[0,mr(t)]}(o);r.push(e.get(u).next((function(n){return n?ir.resolve():function(n){return e.put(new Pr(0,mr(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return ir.Mn(r)}))}))},t.prototype.Yr=function(t,e){t.createObjectStore(Rr.store,{keyPath:Rr.keyPath});var n=e.store(Rr.store),r=new li,i=function(t){if(r.add(t)){var e=t.tt(),i=t.X();return n.put({collectionId:e,parent:mr(i)})}};return e.store(xr.store).hs({us:!0},(function(t,e){var n=new G(t);return i(n.X())})).next((function(){return e.store(Nr.store).hs({us:!0},(function(t,e){t[0];var n=t[1],r=(t[2],Er(n));return i(r.X())}))}))},t.prototype.Xr=function(t){var e=this,n=t.store(kr.store);return n.hs((function(t,r){var i=Zr(r),o=$r(e.Qt,i);return n.put(o)}))},t}();function Vi(t){t.createObjectStore(Pr.store,{keyPath:Pr.keyPath}).createIndex(Pr.documentTargetsIndex,Pr.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(kr.store,{keyPath:kr.keyPath}).createIndex(kr.queryTargetsIndexName,kr.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Cr.store)}var Mi="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Ui=function(){function t(e,n,r,i,o,u,s,a,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Zr=o,this.window=u,this.document=s,this.eo=c,this.no=h,this.so=null,this.io=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ro=null,this.inForeground=!1,this.oo=null,this.co=null,this.ao=Number.NEGATIVE_INFINITY,this.uo=function(t){return Promise.resolve()},!t.Kn())throw new q(D.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Ti=new Si(this,i),this.ho=n+"main",this.Qt=new Gr(a),this.lo=new sr(this.ho,11,new Li(this.Qt)),this._o=new _i(this.Ti,this.Qt),this.Ei=new oi,this.fo=function(t,e){return new Di(t,e)}(this.Qt,this.Ei),this.wo=new ei,this.window&&this.window.localStorage?this.Eo=this.window.localStorage:(this.Eo=null,!1===h&&m("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.To().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new q(D.FAILED_PRECONDITION,Mi);return t.Io(),t.mo(),t.Ao(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t._o.Ki(e)}))})).then((function(e){t.so=new U(e,t.eo)})).then((function(){t.io=!0})).catch((function(e){return t.lo&&t.lo.close(),Promise.reject(e)}))},t.prototype.Ro=function(t){var e=this;return this.uo=function(n){return Object(h.b)(e,void 0,void 0,(function(){return Object(h.d)(this,(function(e){return this.Er?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.Po=function(t){var e=this;this.lo.Xn((function(n){return Object(h.b)(e,void 0,void 0,(function(){return Object(h.d)(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.yo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Zr.Ps((function(){return Object(h.b)(e,void 0,void 0,(function(){return Object(h.d)(this,(function(t){switch(t.label){case 0:return this.Er?[4,this.To()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.To=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return qi(e).put(new Lr(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.Vo(e).next((function(e){e||(t.isPrimary=!1,t.Zr.po((function(){return t.uo(!1)})))}))})).next((function(){return t.bo(e)})).next((function(n){return t.isPrimary&&!n?t.vo(e).next((function(){return!1})):!!n&&t.So(e).next((function(){return!0}))}))})).catch((function(e){if(cr(e))return y("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return y("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Zr.po((function(){return t.uo(e)})),t.isPrimary=e}))},t.prototype.Vo=function(t){var e=this;return Fi(t).get(Or.key).next((function(t){return ir.resolve(e.Do(t))}))},t.prototype.Co=function(t){return qi(t).delete(this.clientId)},t.prototype.xo=function(){return Object(h.b)(this,void 0,void 0,(function(){var t,e,n,r,i=this;return Object(h.d)(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.No(this.ao,18e5)?[3,2]:(this.ao=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=qr(t,Lr.store);return e.rs().next((function(t){var n=i.$o(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return ir.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=o.sent(),this.Eo)for(e=0,n=t;e<n.length;e++)r=n[e],this.Eo.removeItem(this.Fo(r.clientId));o.label=2;case 2:return[2]}}))}))},t.prototype.Ao=function(){var t=this;this.co=this.Zr.Tr("client_metadata_refresh",4e3,(function(){return t.To().then((function(){return t.xo()})).then((function(){return t.Ao()}))}))},t.prototype.Do=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.bo=function(t){var e=this;return this.no?ir.resolve(!0):Fi(t).get(Or.key).next((function(n){if(null!==n&&e.No(n.leaseTimestampMs,5e3)&&!e.Oo(n.ownerId)){if(e.Do(n)&&e.networkEnabled)return!0;if(!e.Do(n)){if(!n.allowTabSynchronization)throw new q(D.FAILED_PRECONDITION,Mi);return!1}}return!(!e.networkEnabled||!e.inForeground)||qi(t).rs().next((function(t){return void 0===e.$o(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&y("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.ko=function(){return Object(h.b)(this,void 0,void 0,(function(){var t=this;return Object(h.d)(this,(function(e){switch(e.label){case 0:return this.io=!1,this.Mo(),this.co&&(this.co.cancel(),this.co=null),this.Lo(),this.Bo(),[4,this.lo.runTransaction("shutdown","readwrite",[Or.store,Lr.store],(function(e){var n=new Fr(e,U.q);return t.vo(n).next((function(){return t.Co(n)}))}))];case 1:return e.sent(),this.lo.close(),this.qo(),[2]}}))}))},t.prototype.$o=function(t,e){var n=this;return t.filter((function(t){return n.No(t.updateTimeMs,e)&&!n.Oo(t.clientId)}))},t.prototype.Uo=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return qi(e).rs().next((function(e){return t.$o(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"Er",{get:function(){return this.io},enumerable:!1,configurable:!0}),t.prototype.Qo=function(t){return vi.mi(t,this.Qt,this.Ei,this.Ti)},t.prototype.Sr=function(){return this._o},t.prototype.$r=function(){return this.fo},t.prototype.Ko=function(){return this.Ei},t.prototype.Wo=function(){return this.wo},t.prototype.runTransaction=function(t,e,n){var r=this;y("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.lo.runTransaction(t,o,Ur,(function(o){return i=new Fr(o,r.so?r.so.next():U.q),"readwrite-primary"===e?r.Vo(i).next((function(t){return!!t||r.bo(i)})).next((function(e){if(!e)throw m("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Zr.po((function(){return r.uo(!1)})),new q(D.FAILED_PRECONDITION,yr);return n(i)})).next((function(t){return r.So(i).next((function(){return t}))})):r.jo(i).next((function(){return n(i)}))})).then((function(t){return i.Vs(),t}))},t.prototype.jo=function(t){var e=this;return Fi(t).get(Or.key).next((function(t){if(null!==t&&e.No(t.leaseTimestampMs,5e3)&&!e.Oo(t.ownerId)&&!e.Do(t)&&!(e.no||e.allowTabSynchronization&&t.allowTabSynchronization))throw new q(D.FAILED_PRECONDITION,Mi)}))},t.prototype.So=function(t){var e=new Or(this.clientId,this.allowTabSynchronization,Date.now());return Fi(t).put(Or.key,e)},t.Kn=function(){return sr.Kn()},t.prototype.vo=function(t){var e=this,n=Fi(t);return n.get(Or.key).next((function(t){return e.Do(t)?(y("IndexedDbPersistence","Releasing primary lease."),n.delete(Or.key)):ir.resolve()}))},t.prototype.No=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(m("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.Io=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.oo=function(){t.Zr.Ps((function(){return t.inForeground="visible"===t.document.visibilityState,t.To()}))},this.document.addEventListener("visibilitychange",this.oo),this.inForeground="visible"===this.document.visibilityState)},t.prototype.Lo=function(){this.oo&&(this.document.removeEventListener("visibilitychange",this.oo),this.oo=null)},t.prototype.mo=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.ro=function(){e.Mo(),e.Zr.Ps((function(){return e.ko()}))},this.window.addEventListener("unload",this.ro))},t.prototype.Bo=function(){this.ro&&(this.window.removeEventListener("unload",this.ro),this.ro=null)},t.prototype.Oo=function(t){var e;try{var n=null!==(null===(e=this.Eo)||void 0===e?void 0:e.getItem(this.Fo(t)));return y("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return m("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.Mo=function(){if(this.Eo)try{this.Eo.setItem(this.Fo(this.clientId),String(Date.now()))}catch(t){m("Failed to set zombie client id.",t)}},t.prototype.qo=function(){if(this.Eo)try{this.Eo.removeItem(this.Fo(this.clientId))}catch(t){}},t.prototype.Fo=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Fi(t){return qr(t,Or.store)}function qi(t){return qr(t,Lr.store)}function zi(t,e){var n=t.projectId;return t.o||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Bi=function(t,e){this.progress=t,this.Go=e},Gi=function(){function t(t,e,n){this.fo=t,this.zo=e,this.Ei=n}return t.prototype.Ho=function(t,e){var n=this;return this.zo.bi(t,e).next((function(r){return n.Jo(t,e,r)}))},t.prototype.Jo=function(t,e,n){return this.fo._i(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].Cs(e,t);return t}))},t.prototype.Yo=function(t,e,n){var r=rn();return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].Cs(t,e);r=r.zt(t,e)})),r},t.prototype.Xo=function(t,e){var n=this;return this.fo.getEntries(t,e).next((function(e){return n.Zo(t,e)}))},t.prototype.Zo=function(t,e){var n=this;return this.zo.vi(t,e).next((function(r){var i=n.Yo(t,e,r),o=nn();return i.forEach((function(t,e){e||(e=new jt(t,z.min())),o=o.zt(t,e)})),o}))},t.prototype.Kr=function(t,e,n){return function(t){return Y.wt(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.tc(t,e.path):ee(e)?this.ec(t,e,n):this.nc(t,e,n)},t.prototype.tc=function(t,e){return this.Ho(t,new Y(e)).next((function(t){var e=sn();return t instanceof Tt&&(e=e.zt(t.key,t)),e}))},t.prototype.ec=function(t,e,n){var r=this,i=e.collectionGroup,o=sn();return this.Ei.Us(t,i).next((function(u){return ir.forEach(u,(function(u){var s=function(t,e){return new Kt(e,null,t.xt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,u.child(i));return r.nc(t,s,n).next((function(t){t.forEach((function(t,e){o=o.zt(t,e)}))}))})).next((function(){return o}))}))},t.prototype.nc=function(t,e,n){var r,i,o=this;return this.fo.Kr(t,e,n).next((function(n){return r=n,o.zo.Di(t,e)})).next((function(e){return i=e,o.sc(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],u=0,s=o.mutations;u<s.length;u++){var a=s[u],c=a.key,h=Pe(a,r.get(c),o.vs);r=h instanceof Tt?r.zt(c,h):r.remove(c)}}))})).next((function(){return r.forEach((function(t,n){ae(e,n)||(r=r.remove(t))})),r}))},t.prototype.sc=function(t,e,n){for(var r=hn(),i=0,o=e;i<o.length;i++)for(var u=0,s=o[i].mutations;u<s.length;u++){var a=s[u];a instanceof Me&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.fo.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof Tt&&(c=c.zt(t,e))})),c}))},t}(),Hi=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.ic=n,this.rc=r}return t.oc=function(e,n){for(var r=hn(),i=hn(),o=0,u=n.docChanges;o<u.length;o++){var s=u[o];switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Qi=function(){function t(){}return t.prototype.cc=function(t){this.ac=t},t.prototype.Kr=function(t,e,n,i){var o=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.xt.length||1===t.xt.length&&t.xt[0].field.ut())}(e)||n.isEqual(z.min())?this.uc(t,e):this.ac.Xo(t,i).next((function(u){var s=o.hc(e,u);return(Jt(e)||Zt(e))&&o.lc(e.limitType,s,i,n)?o.uc(t,e):(v()<=r.a.DEBUG&&y("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),ue(e)),o.ac.Kr(t,e,n).next((function(t){return s.forEach((function(e){t=t.zt(e.key,e)})),t})))}))},t.prototype.hc=function(t,e){var n=new $e(ce(t));return e.forEach((function(e,r){r instanceof Tt&&ae(t,r)&&(n=n.add(r))})),n},t.prototype.lc=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version._(r)>0)},t.prototype.uc=function(t,e){return v()<=r.a.DEBUG&&y("QueryEngine","Using full collection scan to execute query:",ue(e)),this.ac.Kr(t,e,z.min())},t}(),Yi=function(){function t(t,e,n,r){this.persistence=t,this._c=e,this.Qt=r,this.fc=new We(N),this.dc=new hi((function(t){return xt(t)}),Dt),this.wc=z.min(),this.zo=t.Qo(n),this.Ec=t.$r(),this._o=t.Sr(),this.Tc=new Gi(this.Ec,this.zo,this.persistence.Ko()),this.wo=t.Wo(),this._c.cc(this.Tc)}return t.prototype.Ir=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.Vr(n,e.fc)}))},t}();function Ki(t,e,n,r){return new Yi(t,e,n,r)}function Xi(t,e){return Object(h.b)(this,void 0,void 0,(function(){var n,r,i,o;return Object(h.d)(this,(function(u){switch(u.label){case 0:return n=O(t),r=n.zo,i=n.Tc,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n.zo.pi(t).next((function(u){return o=u,r=n.persistence.Qo(e),i=new Gi(n.Ec,r,n.persistence.Ko()),r.pi(t)})).next((function(e){for(var n=[],r=[],u=hn(),s=0,a=o;s<a.length;s++){var c=a[s];n.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++){var l=f[h];u=u.add(l.key)}}for(var p=0,d=e;p<d.length;p++){var v=d[p];r.push(v.batchId);for(var y=0,m=v.mutations;y<m.length;y++){var g=m[y];u=u.add(g.key)}}return i.Xo(t,u).next((function(t){return{Ic:t,mc:n,Ac:r}}))}))}))];case 1:return o=u.sent(),[2,(n.zo=r,n.Tc=i,n._c.cc(n.Tc),o)]}}))}))}function Wi(t,e){var n=O(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.Ec.Nr({Wr:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),u=ir.resolve();return o.forEach((function(t){u=u.next((function(){return r._i(e,t)})).next((function(e){var o=e,u=n.$s.get(t);I(null!==u),(!o||o.version._(u)<0)&&(o=i.Ss(t,o,n))&&r.ai(o,n.Ns)}))})),u.next((function(){return t.zo.Ci(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n.zo.$i(t)})).next((function(){return n.Tc.Xo(t,r)}))}))}function Ji(t){var e=O(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e._o.Qi(t)}))}function Zi(t,e){var n=O(t),r=e.Ot,i=n.fc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.Ec.Nr({Wr:!0});i=n.fc;var u=[];e.$e.forEach((function(e,o){var s=i.get(o);if(s){u.push(n._o.sr(t,e.Qe,o).next((function(){return n._o.er(t,e.qe,o)})));var a=e.resumeToken;if(a.l()>0){var c=s.Mt(a,r).kt(t.bs);i=i.zt(o,c),function(t,e,n){return I(e.resumeToken.l()>0),0===t.resumeToken.l()||e.Ot.W()-t.Ot.W()>=3e8||n.qe.size+n.Ue.size+n.Qe.size>0}(s,c,e)&&u.push(n._o.Hi(t,c))}}}));var s=nn();if(e.Oe.forEach((function(r,i){e.ke.has(r)&&u.push(n.persistence.Ti.Fr(t,r))})),u.push($i(t,o,e.Oe,r,void 0).next((function(t){s=t}))),!r.isEqual(z.min())){var a=n._o.Qi(t).next((function(e){return n._o.Wi(t,t.bs,r)}));u.push(a)}return ir.Mn(u).next((function(){return o.apply(t)})).next((function(){return n.Tc.Zo(t,s)}))})).then((function(t){return n.fc=i,t}))}function $i(t,e,n,r,i){var o=hn();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=nn();return n.forEach((function(n,u){var s=t.get(n),a=(null==i?void 0:i.get(n))||r;u instanceof jt&&u.version.isEqual(z.min())?(e.li(n,a),o=o.zt(n,u)):null==s||u.version._(s.version)>0||0===u.version._(s.version)&&s.hasPendingWrites?(e.ai(u,a),o=o.zt(n,u)):y("LocalStore","Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",u.version)})),o}))}function to(t,e){var n=O(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n.zo.gi(t,e)}))}function eo(t,e){var n=O(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n._o.tr(t,e).next((function(i){return i?(r=i,ir.resolve(r)):n._o.Bi(t).next((function(i){return r=new fe(e,i,0,t.bs),n._o.ji(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.fc.get(t.targetId);return(null===r||t.Ot._(r.Ot)>0)&&(n.fc=n.fc.zt(t.targetId,t),n.dc.set(e,t.targetId)),t}))}function no(t,e,n){return Object(h.b)(this,void 0,void 0,(function(){var r,i,o,u;return Object(h.d)(this,(function(s){switch(s.label){case 0:r=O(t),i=r.fc.get(e),o=n?"readwrite":"readwrite-primary",s.label=1;case 1:return s.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(t){return r.persistence.Ti.removeTarget(t,i)}))];case 2:s.sent(),s.label=3;case 3:return[3,5];case 4:if(!cr(u=s.sent()))throw u;return y("LocalStore","Failed to update sequence numbers for target "+e+": "+u),[3,5];case 5:return r.fc=r.fc.remove(e),r.dc.delete(i.target),[2]}}))}))}function ro(t,e,n){var r=O(t),i=z.min(),o=hn();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=O(t),i=r.dc.get(n);return void 0!==i?ir.resolve(r.fc.get(i)):r._o.tr(e,n)}(r,t,re(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r._o.rr(t,e.targetId).next((function(t){o=t}))})).next((function(){return r._c.Kr(t,e,n?i:z.min(),n?o:hn())})).next((function(t){return{documents:t,Rc:o}}))}))}function io(t,e){var n=O(t),r=O(n._o),i=n.fc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.Sn(t,e).next((function(t){return t?t.target:null}))}))}function oo(t){var e=O(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=O(t),i=nn(),o=Yr(n),u=Ci(e),s=IDBKeyRange.lowerBound(o,!0);return u.hs({index:xr.readTimeIndex,range:s},(function(t,e){var n=Hr(r.Qt,e);i=i.zt(n.key,n),o=e.readTime})).next((function(){return{Go:i,readTime:Kr(o)}}))}(e.Ec,t,e.wc)})).then((function(t){var n=t.Go,r=t.readTime;return e.wc=r,n}))}function so(t){return Object(h.b)(this,void 0,void 0,(function(){var e;return Object(h.d)(this,(function(n){return[2,(e=O(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=Ci(t),n=z.min();return e.hs({index:xr.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=Kr(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.wc=t}))]}))}))}function uo(t,e,n,r){return Object(h.b)(this,void 0,void 0,(function(){var i,o,u,s,a,c,f,l,d,p;return Object(h.d)(this,(function(h){switch(h.label){case 0:for(i=O(t),o=hn(),u=nn(),s=an(),a=0,c=n;a<c.length;a++)f=c[a],l=e.Pc(f.metadata.name),f.document&&(o=o.add(l)),u=u.zt(l,e.yc(f)),s=s.zt(l,e.gc(f.metadata.readTime));return d=i.Ec.Nr({Wr:!0}),[4,eo(i,function(t){return re(Wt(G.ot("__bundle__/docs/"+t)))}(r))];case 1:return p=h.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",(function(t){return $i(t,d,u,z.min(),s).next((function(e){return d.apply(t),e})).next((function(e){return i._o.Yi(t,p.targetId).next((function(){return i._o.er(t,o,p.targetId)})).next((function(){return i.Tc.Zo(t,e)}))}))}))]}}))}))}function ao(t,e,n){return void 0===n&&(n=hn()),Object(h.b)(this,void 0,void 0,(function(){var r,i;return Object(h.d)(this,(function(o){switch(o.label){case 0:return[4,eo(t,re(ti(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=O(t)).persistence.runTransaction("Save named query","readwrite",(function(t){var o=Dn(e.readTime);if(r.Ot._(o)>=0)return i.wo.Ls(t,e);var u=r.Mt(x.T,o);return i.fc=i.fc.zt(u.targetId,u),i._o.Hi(t,u).next((function(){return i._o.Yi(t,r.targetId)})).next((function(){return i._o.er(t,n,r.targetId)})).next((function(){return i.wo.Ls(t,e)}))}))]}}))}))}var co=function(){function t(t){this.Qt=t,this.Vc=new Map,this.bc=new Map}return t.prototype.Os=function(t,e){return ir.resolve(this.Vc.get(e))},t.prototype.ks=function(t,e){var n;return this.Vc.set(e.id,{id:(n=e).id,version:n.version,createTime:Dn(n.createTime)}),ir.resolve()},t.prototype.Ms=function(t,e){return ir.resolve(this.bc.get(e))},t.prototype.Ls=function(t,e){return this.bc.set(e.name,function(t){return{name:t.name,query:ti(t.bundledQuery),readTime:Dn(t.readTime)}}(e)),ir.resolve()},t}(),ho=function(){function t(){this.vc=new $e(fo.Sc),this.Dc=new $e(fo.Cc)}return t.prototype.et=function(){return this.vc.et()},t.prototype.nr=function(t,e){var n=new fo(t,e);this.vc=this.vc.add(n),this.Dc=this.Dc.add(n)},t.prototype.xc=function(t,e){var n=this;t.forEach((function(t){return n.nr(t,e)}))},t.prototype.ir=function(t,e){this.Nc(new fo(t,e))},t.prototype.$c=function(t,e){var n=this;t.forEach((function(t){return n.ir(t,e)}))},t.prototype.Fc=function(t){var e=this,n=new Y(new G([])),r=new fo(n,t),i=new fo(n,t+1),o=[];return this.Dc.me([r,i],(function(t){e.Nc(t),o.push(t.key)})),o},t.prototype.Oc=function(){var t=this;this.vc.forEach((function(e){return t.Nc(e)}))},t.prototype.Nc=function(t){this.vc=this.vc.delete(t),this.Dc=this.Dc.delete(t)},t.prototype.kc=function(t){var e=new Y(new G([])),n=new fo(e,t),r=new fo(e,t+1),i=hn();return this.Dc.me([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.Fi=function(t){var e=new fo(t,0),n=this.vc.Re(e);return null!==n&&t.isEqual(n.key)},t}(),fo=function(){function t(t,e){this.key=t,this.Mc=e}return t.Sc=function(t,e){return Y.H(t.key,e.key)||N(t.Mc,e.Mc)},t.Cc=function(t,e){return N(t.Mc,e.Mc)||Y.H(t.key,e.key)},t}(),lo=function(){function t(t,e){this.Ei=t,this.Ti=e,this.zo=[],this.Lc=1,this.Bc=new $e(fo.Sc)}return t.prototype.Ai=function(t){return ir.resolve(0===this.zo.length)},t.prototype.Ri=function(t,e,n,r){var i=this.Lc;this.Lc++,this.zo.length>0&&this.zo[this.zo.length-1];var o=new zr(i,e,n,r);this.zo.push(o);for(var u=0,s=r;u<s.length;u++){var a=s[u];this.Bc=this.Bc.add(new fo(a.key,i)),this.Ei.qs(t,a.key.path.X())}return ir.resolve(o)},t.prototype.Pi=function(t,e){return ir.resolve(this.qc(e))},t.prototype.gi=function(t,e){var n=e+1,r=this.Uc(n),i=r<0?0:r;return ir.resolve(this.zo.length>i?this.zo[i]:null)},t.prototype.Vi=function(){return ir.resolve(0===this.zo.length?-1:this.Lc-1)},t.prototype.pi=function(t){return ir.resolve(this.zo.slice())},t.prototype.bi=function(t,e){var n=this,r=new fo(e,0),i=new fo(e,Number.POSITIVE_INFINITY),o=[];return this.Bc.me([r,i],(function(t){var e=n.qc(t.Mc);o.push(e)})),ir.resolve(o)},t.prototype.vi=function(t,e){var n=this,r=new $e(N);return e.forEach((function(t){var e=new fo(t,0),i=new fo(t,Number.POSITIVE_INFINITY);n.Bc.me([e,i],(function(t){r=r.add(t.Mc)}))})),ir.resolve(this.Qc(r))},t.prototype.Di=function(t,e){var n=e.path,r=n.length+1,i=n;Y.wt(i)||(i=i.child(""));var o=new fo(new Y(i),0),u=new $e(N);return this.Bc.Ae((function(t){var e=t.key.path;return!!n.nt(e)&&(e.length===r&&(u=u.add(t.Mc)),!0)}),o),ir.resolve(this.Qc(u))},t.prototype.Qc=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.qc(t);null!==r&&n.push(r)})),n},t.prototype.Ci=function(t,e){var n=this;I(0===this.Kc(e.batchId,"removed")),this.zo.shift();var r=this.Bc;return ir.forEach(e.mutations,(function(i){var o=new fo(i.key,e.batchId);return r=r.delete(o),n.Ti.Ni(t,i.key)})).next((function(){n.Bc=r}))},t.prototype.xi=function(t){},t.prototype.Fi=function(t,e){var n=new fo(e,0),r=this.Bc.Re(n);return ir.resolve(e.isEqual(r&&r.key))},t.prototype.$i=function(t){return this.zo.length,ir.resolve()},t.prototype.Kc=function(t,e){return this.Uc(t)},t.prototype.Uc=function(t){return 0===this.zo.length?0:t-this.zo[0].batchId},t.prototype.qc=function(t){var e=this.Uc(t);return e<0||e>=this.zo.length?null:this.zo[e]},t}(),po=function(){function t(t,e){this.Ei=t,this.Wc=e,this.docs=new We(Y.H),this.size=0}return t.prototype.ai=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,u=this.Wc(e);return this.docs=this.docs.zt(r,{hi:e,size:u,readTime:n}),this.size+=u-o,this.Ei.qs(t,r.path.X())},t.prototype.li=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype._i=function(t,e){var n=this.docs.get(e);return ir.resolve(n?n.hi:null)},t.prototype.getEntries=function(t,e){var n=this,r=rn();return e.forEach((function(t){var e=n.docs.get(t);r=r.zt(t,e?e.hi:null)})),ir.resolve(r)},t.prototype.Kr=function(t,e,n){for(var r=sn(),i=new Y(e.path.child("")),o=this.docs.ee(i);o.ce();){var u=o.oe(),s=u.key,a=u.value,c=a.hi,h=a.readTime;if(!e.path.nt(s.path))break;h._(n)<=0||c instanceof Tt&&ae(e,c)&&(r=r.zt(c.key,c))}return ir.resolve(r)},t.prototype.jc=function(t,e){return ir.forEach(this.docs,(function(t){return e(t)}))},t.prototype.Nr=function(t){return new vo(this)},t.prototype.Or=function(t){return ir.resolve(this.size)},t}(),vo=function(t){function e(e){var n=this;return(n=t.call(this)||this).jr=e,n}return Object(h.c)(e,t),e.prototype.wi=function(t){var e=this,n=[];return this.ri.forEach((function(r,i){i&&i.hi?n.push(e.jr.ai(t,i.hi,e.ci(r))):e.jr.li(r)})),ir.Mn(n)},e.prototype.fi=function(t,e){return this.jr._i(t,e)},e.prototype.di=function(t,e){return this.jr.getEntries(t,e)},e}(fi),yo=function(){function t(t){this.persistence=t,this.Gc=new hi((function(t){return xt(t)}),Dt),this.lastRemoteSnapshotVersion=z.min(),this.highestTargetId=0,this.zc=0,this.Hc=new ho,this.targetCount=0,this.Jc=wi.Mi()}return t.prototype.In=function(t,e){return this.Gc.forEach((function(t,n){return e(n)})),ir.resolve()},t.prototype.Qi=function(t){return ir.resolve(this.lastRemoteSnapshotVersion)},t.prototype.Ki=function(t){return ir.resolve(this.zc)},t.prototype.Bi=function(t){return this.highestTargetId=this.Jc.next(),ir.resolve(this.highestTargetId)},t.prototype.Wi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.zc&&(this.zc=e),ir.resolve()},t.prototype.Gi=function(t){this.Gc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Jc=new wi(e),this.highestTargetId=e),t.sequenceNumber>this.zc&&(this.zc=t.sequenceNumber)},t.prototype.ji=function(t,e){return this.Gi(e),this.targetCount+=1,ir.resolve()},t.prototype.Hi=function(t,e){return this.Gi(e),ir.resolve()},t.prototype.Ji=function(t,e){return this.Gc.delete(e.target),this.Hc.Fc(e.targetId),this.targetCount-=1,ir.resolve()},t.prototype.Xi=function(t,e,n){var r=this,i=0,o=[];return this.Gc.forEach((function(u,s){s.sequenceNumber<=e&&null===n.get(s.targetId)&&(r.Gc.delete(u),o.push(r.Yi(t,s.targetId)),i++)})),ir.Mn(o).next((function(){return i}))},t.prototype.Zi=function(t){return ir.resolve(this.targetCount)},t.prototype.tr=function(t,e){var n=this.Gc.get(e)||null;return ir.resolve(n)},t.prototype.er=function(t,e,n){return this.Hc.xc(e,n),ir.resolve()},t.prototype.sr=function(t,e,n){this.Hc.$c(e,n);var r=this.persistence.Ti,i=[];return r&&e.forEach((function(e){i.push(r.Ni(t,e))})),ir.Mn(i)},t.prototype.Yi=function(t,e){return this.Hc.Fc(e),ir.resolve()},t.prototype.rr=function(t,e){var n=this.Hc.kc(e);return ir.resolve(n)},t.prototype.Fi=function(t,e){return ir.resolve(this.Hc.Fi(e))},t}(),go=function(){function t(t,e){var n=this;this.Yc={},this.so=new U(0),this.io=!1,this.io=!0,this.Ti=t(this),this._o=new yo(this),this.Ei=new ii,this.fo=function(t,e){return new po(t,(function(t){return n.Ti.Xc(t)}))}(this.Ei),this.Qt=new Gr(e),this.wo=new co(this.Qt)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.ko=function(){return this.io=!1,Promise.resolve()},Object.defineProperty(t.prototype,"Er",{get:function(){return this.io},enumerable:!1,configurable:!0}),t.prototype.Po=function(){},t.prototype.yo=function(){},t.prototype.Ko=function(){return this.Ei},t.prototype.Qo=function(t){var e=this.Yc[t.A()];return e||(e=new lo(this.Ei,this.Ti),this.Yc[t.A()]=e),e},t.prototype.Sr=function(){return this._o},t.prototype.$r=function(){return this.fo},t.prototype.Wo=function(){return this.wo},t.prototype.runTransaction=function(t,e,n){var r=this;y("MemoryPersistence","Starting transaction:",t);var i=new bo(this.so.next());return this.Ti.Zc(),n(i).next((function(t){return r.Ti.ta(i).next((function(){return t}))})).On().then((function(t){return i.Vs(),t}))},t.prototype.ea=function(t,e){return ir.Ln(Object.values(this.Yc).map((function(n){return function(){return n.Fi(t,e)}})))},t}(),bo=function(t){function e(e){var n=this;return(n=t.call(this)||this).bs=e,n}return Object(h.c)(e,t),e}(gr),mo=function(){function t(t){this.persistence=t,this.na=new ho,this.sa=null}return t.ia=function(e){return new t(e)},Object.defineProperty(t.prototype,"ra",{get:function(){if(this.sa)return this.sa;throw E()},enumerable:!1,configurable:!0}),t.prototype.nr=function(t,e,n){return this.na.nr(n,e),this.ra.delete(n.toString()),ir.resolve()},t.prototype.ir=function(t,e,n){return this.na.ir(n,e),this.ra.add(n.toString()),ir.resolve()},t.prototype.Ni=function(t,e){return this.ra.add(e.toString()),ir.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.na.Fc(e.targetId).forEach((function(t){return n.ra.add(t.toString())}));var r=this.persistence.Sr();return r.rr(t,e.targetId).next((function(t){t.forEach((function(t){return n.ra.add(t.toString())}))})).next((function(){return r.Ji(t,e)}))},t.prototype.Zc=function(){this.sa=new Set},t.prototype.ta=function(t){var e=this,n=this.persistence.$r().Nr();return ir.forEach(this.ra,(function(r){var i=Y._t(r);return e.oa(t,i).next((function(t){t||n.li(i)}))})).next((function(){return e.sa=null,n.apply(t)}))},t.prototype.Fr=function(t,e){var n=this;return this.oa(t,e).next((function(t){t?n.ra.delete(e.toString()):n.ra.add(e.toString())}))},t.prototype.Xc=function(t){return 0},t.prototype.oa=function(t,e){var n=this;return ir.Ln([function(){return ir.resolve(n.na.Fi(e))},function(){return n.persistence.Sr().Fi(t,e)},function(){return n.persistence.ea(t,e)}])},t}();function wo(t,e){return"firestore_clients_"+t+"_"+e}function _o(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.m()&&(r+="_"+e.uid),r}function Eo(t,e){return"firestore_targets_"+t+"_"+e}var Io=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.ca=function(e,n,r){var i,o=JSON.parse(r),u="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return u&&o.error&&(u="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new q(o.error.code,o.error.message)),u?new t(e,n,o.state,i):(m("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.aa=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Oo=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.ca=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new q(i.error.code,i.error.message)),o?new t(e,i.state,r):(m("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.aa=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),To=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.ca=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=ln(),u=0;i&&u<r.activeTargetIds.length;++u)i=dt(r.activeTargetIds[u]),o=o.add(r.activeTargetIds[u]);return i?new t(e,o):(m("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),jo=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.ca=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(m("SharedClientState","Failed to parse online state: "+e),null)},t}(),No=function(){function t(){this.activeTargetIds=ln()}return t.prototype.ua=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.aa=function(){var t={activeTargetIds:this.activeTargetIds.it(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Ao=function(){function t(t,e,n,r,i){this.window=t,this.Zr=e,this.persistenceKey=n,this.la=r,this._a=null,this.fa=null,this.k=null,this.da=this.wa.bind(this),this.Ea=new We(N),this.Er=!1,this.Ta=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ia=wo(this.persistenceKey,this.la),this.ma=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Ea=this.Ea.zt(this.la,new No),this.Aa=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Ra=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Pa=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.ya=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.ga=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.da)}return t.Kn=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Object(h.b)(this,void 0,void 0,(function(){var t,e,n,r,i,o,u,s,a,c,f,l=this;return Object(h.d)(this,(function(h){switch(h.label){case 0:return[4,this._a.Uo()];case 1:for(t=h.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.la&&(i=this.getItem(wo(this.persistenceKey,r)))&&(o=To.ca(r,i))&&(this.Ea=this.Ea.zt(o.clientId,o));for(this.Va(),(u=this.storage.getItem(this.ya))&&(s=this.pa(u))&&this.ba(s),a=0,c=this.Ta;a<c.length;a++)f=c[a],this.wa(f);return this.Ta=[],this.window.addEventListener("unload",(function(){return l.ko()})),this.Er=!0,[2]}}))}))},t.prototype.B=function(t){this.setItem(this.ma,JSON.stringify(t))},t.prototype.va=function(){return this.Sa(this.Ea)},t.prototype.Da=function(t){var e=!1;return this.Ea.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.Ca=function(t){this.xa(t,"pending")},t.prototype.Na=function(t,e,n){this.xa(t,e,n),this.$a(t)},t.prototype.Fa=function(t){var e="not-current";if(this.Da(t)){var n=this.storage.getItem(Eo(this.persistenceKey,t));if(n){var r=Oo.ca(t,n);r&&(e=r.state)}}return this.Oa.ua(t),this.Va(),e},t.prototype.ka=function(t){this.Oa.ha(t),this.Va()},t.prototype.Ma=function(t){return this.Oa.activeTargetIds.has(t)},t.prototype.La=function(t){this.removeItem(Eo(this.persistenceKey,t))},t.prototype.Ba=function(t,e,n){this.qa(t,e,n)},t.prototype.Ua=function(t,e,n){var r=this;e.forEach((function(t){r.$a(t)})),this.currentUser=t,n.forEach((function(t){r.Ca(t)}))},t.prototype.Qa=function(t){this.Ka(t)},t.prototype.Wa=function(){this.ja()},t.prototype.ko=function(){this.Er&&(this.window.removeEventListener("storage",this.da),this.removeItem(this.Ia),this.Er=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return y("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){y("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){y("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.wa=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(y("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ia)return void m("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Zr.po((function(){return Object(h.b)(e,void 0,void 0,(function(){var t,e,r,i,o,u;return Object(h.d)(this,(function(s){if(this.Er){if(null!==n.key)if(this.Aa.test(n.key)){if(null==n.newValue)return t=this.Ga(n.key),[2,this.za(t,null)];if(e=this.Ha(n.key,n.newValue))return[2,this.za(e.clientId,e)]}else if(this.Ra.test(n.key)){if(null!==n.newValue&&(r=this.Ja(n.key,n.newValue)))return[2,this.Ya(r)]}else if(this.Pa.test(n.key)){if(null!==n.newValue&&(i=this.Xa(n.key,n.newValue)))return[2,this.Za(i)]}else if(n.key===this.ya){if(null!==n.newValue&&(o=this.pa(n.newValue)))return[2,this.ba(o)]}else if(n.key===this.ma)(u=function(t){var e=U.q;if(null!=t)try{var n=JSON.parse(t);I("number"==typeof n),e=n}catch(t){m("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==U.q&&this.k(u);else if(n.key===this.ga)return[2,this._a.tu()]}else this.Ta.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Oa",{get:function(){return this.Ea.get(this.la)},enumerable:!1,configurable:!0}),t.prototype.Va=function(){this.setItem(this.Ia,this.Oa.aa())},t.prototype.xa=function(t,e,n){var r=new Io(this.currentUser,t,e,n),i=_o(this.persistenceKey,this.currentUser,t);this.setItem(i,r.aa())},t.prototype.$a=function(t){var e=_o(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Ka=function(t){var e={clientId:this.la,onlineState:t};this.storage.setItem(this.ya,JSON.stringify(e))},t.prototype.qa=function(t,e,n){var r=Eo(this.persistenceKey,t),i=new Oo(t,e,n);this.setItem(r,i.aa())},t.prototype.ja=function(){this.setItem(this.ga,"value-not-used")},t.prototype.Ga=function(t){var e=this.Aa.exec(t);return e?e[1]:null},t.prototype.Ha=function(t,e){var n=this.Ga(t);return To.ca(n,e)},t.prototype.Ja=function(t,e){var n=this.Ra.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Io.ca(new P(i),r,e)},t.prototype.Xa=function(t,e){var n=this.Pa.exec(t),r=Number(n[1]);return Oo.ca(r,e)},t.prototype.pa=function(t){return jo.ca(t)},t.prototype.Ya=function(t){return Object(h.b)(this,void 0,void 0,(function(){return Object(h.d)(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this._a.eu(t.batchId,t.state,t.error)]:(y("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.Za=function(t){return this._a.nu(t.targetId,t.state,t.error)},t.prototype.za=function(t,e){var n=this,r=e?this.Ea.zt(t,e):this.Ea.remove(t),i=this.Sa(this.Ea),o=this.Sa(r),u=[],s=[];return o.forEach((function(t){i.has(t)||u.push(t)})),i.forEach((function(t){o.has(t)||s.push(t)})),this._a.su(u,s).then((function(){n.Ea=r}))},t.prototype.ba=function(t){this.Ea.get(t.clientId)&&this.fa(t.onlineState)},t.prototype.Sa=function(t){var e=ln();return t.forEach((function(t,n){e=e.Pe(n.activeTargetIds)})),e},t}(),So=function(){function t(){this.iu=new No,this.ru={},this.fa=null,this.k=null}return t.prototype.Ca=function(t){},t.prototype.Na=function(t,e,n){},t.prototype.Fa=function(t){return this.iu.ua(t),this.ru[t]||"not-current"},t.prototype.Ba=function(t,e,n){this.ru[t]=e},t.prototype.ka=function(t){this.iu.ha(t)},t.prototype.Ma=function(t){return this.iu.activeTargetIds.has(t)},t.prototype.La=function(t){delete this.ru[t]},t.prototype.va=function(){return this.iu.activeTargetIds},t.prototype.Da=function(t){return this.iu.activeTargetIds.has(t)},t.prototype.start=function(){return this.iu=new No,Promise.resolve()},t.prototype.Ua=function(t,e,n){},t.prototype.Qa=function(t){},t.prototype.ko=function(){},t.prototype.B=function(t){},t.prototype.Wa=function(){},t}(),xo=function(){function t(){}return t.prototype.ou=function(t){},t.prototype.ko=function(){},t}(),Do=function(){function t(){var t=this;this.cu=function(){return t.au()},this.uu=function(){return t.hu()},this.lu=[],this._u()}return t.prototype.ou=function(t){this.lu.push(t)},t.prototype.ko=function(){window.removeEventListener("online",this.cu),window.removeEventListener("offline",this.uu)},t.prototype._u=function(){window.addEventListener("online",this.cu),window.addEventListener("offline",this.uu)},t.prototype.au=function(){y("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.lu;t<e.length;t++)(0,e[t])(0)},t.prototype.hu=function(){y("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.lu;t<e.length;t++)(0,e[t])(1)},t.Kn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),ko={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Po=function(){function t(t){this.fu=t.fu,this.du=t.du}return t.prototype.wu=function(t){this.Eu=t},t.prototype.Tu=function(t){this.Iu=t},t.prototype.onMessage=function(t){this.mu=t},t.prototype.close=function(){this.du()},t.prototype.send=function(t){this.fu(t)},t.prototype.Au=function(){this.Eu()},t.prototype.Ru=function(t){this.Iu(t)},t.prototype.Pu=function(t){this.mu(t)},t}(),Co=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.i=e.i,n}return Object(h.c)(e,t),e.prototype.Su=function(t,e,n,r){return new Promise((function(i,o){var u=new c.f;u.listenOnce(c.c.COMPLETE,(function(){try{switch(u.getLastErrorCode()){case c.a.NO_ERROR:var e=u.getResponseJson();y("Connection","XHR received:",JSON.stringify(e)),i(e);break;case c.a.TIMEOUT:y("Connection",'RPC "'+t+'" timed out'),o(new q(D.DEADLINE_EXCEEDED,"Request time out"));break;case c.a.HTTP_ERROR:var n=u.getStatus();if(y("Connection",'RPC "'+t+'" failed with status:',n,"response text:",u.getResponseText()),n>0){var r=u.getResponseJson().error;if(r&&r.status&&r.message){var s=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(D).indexOf(e)>=0?e:D.UNKNOWN}(r.status);o(new q(s,r.message))}else o(new q(D.UNKNOWN,"Server responded with status "+u.getStatus()))}else o(new q(D.UNAVAILABLE,"Connection failed."));break;default:E()}}finally{y("Connection",'RPC "'+t+'" completed.')}}));var s=JSON.stringify(r);u.send(e,"POST",s,n,15)}))},e.prototype.Cu=function(t,e){var n=[this.gu,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=Object(c.g)(),h=Object(c.h)(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.vu(f.initMessageHeaders,e),Object(o.l)()||Object(o.n)()||Object(o.j)()||Object(o.k)()||Object(o.o)()||Object(o.i)()||(f.httpHeadersOverwriteParam="$httpHeaders");var l=n.join("");y("Connection","Creating WebChannel: "+l,f);var g=r.createWebChannel(l,f),d=!1,b=!1,v=new Po({fu:function(t){b?y("Connection","Not sending because WebChannel is closed:",t):(d||(y("Connection","Opening WebChannel transport."),g.open(),d=!0),y("Connection","WebChannel sending:",t),g.send(t))},du:function(){return g.close()}}),m=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return m(g,c.e.EventType.OPEN,(function(){b||y("Connection","WebChannel transport opened.")})),m(g,c.e.EventType.CLOSE,(function(){b||(b=!0,y("Connection","WebChannel transport closed"),v.Ru())})),m(g,c.e.EventType.ERROR,(function(t){b||(b=!0,w("Connection","WebChannel transport errored:",t),v.Ru(new q(D.UNAVAILABLE,"The operation could not be completed")))})),m(g,c.e.EventType.MESSAGE,(function(t){var e;if(!b){var n=t.data[0];I(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){y("Connection","WebChannel received error:",i);var o=i.status,u=function(t){var e=Be[t];if(void 0!==e)return Xe(e)}(o),s=i.message;void 0===u&&(u=D.INTERNAL,s="Unknown error status: "+o+" with message "+i.message),b=!0,v.Ru(new q(u,s)),g.close()}else y("Connection","WebChannel received:",n),v.Pu(n)}})),m(h,c.b.STAT_EVENT,(function(t){t.stat===c.d.PROXY?y("Connection","Detected buffering proxy"):t.stat===c.d.NOPROXY&&y("Connection","Detected no buffering proxy")})),setTimeout((function(){v.Au()}),0),v},e}(function(){function t(t){this.yu=t,this.t=t.t;var e=t.ssl?"https":"http";this.gu=e+"://"+t.host,this.Vu="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}return t.prototype.pu=function(t,e,n,r){var i=this.bu(t,e);y("RestConnection","Sending: ",i,n);var o={};return this.vu(o,r),this.Su(t,i,o,n).then((function(t){return y("RestConnection","Received: ",t),t}),(function(e){throw w("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.Du=function(t,e,n,r){return this.pu(t,e,n,r)},t.prototype.vu=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.9",t["Content-Type"]="text/plain",e)for(var n in e.g)e.g.hasOwnProperty(n)&&(t[n]=e.g[n])},t.prototype.bu=function(t,e){var n=ko[t];return this.gu+"/v1/"+e+":"+n},t}());function Ro(){return"undefined"!=typeof window?window:null}function Lo(){return"undefined"!=typeof document?document:null}function Vo(t){return new Nn(t,!0)}var Mo=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Zr=t,this.fs=e,this.xu=n,this.Nu=r,this.$u=i,this.Fu=0,this.Ou=null,this.ku=Date.now(),this.reset()}return t.prototype.reset=function(){this.Fu=0},t.prototype.Mu=function(){this.Fu=this.$u},t.prototype.Lu=function(t){var e=this;this.cancel();var n=Math.floor(this.Fu+this.Bu()),r=Math.max(0,Date.now()-this.ku),i=Math.max(0,n-r);i>0&&y("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Fu+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ou=this.Zr.Tr(this.fs,i,(function(){return e.ku=Date.now(),t()})),this.Fu*=this.Nu,this.Fu<this.xu&&(this.Fu=this.xu),this.Fu>this.$u&&(this.Fu=this.$u)},t.prototype.qu=function(){null!==this.Ou&&(this.Ou.Rs(),this.Ou=null)},t.prototype.cancel=function(){null!==this.Ou&&(this.Ou.cancel(),this.Ou=null)},t.prototype.Bu=function(){return(Math.random()-.5)*this.Fu},t}(),Uo=function(){function t(t,e,n,r,i,o){this.Zr=t,this.Uu=n,this.Qu=r,this.Ku=i,this.listener=o,this.state=0,this.Wu=0,this.ju=null,this.stream=null,this.Gu=new Mo(t,e)}return t.prototype.zu=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.Hu=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.Ju()},t.prototype.stop=function(){return Object(h.b)(this,void 0,void 0,(function(){return Object(h.d)(this,(function(t){switch(t.label){case 0:return this.zu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.Yu=function(){this.state=0,this.Gu.reset()},t.prototype.Xu=function(){var t=this;this.Hu()&&null===this.ju&&(this.ju=this.Zr.Tr(this.Uu,6e4,(function(){return t.Zu()})))},t.prototype.th=function(t){this.eh(),this.stream.send(t)},t.prototype.Zu=function(){return Object(h.b)(this,void 0,void 0,(function(){return Object(h.d)(this,(function(t){return this.Hu()?[2,this.close(0)]:[2]}))}))},t.prototype.eh=function(){this.ju&&(this.ju.cancel(),this.ju=null)},t.prototype.close=function(t,e){return Object(h.b)(this,void 0,void 0,(function(){return Object(h.d)(this,(function(n){switch(n.label){case 0:return this.eh(),this.Gu.cancel(),this.Wu++,3!==t?this.Gu.reset():e&&e.code===D.RESOURCE_EXHAUSTED?(m(e.toString()),m("Using maximum backoff delay to prevent overloading the backend."),this.Gu.Mu()):e&&e.code===D.UNAUTHENTICATED&&this.Ku.p(),null!==this.stream&&(this.nh(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Tu(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.nh=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.sh(this.Wu),n=this.Wu;this.Ku.getToken().then((function(e){t.Wu===n&&t.ih(e)}),(function(n){e((function(){var e=new q(D.UNKNOWN,"Fetching auth token failed: "+n.message);return t.rh(e)}))}))},t.prototype.ih=function(t){var e=this,n=this.sh(this.Wu);this.stream=this.oh(t),this.stream.wu((function(){n((function(){return e.state=2,e.listener.wu()}))})),this.stream.Tu((function(t){n((function(){return e.rh(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.Ju=function(){var t=this;this.state=4,this.Gu.Lu((function(){return Object(h.b)(t,void 0,void 0,(function(){return Object(h.d)(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.rh=function(t){return y("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.sh=function(t){var e=this;return function(n){e.Zr.Ps((function(){return e.Wu===t?n():(y("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),Fo=function(t){function e(e,n,r,i,o){var u=this;return(u=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).Qt=i,u}return Object(h.c)(e,t),e.prototype.oh=function(t){return this.Qu.Cu("Listen",t)},e.prototype.onMessage=function(t){this.Gu.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:E()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.Bt?(I(void 0===e||"string"==typeof e),x.fromBase64String(e||"")):(I(void 0===e||e instanceof Uint8Array),x.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),u=(s=e.targetChange.cause)&&function(t){var e=void 0===t.code?D.UNKNOWN:Xe(t.code);return new q(e,t.message||"")}(s);n=new wn(r,i,o,u||null)}else if("documentChange"in e){e.documentChange,(r=e.documentChange).document,r.document.name,r.document.updateTime,i=Rn(t,r.document.name),o=Dn(r.document.updateTime);var s=new _t({mapValue:{fields:r.document.fields}}),a=(u=new Tt(i,o,s,{}),r.targetIds||[]),c=r.removedTargetIds||[];n=new bn(a,c,u.key,u)}else if("documentDelete"in e)e.documentDelete,(r=e.documentDelete).document,i=Rn(t,r.document),o=r.readTime?Dn(r.readTime):z.min(),s=new jt(i,o),u=r.removedTargetIds||[],n=new bn([],u,s.key,s);else if("documentRemove"in e)e.documentRemove,(r=e.documentRemove).document,i=Rn(t,r.document),o=r.removedTargetIds||[],n=new bn([],o,i,null);else{if(!("filter"in e))return E();e.filter;var h=e.filter;h.targetId,r=h.count||0,i=new Ye(r),o=h.targetId,n=new mn(o,i)}return n}(this.Qt,t),n=function(t){if(!("targetChange"in t))return z.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?z.min():e.readTime?Dn(e.readTime):z.min()}(t);return this.listener.ah(e,n)},e.prototype.uh=function(t){var e={};e.database=Mn(this.Qt),e.addTarget=function(t,e){var n,r=e.target;return(n=kt(r)?{documents:Gn(t,r)}:{query:Hn(t,r)}).targetId=e.targetId,e.resumeToken.l()>0?n.resumeToken=Sn(t,e.resumeToken):e.Ot._(z.min())>0&&(n.readTime=An(t,e.Ot.j())),n}(this.Qt,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return E()}}(0,e.Ft);return null==n?null:{"goog-listen-tags":n}}(this.Qt,t);n&&(e.labels=n),this.th(e)},e.prototype.hh=function(t){var e={};e.database=Mn(this.Qt),e.removeTarget=t,this.th(e)},e}(Uo),qo=function(t){function e(e,n,r,i,o){var u=this;return(u=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).Qt=i,u.lh=!1,u}return Object(h.c)(e,t),Object.defineProperty(e.prototype,"_h",{get:function(){return this.lh},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.lh=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.nh=function(){this.lh&&this.fh([])},e.prototype.oh=function(t){return this.Qu.Cu("Write",t)},e.prototype.onMessage=function(t){if(I(!!t.streamToken),this.lastStreamToken=t.streamToken,this.lh){this.Gu.reset();var e=function(t,e){return t&&t.length>0?(I(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?Dn(t.updateTime):Dn(e);n.isEqual(z.min())&&(n=Dn(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new Ae(n,r)}(t,e)}))):[]}(t.writeResults,t.commitTime),n=Dn(t.commitTime);return this.listener.dh(n,e)}return I(!t.writeResults||0===t.writeResults.length),this.lh=!0,this.listener.wh()},e.prototype.Eh=function(){var t={};t.database=Mn(this.Qt),this.th(t)},e.prototype.fh=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return zn(e.Qt,t)}))};this.th(n)},e}(Uo),zo=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Qu=n,i.Qt=r,i.Th=!1,i}return Object(h.c)(e,t),e.prototype.Ih=function(){if(this.Th)throw new q(D.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.pu=function(t,e,n){var r=this;return this.Ih(),this.credentials.getToken().then((function(i){return r.Qu.pu(t,e,n,i)})).catch((function(t){throw t.code===D.UNAUTHENTICATED&&r.credentials.p(),t}))},e.prototype.Du=function(t,e,n){var r=this;return this.Ih(),this.credentials.getToken().then((function(i){return r.Qu.Du(t,e,n,i)})).catch((function(t){throw t.code===D.UNAUTHENTICATED&&r.credentials.p(),t}))},e.prototype.terminate=function(){this.Th=!1},e}((function(){})),Bo=function(){function t(t,e){this._s=t,this.fa=e,this.state="Unknown",this.mh=0,this.Ah=null,this.Rh=!0}return t.prototype.Ph=function(){var t=this;0===this.mh&&(this.yh("Unknown"),this.Ah=this._s.Tr("online_state_timeout",1e4,(function(){return t.Ah=null,t.gh("Backend didn't respond within 10 seconds."),t.yh("Offline"),Promise.resolve()})))},t.prototype.Vh=function(t){"Online"===this.state?this.yh("Unknown"):(this.mh++,this.mh>=1&&(this.ph(),this.gh("Connection failed 1 times. Most recent error: "+t.toString()),this.yh("Offline")))},t.prototype.set=function(t){this.ph(),this.mh=0,"Online"===t&&(this.Rh=!1),this.yh(t)},t.prototype.yh=function(t){t!==this.state&&(this.state=t,this.fa(t))},t.prototype.gh=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Rh?(m(e),this.Rh=!1):y("OnlineStateTracker",e)},t.prototype.ph=function(){null!==this.Ah&&(this.Ah.cancel(),this.Ah=null)},t}(),Go=function(t,e,n,r,i){var o=this;this.bh=t,this.Sh=e,this._s=n,this.Dh={},this.Ch=[],this.xh=new Map,this.Nh=new Set,this.$h=[],this.Fh=i,this.Fh.ou((function(t){n.Ps((function(){return Object(h.b)(o,void 0,void 0,(function(){return Object(h.d)(this,(function(t){switch(t.label){case 0:return $o(this)?(y("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Object(h.b)(this,void 0,void 0,(function(){var e;return Object(h.d)(this,(function(n){switch(n.label){case 0:return(e=O(t)).Nh.add(4),[4,Qo(e)];case 1:return n.sent(),e.Oh.set("Unknown"),e.Nh.delete(4),[4,Ho(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Oh=new Bo(n,r)};function Ho(t){return Object(h.b)(this,void 0,void 0,(function(){var e,n;return Object(h.d)(this,(function(r){switch(r.label){case 0:if(!$o(t))return[3,4];e=0,n=t.$h,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Qo(t){return Object(h.b)(this,void 0,void 0,(function(){var e,n;return Object(h.d)(this,(function(r){switch(r.label){case 0:e=0,n=t.$h,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Yo(t,e){var n=O(t);n.xh.has(e.targetId)||(n.xh.set(e.targetId,e),Zo(n)?Jo(n):ds(n).Hu()&&Xo(n,e))}function Ko(t,e){var n=O(t),r=ds(n);n.xh.delete(e),r.Hu()&&Wo(n,e),0===n.xh.size&&(r.Hu()?r.Xu():$o(n)&&n.Oh.set("Unknown"))}function Xo(t,e){t.kh.on(e.targetId),ds(t).uh(e)}function Wo(t,e){t.kh.on(e),ds(t).hh(e)}function Jo(t){t.kh=new En({vn:function(e){return t.Dh.vn(e)},Sn:function(e){return t.xh.get(e)||null}}),ds(t).start(),t.Oh.Ph()}function Zo(t){return $o(t)&&!ds(t).zu()&&t.xh.size>0}function $o(t){return 0===O(t).Nh.size}function ts(t){t.kh=void 0}function es(t){return Object(h.b)(this,void 0,void 0,(function(){return Object(h.d)(this,(function(e){return t.xh.forEach((function(e,n){Xo(t,e)})),[2]}))}))}function ns(t,e){return Object(h.b)(this,void 0,void 0,(function(){return Object(h.d)(this,(function(n){return ts(t),Zo(t)?(t.Oh.Vh(e),Jo(t)):t.Oh.set("Unknown"),[2]}))}))}function rs(t,e,n){return Object(h.b)(this,void 0,void 0,(function(){var r,i,o;return Object(h.d)(this,(function(u){switch(u.label){case 0:if(t.Oh.set("Online"),!(e instanceof wn&&2===e.state&&e.cause))return[3,6];u.label=1;case 1:return u.trys.push([1,3,,5]),[4,function(t,e){return Object(h.b)(this,void 0,void 0,(function(){var n,r,i,o;return Object(h.d)(this,(function(u){switch(u.label){case 0:n=e.cause,r=0,i=e.targetIds,u.label=1;case 1:return r<i.length?(o=i[r],t.xh.has(o)?[4,t.Dh.Mh(o,n)]:[3,3]):[3,5];case 2:u.sent(),t.xh.delete(o),t.kh.removeTarget(o),u.label=3;case 3:u.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return u.sent(),[3,5];case 3:return r=u.sent(),y("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,is(t,r)];case 4:return u.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof bn?t.kh.dn(e):e instanceof mn?t.kh.Pn(e):t.kh.Tn(e),n.isEqual(z.min()))return[3,13];u.label=7;case 7:return u.trys.push([7,11,,13]),[4,Ji(t.bh)];case 8:return i=u.sent(),n._(i)>=0?[4,function(t,e){var n=t.kh.Vn(e);return n.$e.forEach((function(n,r){if(n.resumeToken.l()>0){var i=t.xh.get(r);i&&t.xh.set(r,i.Mt(n.resumeToken,e))}})),n.Fe.forEach((function(e){var n=t.xh.get(e);if(n){t.xh.set(e,n.Mt(x.T,n.Ot)),Wo(t,e);var r=new fe(n.target,e,1,n.sequenceNumber);Xo(t,r)}})),t.Dh.Lh(n)}(t,n)]:[3,10];case 9:u.sent(),u.label=10;case 10:return[3,13];case 11:return y("RemoteStore","Failed to raise snapshot:",o=u.sent()),[4,is(t,o)];case 12:return u.sent(),[3,13];case 13:return[2]}}))}))}function is(t,e,n){return Object(h.b)(this,void 0,void 0,(function(){var r=this;return Object(h.d)(this,(function(i){switch(i.label){case 0:if(!cr(e))throw e;return t.Nh.add(1),[4,Qo(t)];case 1:return i.sent(),t.Oh.set("Offline"),n||(n=function(){return Ji(t.bh)}),t._s.po((function(){return Object(h.b)(r,void 0,void 0,(function(){return Object(h.d)(this,(function(e){switch(e.label){case 0:return y("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Nh.delete(1),[4,Ho(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function os(t,e){return e().catch((function(n){return is(t,n,e)}))}function ss(t){return Object(h.b)(this,void 0,void 0,(function(){var e,n,r,i,o;return Object(h.d)(this,(function(u){switch(u.label){case 0:e=O(t),n=vs(e),r=e.Ch.length>0?e.Ch[e.Ch.length-1].batchId:-1,u.label=1;case 1:if(!function(t){return $o(t)&&t.Ch.length<10}(e))return[3,7];u.label=2;case 2:return u.trys.push([2,4,,6]),[4,to(e.bh,r)];case 3:return null===(i=u.sent())?(0===e.Ch.length&&n.Xu(),[3,7]):(r=i.batchId,function(t,e){t.Ch.push(e);var n=vs(t);n.Hu()&&n._h&&n.fh(e.mutations)}(e,i),[3,6]);case 4:return o=u.sent(),[4,is(e,o)];case 5:return u.sent(),[3,6];case 6:return[3,1];case 7:return us(e)&&as(e),[2]}}))}))}function us(t){return $o(t)&&!vs(t).zu()&&t.Ch.length>0}function as(t){vs(t).start()}function cs(t){return Object(h.b)(this,void 0,void 0,(function(){return Object(h.d)(this,(function(e){return vs(t).Eh(),[2]}))}))}function hs(t){return Object(h.b)(this,void 0,void 0,(function(){var e,n,r,i;return Object(h.d)(this,(function(o){for(e=vs(t),n=0,r=t.Ch;n<r.length;n++)i=r[n],e.fh(i.mutations);return[2]}))}))}function fs(t,e,n){return Object(h.b)(this,void 0,void 0,(function(){var r,i;return Object(h.d)(this,(function(o){switch(o.label){case 0:return r=t.Ch.shift(),i=Br.from(r,e,n),[4,os(t,(function(){return t.Dh.Bh(i)}))];case 1:return o.sent(),[4,ss(t)];case 2:return o.sent(),[2]}}))}))}function ls(t,e){return Object(h.b)(this,void 0,void 0,(function(){return Object(h.d)(this,(function(n){switch(n.label){case 0:return e&&vs(t)._h?[4,function(t,e){return Object(h.b)(this,void 0,void 0,(function(){var n,r;return Object(h.d)(this,(function(i){switch(i.label){case 0:return Ke(r=e.code)&&r!==D.ABORTED?(n=t.Ch.shift(),vs(t).Yu(),[4,os(t,(function(){return t.Dh.qh(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,ss(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return us(t)&&as(t),[2]}}))}))}function ps(t,e){return Object(h.b)(this,void 0,void 0,(function(){var n;return Object(h.d)(this,(function(i){switch(i.label){case 0:return n=O(t),e?(n.Nh.delete(2),[4,Ho(n)]):[3,2];case 1:return i.sent(),[3,5];case 2:return e?[3,4]:(n.Nh.add(2),[4,Qo(n)]);case 3:i.sent(),n.Oh.set("Unknown"),i.label=4;case 4:i.label=5;case 5:return[2]}}))}))}function ds(t){var e=this;return t.Uh||(t.Uh=function(t,e,n){var r=O(t);return r.Ih(),new Fo(e,r.Qu,r.credentials,r.Qt,n)}(t.Sh,t._s,{wu:es.bind(null,t),Tu:ns.bind(null,t),ah:rs.bind(null,t)}),t.$h.push((function(n){return Object(h.b)(e,void 0,void 0,(function(){return Object(h.d)(this,(function(e){switch(e.label){case 0:return n?(t.Uh.Yu(),Zo(t)?Jo(t):t.Oh.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Uh.stop()];case 2:e.sent(),ts(t),e.label=3;case 3:return[2]}}))}))}))),t.Uh}function vs(t){var e=this;return t.Qh||(t.Qh=function(t,e,n){var r=O(t);return r.Ih(),new qo(e,r.Qu,r.credentials,r.Qt,n)}(t.Sh,t._s,{wu:cs.bind(null,t),Tu:ls.bind(null,t),wh:hs.bind(null,t),dh:fs.bind(null,t)}),t.$h.push((function(n){return Object(h.b)(e,void 0,void 0,(function(){return Object(h.d)(this,(function(e){switch(e.label){case 0:return n?(t.Qh.Yu(),[4,ss(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Qh.stop()];case 3:e.sent(),t.Ch.length>0&&(y("RemoteStore","Stopping write stream with "+t.Ch.length+" pending writes"),t.Ch=[]),e.label=4;case 4:return[2]}}))}))}))),t.Qh}var ys=function(){this.Kh=void 0,this.listeners=[]},gs=function(){this.queries=new hi((function(t){return se(t)}),oe),this.onlineState="Unknown",this.Wh=new Set};function bs(t,e){return Object(h.b)(this,void 0,void 0,(function(){var n,r,i,o,u,s,a;return Object(h.d)(this,(function(c){switch(c.label){case 0:if(n=O(t),r=e.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new ys),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),u=o,[4,n.jh(r)];case 2:return u.Kh=c.sent(),[3,4];case 3:return s=c.sent(),a=vr(s,"Initialization of query '"+ue(e.query)+"' failed"),[2,void e.onError(a)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.Gh(n.onlineState),o.Kh&&e.zh(o.Kh)&&Es(n),[2]}}))}))}function ms(t,e){return Object(h.b)(this,void 0,void 0,(function(){var n,r,i,o,u;return Object(h.d)(this,(function(s){return n=O(t),r=e.query,i=!1,(o=n.queries.get(r))&&(u=o.listeners.indexOf(e))>=0&&(o.listeners.splice(u,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.Hh(r))]:[2]}))}))}function ws(t,e){for(var n=O(t),r=!1,i=0,o=e;i<o.length;i++){var u=o[i],s=u.query,a=n.queries.get(s);if(a){for(var c=0,h=a.listeners;c<h.length;c++)h[c].zh(u)&&(r=!0);a.Kh=u}}r&&Es(n)}function _s(t,e,n){var r=O(t),i=r.queries.get(e);if(i)for(var o=0,u=i.listeners;o<u.length;o++)u[o].onError(n);r.queries.delete(e)}function Es(t){t.Wh.forEach((function(t){t.next()}))}var Is=function(){function t(t,e,n){this.query=t,this.Jh=e,this.Yh=!1,this.Xh=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.zh=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new vn(t.query,t.docs,t.Se,e,t.De,t.fromCache,t.Ce,!0)}var o=!1;return this.Yh?this.Zh(t)&&(this.Jh.next(t),o=!0):this.tl(t,this.onlineState)&&(this.el(t),o=!0),this.Xh=t,o},t.prototype.onError=function(t){this.Jh.error(t)},t.prototype.Gh=function(t){this.onlineState=t;var e=!1;return this.Xh&&!this.Yh&&this.tl(this.Xh,t)&&(this.el(this.Xh),e=!0),e},t.prototype.tl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.nl&&n||t.docs.et()&&"Offline"!==e)},t.prototype.Zh=function(t){if(t.docChanges.length>0)return!0;var e=this.Xh&&this.Xh.hasPendingWrites!==t.hasPendingWrites;return!(!t.Ce&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.el=function(t){t=vn.Ne(t.query,t.docs,t.De,t.fromCache),this.Yh=!0,this.Jh.next(t)},t}(),Os=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.sl=function(){return"metadata"in this.payload},t}(),Ts=function(){function t(t){this.Qt=t}return t.prototype.Pc=function(t){return Rn(this.Qt,t)},t.prototype.yc=function(t){return t.metadata.exists?qn(this.Qt,t.document,!1):new jt(this.Pc(t.metadata.name),this.gc(t.metadata.readTime))},t.prototype.gc=function(t){return Dn(t)},t}();!function(){function t(t,e,n){this.il=t,this.bh=e,this.Qt=n,this.queries=[],this.documents=[],this.progress=js(t)}t.prototype.rl=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.ol=function(t){for(var e=new Map,n=new Ts(this.Qt),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var u=n.Pc(o.metadata.name),s=0,a=o.metadata.queries;s<a.length;s++){var c=a[s],h=(e.get(c)||hn()).add(u);e.set(c,h)}}return e},t.prototype.complete=function(){return Object(h.b)(this,void 0,void 0,(function(){var t,e,n,r,i;return Object(h.d)(this,(function(o){switch(o.label){case 0:return[4,uo(this.bh,new Ts(this.Qt),this.documents,this.il.id)];case 1:t=o.sent(),e=this.ol(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?(i=r[n],[4,ao(this.bh,i,e.get(i.name))]):[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Bi(Object.assign({},this.progress),t))]}}))}))}}();function js(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var Ns=function(t){this.key=t},As=function(t){this.key=t},Ss=function(){function t(t,e){this.query=t,this.cl=e,this.al=null,this.Be=!1,this.ul=hn(),this.De=hn(),this.hl=ce(t),this.ll=new pn(this.hl)}return Object.defineProperty(t.prototype,"_l",{get:function(){return this.cl},enumerable:!1,configurable:!0}),t.prototype.fl=function(t,e){var n=this,r=e?e.dl:new dn,i=e?e.ll:this.ll,o=e?e.De:this.De,u=i,s=!1,a=Jt(this.query)&&i.size===this.query.limit?i.last():null,c=Zt(this.query)&&i.size===this.query.limit?i.first():null;if(t.Xt((function(t,e){var h=i.get(t),f=e instanceof Tt?e:null;f&&(f=ae(n.query,f)?f:null);var l=!!h&&n.De.has(h.key),p=!!f&&(f.Vt||n.De.has(f.key)&&f.hasCommittedMutations),d=!1;h&&f?h.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.wl(h,f)||(r.track({type:2,doc:f}),d=!0,(a&&n.hl(f,a)>0||c&&n.hl(f,c)<0)&&(s=!0)):!h&&f?(r.track({type:0,doc:f}),d=!0):h&&!f&&(r.track({type:1,doc:h}),d=!0,(a||c)&&(s=!0)),d&&(f?(u=u.add(f),o=p?o.add(t):o.delete(t)):(u=u.delete(t),o=o.delete(t)))})),Jt(this.query)||Zt(this.query))for(;u.size>this.query.limit;){var h=Jt(this.query)?u.last():u.first();u=u.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{ll:u,dl:r,lc:s,De:o}},t.prototype.wl=function(t,e){return t.Vt&&e.hasCommittedMutations&&!e.Vt},t.prototype.wi=function(t,e,n){var r=this,i=this.ll;this.ll=t.ll,this.De=t.De;var o=t.dl.ve();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return E()}};return n(t)-n(e)}(t.type,e.type)||r.hl(t.doc,e.doc)})),this.El(n);var u=e?this.Tl():[],s=0===this.ul.size&&this.Be?1:0,a=s!==this.al;return this.al=s,0!==o.length||a?{snapshot:new vn(this.query,t.ll,i,o,t.De,0===s,a,!1),Il:u}:{Il:u}},t.prototype.Gh=function(t){return this.Be&&"Offline"===t?(this.Be=!1,this.wi({ll:this.ll,dl:new dn,De:this.De,lc:!1},!1)):{Il:[]}},t.prototype.ml=function(t){return!this.cl.has(t)&&!!this.ll.has(t)&&!this.ll.get(t).Vt},t.prototype.El=function(t){var e=this;t&&(t.qe.forEach((function(t){return e.cl=e.cl.add(t)})),t.Ue.forEach((function(t){})),t.Qe.forEach((function(t){return e.cl=e.cl.delete(t)})),this.Be=t.Be)},t.prototype.Tl=function(){var t=this;if(!this.Be)return[];var e=this.ul;this.ul=hn(),this.ll.forEach((function(e){t.ml(e.key)&&(t.ul=t.ul.add(e.key))}));var n=[];return e.forEach((function(e){t.ul.has(e)||n.push(new As(e))})),this.ul.forEach((function(t){e.has(t)||n.push(new Ns(t))})),n},t.prototype.Al=function(t){this.cl=t.Rc,this.ul=hn();var e=this.fl(t.documents);return this.wi(e,!0)},t.prototype.Rl=function(){return vn.Ne(this.query,this.ll,this.De,0===this.al)},t}(),xs=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Ds=function(t){this.key=t,this.Pl=!1},ks=function(){function t(t,e,n,r,i,o){this.bh=t,this.yl=e,this.gl=n,this.Vl=r,this.currentUser=i,this.pl=o,this.bl={},this.vl=new hi((function(t){return se(t)}),oe),this.Sl=new Map,this.Dl=new Set,this.Cl=new We(Y.H),this.xl=new Map,this.Nl=new ho,this.$l={},this.Fl=new Map,this.Ol=wi.Li(),this.onlineState="Unknown",this.kl=void 0}return Object.defineProperty(t.prototype,"Ml",{get:function(){return!0===this.kl},enumerable:!1,configurable:!0}),t}();function Ps(t,e){return Object(h.b)(this,void 0,void 0,(function(){var n,r,i,o,u,s;return Object(h.d)(this,(function(a){switch(a.label){case 0:return n=au(t),(o=n.vl.get(e))?(r=o.targetId,n.Vl.Fa(r),i=o.view.Rl(),[3,4]):[3,1];case 1:return[4,eo(n.bh,re(e))];case 2:return u=a.sent(),s=n.Vl.Fa(u.targetId),r=u.targetId,[4,Cs(n,e,r,"current"===s)];case 3:i=a.sent(),n.Ml&&Yo(n.yl,u),a.label=4;case 4:return[2,i]}}))}))}function Cs(t,e,n,r){return Object(h.b)(this,void 0,void 0,(function(){var i,o,u,s,a,c;return Object(h.d)(this,(function(f){switch(f.label){case 0:return t.Ll=function(e,n,r){return function(t,e,n,r){return Object(h.b)(this,void 0,void 0,(function(){var i,o,u;return Object(h.d)(this,(function(s){switch(s.label){case 0:return(i=e.view.fl(n)).lc?[4,ro(t.bh,e.query,!1).then((function(t){var n=t.documents;return e.view.fl(n,i)}))]:[3,2];case 1:i=s.sent(),s.label=2;case 2:return o=r&&r.$e.get(e.targetId),u=e.view.wi(i,t.Ml,o),[2,(Ys(t,e.targetId,u.Il),u.snapshot)]}}))}))}(t,e,n,r)},[4,ro(t.bh,e,!0)];case 1:return i=f.sent(),o=new Ss(e,i.Rc),u=o.fl(i.documents),s=gn.Le(n,r&&"Offline"!==t.onlineState),a=o.wi(u,t.Ml,s),Ys(t,n,a.Il),c=new xs(e,n,o),[2,(t.vl.set(e,c),t.Sl.has(n)?t.Sl.get(n).push(e):t.Sl.set(n,[e]),a.snapshot)]}}))}))}function Rs(t,e){return Object(h.b)(this,void 0,void 0,(function(){var n,r,i;return Object(h.d)(this,(function(o){switch(o.label){case 0:return n=O(t),r=n.vl.get(e),(i=n.Sl.get(r.targetId)).length>1?[2,(n.Sl.set(r.targetId,i.filter((function(t){return!oe(t,e)}))),void n.vl.delete(e))]:n.Ml?(n.Vl.ka(r.targetId),n.Vl.Da(r.targetId)?[3,2]:[4,no(n.bh,r.targetId,!1).then((function(){n.Vl.La(r.targetId),Ko(n.yl,r.targetId),Hs(n,r.targetId)})).catch(ci)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Hs(n,r.targetId),[4,no(n.bh,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function Ls(t,e,n){return Object(h.b)(this,void 0,void 0,(function(){var r,i,o,u;return Object(h.d)(this,(function(s){switch(s.label){case 0:r=cu(t),s.label=1;case 1:return s.trys.push([1,5,,6]),[4,function(t,e){var n,r=O(t),i=F.now(),o=e.reduce((function(t,e){return t.add(e.key)}),hn());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Tc.Xo(t,o).next((function(o){n=o;for(var u=[],s=0,a=e;s<a.length;s++){var c=a[s],h=Ce(c,n.get(c.key));null!=h&&u.push(new Me(c.key,h,It(h.proto.mapValue),Se.exists(!0)))}return r.zo.Ri(t,i,u,e)}))})).then((function(t){var e=t.xs(n);return{batchId:t.batchId,ri:e}}))}(r.bh,e)];case 2:return i=s.sent(),r.Vl.Ca(i.batchId),function(t,e,n){var r=t.$l[t.currentUser.A()];r||(r=new We(N)),r=r.zt(e,n),t.$l[t.currentUser.A()]=r}(r,i.batchId,n),[4,Ws(r,i.ri)];case 3:return s.sent(),[4,ss(r.yl)];case 4:return s.sent(),[3,6];case 5:return o=s.sent(),u=vr(o,"Failed to persist write"),n.reject(u),[3,6];case 6:return[2]}}))}))}function Vs(t,e){return Object(h.b)(this,void 0,void 0,(function(){var n,r;return Object(h.d)(this,(function(i){switch(i.label){case 0:n=O(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Zi(n.bh,e)];case 2:return r=i.sent(),e.$e.forEach((function(t,e){var r=n.xl.get(e);r&&(I(t.qe.size+t.Ue.size+t.Qe.size<=1),t.qe.size>0?r.Pl=!0:t.Ue.size>0?I(r.Pl):t.Qe.size>0&&(I(r.Pl),r.Pl=!1))})),[4,Ws(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,ci(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function Ms(t,e,n){var r=O(t);if(r.Ml&&0===n||!r.Ml&&1===n){var i=[];r.vl.forEach((function(t,n){var r=n.view.Gh(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=O(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].Gh(e)&&(r=!0)})),r&&Es(n)}(r.gl,e),i.length&&r.bl.ah(i),r.onlineState=e,r.Ml&&r.Vl.Qa(e)}}function Us(t,e,n){return Object(h.b)(this,void 0,void 0,(function(){var r,i,o,u,s,a;return Object(h.d)(this,(function(c){switch(c.label){case 0:return(r=O(t)).Vl.Ba(e,"rejected",n),i=r.xl.get(e),(o=i&&i.key)?(u=(u=new We(Y.H)).zt(o,new jt(o,z.min())),s=hn().add(o),a=new yn(z.min(),new Map,new $e(N),u,s),[4,Vs(r,a)]):[3,2];case 1:return c.sent(),r.Cl=r.Cl.remove(o),r.xl.delete(e),Xs(r),[3,4];case 2:return[4,no(r.bh,e,!1).then((function(){return Hs(r,e,n)})).catch(ci)];case 3:c.sent(),c.label=4;case 4:return[2]}}))}))}function Fs(t,e){return Object(h.b)(this,void 0,void 0,(function(){var n,r,i;return Object(h.d)(this,(function(o){switch(o.label){case 0:n=O(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,Wi(n.bh,e)];case 2:return i=o.sent(),Gs(n,r,null),Bs(n,r),n.Vl.Na(r,"acknowledged"),[4,Ws(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,ci(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function qs(t,e,n){return Object(h.b)(this,void 0,void 0,(function(){var r,i;return Object(h.d)(this,(function(o){switch(o.label){case 0:r=O(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=O(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n.zo.Pi(t,e).next((function(e){return I(null!==e),r=e.keys(),n.zo.Ci(t,e)})).next((function(){return n.zo.$i(t)})).next((function(){return n.Tc.Xo(t,r)}))}))}(r.bh,e)];case 2:return i=o.sent(),Gs(r,e,n),Bs(r,e),r.Vl.Na(e,"rejected",n),[4,Ws(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,ci(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function zs(t,e){return Object(h.b)(this,void 0,void 0,(function(){var n,r,i,o,u;return Object(h.d)(this,(function(s){switch(s.label){case 0:$o((n=O(t)).yl)||y("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,function(t){var e=O(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e.zo.Vi(t)}))}(n.bh)];case 2:return-1===(r=s.sent())?[2,void e.resolve()]:((i=n.Fl.get(r)||[]).push(e),n.Fl.set(r,i),[3,4]);case 3:return o=s.sent(),u=vr(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(u),[3,4];case 4:return[2]}}))}))}function Bs(t,e){(t.Fl.get(e)||[]).forEach((function(t){t.resolve()})),t.Fl.delete(e)}function Gs(t,e,n){var r=O(t),i=r.$l[r.currentUser.A()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.$l[r.currentUser.A()]=i}}function Hs(t,e,n){void 0===n&&(n=null),t.Vl.ka(e);for(var r=0,i=t.Sl.get(e);r<i.length;r++){var o=i[r];t.vl.delete(o),n&&t.bl.Bl(o,n)}t.Sl.delete(e),t.Ml&&t.Nl.Fc(e).forEach((function(e){t.Nl.Fi(e)||Qs(t,e)}))}function Qs(t,e){t.Dl.delete(e.path.rt());var n=t.Cl.get(e);null!==n&&(Ko(t.yl,n),t.Cl=t.Cl.remove(e),t.xl.delete(n),Xs(t))}function Ys(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Ns?(t.Nl.nr(o.key,e),Ks(t,o)):o instanceof As?(y("SyncEngine","Document no longer in limbo: "+o.key),t.Nl.ir(o.key,e),t.Nl.Fi(o.key)||Qs(t,o.key)):E()}}function Ks(t,e){var n=e.key,r=n.path.rt();t.Cl.get(n)||t.Dl.has(r)||(y("SyncEngine","New document in limbo: "+n),t.Dl.add(r),Xs(t))}function Xs(t){for(;t.Dl.size>0&&t.Cl.size<t.pl;){var e=t.Dl.values().next().value;t.Dl.delete(e);var n=new Y(G.ot(e)),r=t.Ol.next();t.xl.set(r,new Ds(n)),t.Cl=t.Cl.zt(n,r),Yo(t.yl,new fe(re(Wt(n.path)),r,2,U.q))}}function Ws(t,e,n){return Object(h.b)(this,void 0,void 0,(function(){var r,i,o,u;return Object(h.d)(this,(function(s){switch(s.label){case 0:return r=O(t),i=[],o=[],u=[],r.vl.et()?[3,3]:(r.vl.forEach((function(t,s){u.push(r.Ll(s,e,n).then((function(t){if(t){r.Ml&&r.Vl.Ba(s.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=Hi.oc(s.targetId,t);o.push(e)}})))})),[4,Promise.all(u)]);case 1:return s.sent(),r.bl.ah(i),[4,function(t,e){return Object(h.b)(this,void 0,void 0,(function(){var n,r,i,o,u,s,a,c,f;return Object(h.d)(this,(function(h){switch(h.label){case 0:n=O(t),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return ir.forEach(e,(function(e){return ir.forEach(e.ic,(function(r){return n.persistence.Ti.nr(t,e.targetId,r)})).next((function(){return ir.forEach(e.rc,(function(r){return n.persistence.Ti.ir(t,e.targetId,r)}))}))}))}))];case 2:return h.sent(),[3,4];case 3:if(!cr(r=h.sent()))throw r;return y("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)u=o[i],s=u.targetId,u.fromCache||(a=n.fc.get(s),c=a.Ot,f=a.Lt(c),n.fc=n.fc.zt(s,f));return[2]}}))}))}(r.bh,o)];case 2:s.sent(),s.label=3;case 3:return[2]}}))}))}function Js(t,e){return Object(h.b)(this,void 0,void 0,(function(){var n,r;return Object(h.d)(this,(function(i){switch(i.label){case 0:return(n=O(t)).currentUser.isEqual(e)?[3,3]:(y("SyncEngine","User change. New user:",e.A()),[4,Xi(n.bh,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Fl.forEach((function(t){t.forEach((function(t){t.reject(new q(D.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Fl.clear()}(n),n.Vl.Ua(e,r.mc,r.Ac),[4,Ws(n,r.Ic)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function Zs(t,e){var n=O(t),r=n.xl.get(e);if(r&&r.Pl)return hn().add(r.key);var i=hn(),o=n.Sl.get(e);if(!o)return i;for(var u=0,s=o;u<s.length;u++){var a=s[u],c=n.vl.get(a);i=i.Pe(c.view._l)}return i}function $s(t,e){return Object(h.b)(this,void 0,void 0,(function(){var n,r,i;return Object(h.d)(this,(function(o){switch(o.label){case 0:return[4,ro((n=O(t)).bh,e.query,!0)];case 1:return r=o.sent(),i=e.view.Al(r),[2,(n.Ml&&Ys(n,e.targetId,i.Il),i)]}}))}))}function tu(t){return Object(h.b)(this,void 0,void 0,(function(){var e;return Object(h.d)(this,(function(n){return[2,oo((e=O(t)).bh).then((function(t){return Ws(e,t)}))]}))}))}function eu(t,e,n,r){return Object(h.b)(this,void 0,void 0,(function(){var i,o;return Object(h.d)(this,(function(u){switch(u.label){case 0:return[4,function(t,e){var n=O(t),r=O(n.zo);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.yi(t,e).next((function(e){return e?n.Tc.Xo(t,e):ir.resolve(null)}))}))}((i=O(t)).bh,e)];case 1:return null===(o=u.sent())?[3,6]:"pending"!==n?[3,3]:[4,ss(i.yl)];case 2:return u.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(Gs(i,e,r||null),Bs(i,e),function(t,e){O(O(t).zo).xi(e)}(i.bh,e)):E(),u.label=4;case 4:return[4,Ws(i,o)];case 5:return u.sent(),[3,7];case 6:y("SyncEngine","Cannot apply mutation batch with id: "+e),u.label=7;case 7:return[2]}}))}))}function nu(t,e){return Object(h.b)(this,void 0,void 0,(function(){var n,r,i,o,u,s,a,c;return Object(h.d)(this,(function(h){switch(h.label){case 0:return au(n=O(t)),cu(n),!0!==e||!0===n.kl?[3,3]:(r=n.Vl.va(),[4,ru(n,r.it())]);case 1:return i=h.sent(),n.kl=!0,[4,ps(n.yl,!0)];case 2:for(h.sent(),o=0,u=i;o<u.length;o++)s=u[o],Yo(n.yl,s);return[3,7];case 3:return!1!==e||!1===n.kl?[3,7]:(a=[],c=Promise.resolve(),n.Sl.forEach((function(t,e){n.Vl.Ma(e)?a.push(e):c=c.then((function(){return Hs(n,e),no(n.bh,e,!0)})),Ko(n.yl,e)})),[4,c]);case 4:return h.sent(),[4,ru(n,a)];case 5:return h.sent(),function(t){var e=O(t);e.xl.forEach((function(t,n){Ko(e.yl,n)})),e.Nl.Oc(),e.xl=new Map,e.Cl=new We(Y.H)}(n),n.kl=!1,[4,ps(n.yl,!1)];case 6:h.sent(),h.label=7;case 7:return[2]}}))}))}function ru(t,e,n){return Object(h.b)(this,void 0,void 0,(function(){var n,r,i,o,u,s,a,c,f,l,d,p,v,y;return Object(h.d)(this,(function(h){switch(h.label){case 0:n=O(t),r=[],i=[],o=0,u=e,h.label=1;case 1:return o<u.length?(s=u[o],a=void 0,(c=n.Sl.get(s))&&0!==c.length?[4,eo(n.bh,re(c[0]))]:[3,7]):[3,13];case 2:a=h.sent(),f=0,l=c,h.label=3;case 3:return f<l.length?(d=l[f],p=n.vl.get(d),[4,$s(n,p)]):[3,6];case 4:(v=h.sent()).snapshot&&i.push(v.snapshot),h.label=5;case 5:return f++,[3,3];case 6:return[3,11];case 7:return[4,io(n.bh,s)];case 8:return y=h.sent(),[4,eo(n.bh,y)];case 9:return a=h.sent(),[4,Cs(n,iu(y),s,!1)];case 10:h.sent(),h.label=11;case 11:r.push(a),h.label=12;case 12:return o++,[3,1];case 13:return[2,(n.bl.ah(i),r)]}}))}))}function iu(t){return Xt(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function ou(t){var e=O(t);return O(O(e.bh).persistence).Uo()}function su(t,e,n,r){return Object(h.b)(this,void 0,void 0,(function(){var i,o,u;return Object(h.d)(this,(function(s){switch(s.label){case 0:return(i=O(t)).kl?(y("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Sl.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,oo(i.bh)];case 3:return o=s.sent(),u=yn.Me(e,"current"===n),[4,Ws(i,o,u)];case 4:return s.sent(),[3,8];case 5:return[4,no(i.bh,e,!0)];case 6:return s.sent(),Hs(i,e,r),[3,8];case 7:E(),s.label=8;case 8:return[2]}}))}))}function uu(t,e,n){return Object(h.b)(this,void 0,void 0,(function(){var r,i,o,u,s,a,c,f,l,d;return Object(h.d)(this,(function(p){switch(p.label){case 0:if(!(r=au(t)).kl)return[3,10];i=0,o=e,p.label=1;case 1:return i<o.length?(u=o[i],r.Sl.has(u)?(y("SyncEngine","Adding an already active target "+u),[3,5]):[4,io(r.bh,u)]):[3,6];case 2:return s=p.sent(),[4,eo(r.bh,s)];case 3:return a=p.sent(),[4,Cs(r,iu(s),a.targetId,!1)];case 4:p.sent(),Yo(r.yl,a),p.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Object(h.d)(this,(function(e){switch(e.label){case 0:return r.Sl.has(t)?[4,no(r.bh,t,!1).then((function(){Ko(r.yl,t),Hs(r,t)})).catch(ci)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},f=0,l=n,p.label=7;case 7:return f<l.length?(d=l[f],[5,c(d)]):[3,10];case 8:p.sent(),p.label=9;case 9:return f++,[3,7];case 10:return[2]}}))}))}function au(t){var e=O(t);return e.yl.Dh.Lh=Vs.bind(null,e),e.yl.Dh.vn=Zs.bind(null,e),e.yl.Dh.Mh=Us.bind(null,e),e.bl.ah=ws.bind(null,e.gl),e.bl.Bl=_s.bind(null,e.gl),e}function cu(t){var e=O(t);return e.yl.Dh.Bh=Fs.bind(null,e),e.yl.Dh.qh=qs.bind(null,e),e}var hu=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Object(h.b)(this,void 0,void 0,(function(){return Object(h.d)(this,(function(e){switch(e.label){case 0:return this.Qt=Vo(t.yu.t),this.Vl=this.Wl(t),this.persistence=this.jl(t),[4,this.persistence.start()];case 1:return e.sent(),this.Gl=this.zl(t),this.bh=this.Hl(t),[2]}}))}))},t.prototype.zl=function(t){return null},t.prototype.Hl=function(t){return Ki(this.persistence,new Qi,t.Jl,this.Qt)},t.prototype.jl=function(t){return new go(mo.ia,this.Qt)},t.prototype.Wl=function(t){return new So},t.prototype.terminate=function(){return Object(h.b)(this,void 0,void 0,(function(){return Object(h.d)(this,(function(t){switch(t.label){case 0:return this.Gl&&this.Gl.stop(),[4,this.Vl.ko()];case 1:return t.sent(),[4,this.persistence.ko()];case 2:return t.sent(),[2]}}))}))},t}(),fu=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Yl=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(h.c)(e,t),e.prototype.initialize=function(e){return Object(h.b)(this,void 0,void 0,(function(){return Object(h.d)(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,so(this.bh)];case 2:return n.sent(),[4,this.Yl.initialize(this,e)];case 3:return n.sent(),[4,cu(this.Yl._a)];case 4:return n.sent(),[4,ss(this.Yl.yl)];case 5:return n.sent(),[2]}}))}))},e.prototype.Hl=function(t){return Ki(this.persistence,new Qi,t.Jl,this.Qt)},e.prototype.zl=function(t){var e=this.persistence.Ti.lr;return new Ni(e,t._s)},e.prototype.jl=function(t){var e=zi(t.yu.t,t.yu.persistenceKey),n=void 0!==this.cacheSizeBytes?ai.Ys(this.cacheSizeBytes):ai.ti;return new Ui(this.synchronizeTabs,e,t.clientId,n,t._s,Ro(),Lo(),this.Qt,this.Vl,!!this.forceOwnership)},e.prototype.Wl=function(t){return new So},e}(hu),lu=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Yl=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(h.c)(e,t),e.prototype.initialize=function(e){return Object(h.b)(this,void 0,void 0,(function(){var n,r=this;return Object(h.d)(this,(function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Yl._a,this.Vl instanceof Ao?(this.Vl._a={eu:eu.bind(null,n),nu:su.bind(null,n),su:uu.bind(null,n),Uo:ou.bind(null,n),tu:tu.bind(null,n)},[4,this.Vl.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.Ro((function(t){return Object(h.b)(r,void 0,void 0,(function(){return Object(h.d)(this,(function(e){switch(e.label){case 0:return[4,nu(this.Yl._a,t)];case 1:return e.sent(),this.Gl&&(t&&!this.Gl.Er?this.Gl.start(this.bh):t||this.Gl.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},e.prototype.Wl=function(t){var e=Ro();if(!Ao.Kn(e))throw new q(D.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=zi(t.yu.t,t.yu.persistenceKey);return new Ao(e,t._s,n,t.clientId,t.Jl)},e}(fu),pu=function(){function t(){}return t.prototype.initialize=function(t,e){return Object(h.b)(this,void 0,void 0,(function(){var n=this;return Object(h.d)(this,(function(r){switch(r.label){case 0:return this.bh?[3,2]:(this.bh=t.bh,this.Vl=t.Vl,this.Sh=this.Xl(e),this.yl=this.Zl(e),this.gl=this.t_(e),this._a=this.e_(e,!t.synchronizeTabs),this.Vl.fa=function(t){return Ms(n._a,t,1)},this.yl.Dh.n_=Js.bind(null,this._a),[4,ps(this.yl,this._a.Ml)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.t_=function(t){return new gs},t.prototype.Xl=function(t){var e,n=Vo(t.yu.t),r=(e=t.yu,new Co(e));return function(t,e,n){return new zo(t,e,n)}(t.credentials,r,n)},t.prototype.Zl=function(t){var e,n,r,i,o,u=this;return e=this.bh,n=this.Sh,r=t._s,i=function(t){return Ms(u._a,t,0)},o=Do.Kn()?new Do:new xo,new Go(e,n,r,i,o)},t.prototype.e_=function(t,e){return function(t,e,n,r,i,o,u){var s=new ks(t,e,n,r,i,o);return u&&(s.kl=!0),s}(this.bh,this.yl,this.gl,this.Vl,t.Jl,t.pl,e)},t.prototype.terminate=function(){return function(t){return Object(h.b)(this,void 0,void 0,(function(){var e;return Object(h.d)(this,(function(n){switch(n.label){case 0:return e=O(t),y("RemoteStore","RemoteStore shutting down."),e.Nh.add(5),[4,Qo(e)];case 1:return n.sent(),e.Fh.ko(),e.Oh.set("Unknown"),[2]}}))}))}(this.yl)},t}();var du=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.s_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.s_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.i_=function(){this.muted=!0},t.prototype.s_=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),vu=(function(){function t(t,e){var n=this;this.r_=t,this.Qt=e,this.metadata=new rr,this.buffer=new Uint8Array,this.o_=new TextDecoder("utf-8"),this.c_().then((function(t){t&&t.sl()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))}),(function(t){return n.metadata.reject(t)}))}t.prototype.close=function(){return this.r_.cancel()},t.prototype.getMetadata=function(){return Object(h.b)(this,void 0,void 0,(function(){return Object(h.d)(this,(function(t){return[2,this.metadata.promise]}))}))},t.prototype.Ql=function(){return Object(h.b)(this,void 0,void 0,(function(){return Object(h.d)(this,(function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.c_())]}}))}))},t.prototype.c_=function(){return Object(h.b)(this,void 0,void 0,(function(){var t,e,n,r;return Object(h.d)(this,(function(i){switch(i.label){case 0:return[4,this.a_()];case 1:return null===(t=i.sent())?[2,null]:(e=this.o_.decode(t),n=Number(e),isNaN(n)&&this.u_("length string ("+e+") is not valid number"),[4,this.h_(n)]);case 2:return r=i.sent(),[2,new Os(JSON.parse(r),t.length+n)]}}))}))},t.prototype.l_=function(){return this.buffer.findIndex((function(t){return t==="{".charCodeAt(0)}))},t.prototype.a_=function(){return Object(h.b)(this,void 0,void 0,(function(){var t,e;return Object(h.d)(this,(function(n){switch(n.label){case 0:return this.l_()<0?[4,this.__()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.l_())<0&&this.u_("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}}))}))},t.prototype.h_=function(t){return Object(h.b)(this,void 0,void 0,(function(){var e;return Object(h.d)(this,(function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.__()]:[3,3];case 1:n.sent()&&this.u_("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.o_.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}}))}))},t.prototype.u_=function(t){throw this.r_.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.__=function(){return Object(h.b)(this,void 0,void 0,(function(){var t,e;return Object(h.d)(this,(function(n){switch(n.label){case 0:return[4,this.r_.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}}))}))}}(),function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new q(D.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.f_=new Q(t)}return t.prototype.isEqual=function(t){return this.f_.isEqual(t.f_)},t}()),yu=function(t){this._methodName=t},gu=function(t){this.d_=t};function bu(t,e,n){if(!n)throw new q(D.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function mu(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new q(D.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function wu(t,e,n,r){if(!0===e&&!0===r)throw new q(D.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function _u(t){if(!Y.wt(t))throw new q(D.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Eu(t){if(Y.wt(t))throw new q(D.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Iu(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":E()}function Ou(t,e){if("_delegate"in t&&(t=t.d_),!(t instanceof e)){if(e.name===t.constructor.name)throw new q(D.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Iu(t);throw new q(D.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Tu(t,e){if(e<=0)throw new q(D.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var ju=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new q(D.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new q(D.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,wu("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),Nu=new Map,Au=function(){function t(t,e){this.w_="(lite)",this.E_=new ju({}),this.T_=!1,t instanceof l?(this.I_=t,this.m_=new R):(this.A_=t,this.I_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new q(D.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new l(t.options.projectId)}(t),this.m_=new L(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this.A_)throw new q(D.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"R_",{get:function(){return this.T_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"P_",{get:function(){return void 0!==this.y_},enumerable:!1,configurable:!0}),t.prototype.g_=function(t){if(this.T_)throw new q(D.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.E_=new ju(t),void 0!==t.credentials&&(this.m_=function(t){if(!t)return new R;switch(t.type){case"gapi":var e=t.client;return I(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new M(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new q(D.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype.V_=function(){return this.E_},t.prototype.p_=function(){return this.T_=!0,this.E_},t.prototype._delete=function(){return this.y_||(this.y_=this.b_()),this.y_},t.prototype.toJSON=function(){return{app:this.A_,t:this.I_,settings:this.E_}},t.prototype.b_=function(){return this,(t=Nu.get(this))&&(y("ComponentProvider","Removing Datastore"),Nu.delete(this),t.terminate()),Promise.resolve();var t},t}(),Su=function(){function t(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.S_.path.rt()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Du(this.firestore,this.v_,this.S_.path.X())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this.S_)},t}(),xu=function(){function t(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this.C_)},t}(),Du=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,Wt(r))||this).firestore=e,i.D_=r,i.type="collection",i}return Object(h.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.C_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.C_.path.rt()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.D_.X();return t.et()?null:new Su(this.firestore,null,new Y(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this.D_)},e}(xu);function ku(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof gu&&(t=t.d_),bu("collection","path",e),t instanceof Au)return Eu(n=G.ot.apply(G,Object(h.g)([e],r))),new Du(t,null,n);if(!(t instanceof Su||t instanceof Du))throw new q(D.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Eu(n=G.ot.apply(G,Object(h.g)([t.path],r)).child(G.ot(e))),new Du(t.firestore,null,n)}function Pu(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof gu&&(t=t.d_),1===arguments.length&&(e=j.u()),bu("doc","path",e),t instanceof Au)return _u(n=G.ot.apply(G,Object(h.g)([e],r))),new Su(t,null,new Y(n));if(!(t instanceof Su||t instanceof Du))throw new q(D.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return _u(n=t.D_.child(G.ot.apply(G,Object(h.g)([e],r)))),new Su(t.firestore,t instanceof Du?t.v_:null,new Y(n))}function Cu(t,e){return t instanceof gu&&(t=t.d_),e instanceof gu&&(e=e.d_),(t instanceof Su||t instanceof Du)&&(e instanceof Su||e instanceof Du)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function Ru(t,e){return t instanceof gu&&(t=t.d_),e instanceof gu&&(e=e.d_),t instanceof xu&&e instanceof xu&&t.firestore===e.firestore&&oe(t.C_,e.C_)&&t.v_===e.v_}var Lu=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new q(D.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new q(D.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},t.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},t.prototype.U=function(t){return N(this.x_,t.x_)||N(this.N_,t.N_)},t}(),Vu=/^__.*__$/,Mu=function(){function t(t,e,n){this.data=t,this.Gt=e,this.fieldTransforms=n}return t.prototype.F_=function(t,e){return null!==this.Gt?new Me(t,this.data,this.Gt,e,this.fieldTransforms):new Ve(t,this.data,e,this.fieldTransforms)},t}(),Uu=function(){function t(t,e,n){this.data=t,this.Gt=e,this.fieldTransforms=n}return t.prototype.F_=function(t,e){return new Me(t,this.data,this.Gt,e,this.fieldTransforms)},t}();function Fu(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw E()}}var qu=function(){function t(t,e,n,r,i,o){this.settings=t,this.t=e,this.Qt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.O_(),this.fieldTransforms=i||[],this.Gt=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),t.prototype.M_=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.t,this.Qt,this.ignoreUndefinedProperties,this.fieldTransforms,this.Gt)},t.prototype.L_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.q_(t),r},t.prototype.U_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.O_(),r},t.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},t.prototype.K_=function(t){return ua(t,this.settings.methodName,this.settings.W_||!1,this.path,this.settings.j_)},t.prototype.contains=function(t){return void 0!==this.Gt.find((function(e){return t.nt(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.nt(e.field)}))},t.prototype.O_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},t.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if(Fu(this.k_)&&Vu.test(t))throw this.K_('Document fields cannot begin and end with "__"')},t}(),zu=function(){function t(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.Qt=n||Vo(t)}return t.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new qu({k_:t,methodName:e,j_:n,path:Q.ct(),B_:!1,W_:r},this.t,this.Qt,this.ignoreUndefinedProperties)},t}();function Bu(t){var e=t.p_(),n=Vo(t.I_);return new zu(t.I_,!!e.ignoreUndefinedProperties,n)}function Gu(t,e,n,r,i,o){void 0===o&&(o={});var u=t.G_(o.merge||o.mergeFields?2:0,e,n,i);ra("Data must be an object, but it was:",u,r);var s,a,c=ea(r,u);if(o.merge)s=new W(u.Gt),a=u.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=ia(e,l[f],n);if(!u.contains(p))throw new q(D.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");aa(h,p)||h.push(p)}s=new W(h),a=u.fieldTransforms.filter((function(t){return s.Tt(t.field)}))}else s=null,a=u.fieldTransforms;return new Mu(new _t(c),s,a)}var Hu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(h.c)(e,t),e.prototype.z_=function(t){if(2!==t.k_)throw 1===t.k_?t.K_(this._methodName+"() can only appear at the top level of your update data"):t.K_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.Gt.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(yu);function Qu(t,e,n){return new qu({k_:3,j_:e.settings.j_,methodName:t._methodName,B_:n},e.t,e.Qt,e.ignoreUndefinedProperties)}var Yu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(h.c)(e,t),e.prototype.z_=function(t){return new Ne(t.path,new me)},e.prototype.isEqual=function(t){return t instanceof e},e}(yu),Ku=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return Object(h.c)(e,t),e.prototype.z_=function(t){var e=Qu(this,t,!0),n=this.H_.map((function(t){return ta(t,e)})),r=new we(n);return new Ne(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(yu),Xu=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return Object(h.c)(e,t),e.prototype.z_=function(t){var e=Qu(this,t,!0),n=this.H_.map((function(t){return ta(t,e)})),r=new Ee(n);return new Ne(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(yu),Wu=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).J_=n,r}return Object(h.c)(e,t),e.prototype.z_=function(t){var e=new Oe(t.Qt,de(t.Qt,this.J_));return new Ne(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(yu);function Ju(t,e,n,r){var i=t.G_(1,e,n);ra("Data must be an object, but it was:",i,r);var o=[],u=new Et;X(r,(function(t,r){var s=sa(e,t,n);r instanceof gu&&(r=r.d_);var a=i.U_(s);if(r instanceof Hu)o.push(s);else{var c=ta(r,a);null!=c&&(o.push(s),u.set(s,c))}}));var s=new W(o);return new Uu(u.Pt(),s,i.fieldTransforms)}function Zu(t,e,n,r,i,o){var u=t.G_(1,e,n),s=[ia(e,r,n)],a=[i];if(o.length%2!=0)throw new q(D.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)s.push(ia(e,o[c])),a.push(o[c+1]);for(var h=[],f=new Et,l=s.length-1;l>=0;--l)if(!aa(h,s[l])){var p=s[l],d=a[l];d instanceof gu&&(d=d.d_);var v=u.U_(p);if(d instanceof Hu)h.push(p);else{var y=ta(d,v);null!=y&&(h.push(p),f.set(p,y))}}var m=new W(h);return new Uu(f.Pt(),m,u.fieldTransforms)}function $u(t,e,n,r){return void 0===r&&(r=!1),ta(n,t.G_(r?4:3,e))}function ta(t,e){if(t instanceof gu&&(t=t.d_),na(t))return ra("Unsupported field value:",e,t),ea(t,e);if(t instanceof yu)return function(t,e){if(!Fu(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");var n=t.z_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.Gt.push(e.path),t instanceof Array){if(e.settings.B_&&4!==e.k_)throw e.K_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var u=ta(o[i],e.Q_(r));null==u&&(u={nullValue:"NULL_VALUE"}),n.push(u),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof gu&&(t=t.d_),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return de(e.Qt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=F.fromDate(t);return{timestampValue:An(e.Qt,n)}}if(t instanceof F)return n=new F(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:An(e.Qt,n)};if(t instanceof Lu)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof k)return{bytesValue:Sn(e.Qt,t.I)};if(t instanceof Su){n=e.t;var r=t.firestore.I_;if(!r.isEqual(n))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:kn(t.firestore.I_||e.t,t.S_.path)}}throw e.K_("Unsupported field value: "+Iu(t))}(t,e)}function ea(t,e){var n={};return rt(t)?e.path&&e.path.length>0&&e.Gt.push(e.path):X(t,(function(t,r){var i=ta(r,e.L_(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function na(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof F||t instanceof Lu||t instanceof k||t instanceof Su||t instanceof yu)}function ra(t,e,n){if(!na(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=Iu(n);throw"an object"===r?e.K_(t+" a custom object"):e.K_(t+" "+r)}}function ia(t,e,n){if(e instanceof gu&&(e=e.d_),e instanceof vu)return e.f_;if("string"==typeof e)return sa(t,e);throw ua("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var oa=new RegExp("[~\\*/\\[\\]]");function sa(t,e,n){if(e.search(oa)>=0)throw ua("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(vu.bind.apply(vu,Object(h.g)([void 0],e.split("."))))).f_}catch(r){throw ua("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function ua(t,e,n,r,i){var o=r&&!r.et(),u=void 0!==i,s="Function "+e+"() called with invalid data";n&&(s+=" (via `toFirestore()`)");var a="";return(o||u)&&(a+=" (found",o&&(a+=" in field "+r),u&&(a+=" in document "+i),a+=")"),new q(D.INVALID_ARGUMENT,(s+=". ")+t+a)}function aa(t,e){return t.some((function(t){return t.isEqual(e)}))}var ca=function(){function t(t){this.Sh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}return t.prototype.ef=function(t){return Object(h.b)(this,void 0,void 0,(function(){var e,n=this;return Object(h.d)(this,(function(r){switch(r.label){case 0:if(this.nf(),this.mutations.length>0)throw new q(D.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Object(h.b)(this,void 0,void 0,(function(){var n,r,i,o,u,s;return Object(h.d)(this,(function(a){switch(a.label){case 0:return n=O(t),r=Mn(n.Qt)+"/documents",i={documents:e.map((function(t){return Cn(n.Qt,t)}))},[4,n.Du("BatchGetDocuments",r,i)];case 1:return o=a.sent(),u=new Map,o.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){I(!!e.found),e.found.name,e.found.updateTime;var n=Rn(t,e.found.name),r=Dn(e.found.updateTime),i=new _t({mapValue:{fields:e.found.fields}});return new Tt(n,r,i,{})}(t,e):"missing"in e?function(t,e){I(!!e.missing),I(!!e.readTime);var n=Rn(t,e.missing),r=Dn(e.readTime);return new jt(n,r)}(t,e):E()}(n.Qt,t);u.set(e.key.toString(),e)})),s=[],[2,(e.forEach((function(t){var e=u.get(t.toString());I(!!e),s.push(e)})),s)]}}))}))}(this.Sh,t)];case 1:return[2,((e=r.sent()).forEach((function(t){t instanceof jt||t instanceof Tt?n.sf(t):E()})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.F_(t,this.jt(t))),this.tf.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.F_(t,this.rf(t)))}catch(t){this.Z_=t}this.tf.add(t.toString())},t.prototype.delete=function(t){this.write(new He(t,this.jt(t))),this.tf.add(t.toString())},t.prototype.commit=function(){return Object(h.b)(this,void 0,void 0,(function(){var t,e=this;return Object(h.d)(this,(function(n){switch(n.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return t=this.Y_,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=Y._t(n);e.mutations.push(new Qe(r,e.jt(r)))})),[4,function(t,e){return Object(h.b)(this,void 0,void 0,(function(){var n,r,i;return Object(h.d)(this,(function(o){switch(o.label){case 0:return n=O(t),r=Mn(n.Qt)+"/documents",i={writes:e.map((function(t){return zn(n.Qt,t)}))},[4,n.pu("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.Sh,this.mutations)];case 1:return n.sent(),this.X_=!0,[2]}}))}))},t.prototype.sf=function(t){var e;if(t instanceof Tt)e=t.version;else{if(!(t instanceof jt))throw E();e=z.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new q(D.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},t.prototype.jt=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?Se.updateTime(e):Se.Kt()},t.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(!this.tf.has(t.toString())&&e){if(e.isEqual(z.min()))throw new q(D.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Se.updateTime(e)}return Se.exists(!0)},t.prototype.write=function(t){this.nf(),this.mutations.push(t)},t.prototype.nf=function(){},t}(),ha=function(){function t(t,e,n,r){this._s=t,this.Sh=e,this.updateFunction=n,this.Es=r,this.cf=5,this.Gu=new Mo(this._s,"transaction_retry")}return t.prototype.run=function(){this.af()},t.prototype.af=function(){var t=this;this.Gu.Lu((function(){return Object(h.b)(t,void 0,void 0,(function(){var t,e,n=this;return Object(h.d)(this,(function(r){return t=new ca(this.Sh),(e=this.uf(t))&&e.then((function(e){n._s.Ps((function(){return t.commit().then((function(){n.Es.resolve(e)})).catch((function(t){n.hf(t)}))}))})).catch((function(t){n.hf(t)})),[2]}))}))}))},t.prototype.uf=function(t){try{var e=this.updateFunction(t);return!ot(e)&&e.catch&&e.then?e:(this.Es.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Es.reject(t),null}},t.prototype.hf=function(t){var e=this;this.cf>0&&this.lf(t)?(this.cf-=1,this._s.Ps((function(){return e.af(),Promise.resolve()}))):this.Es.reject(t)},t.prototype.lf=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Ke(e)}return!1},t}(),fa=function(){function t(t,e,n){var r=this;this.credentials=t,this._s=e,this.yu=n,this.user=P.UNAUTHENTICATED,this.clientId=j.u(),this._f=function(){},this.C=new rr,this.credentials.v((function(t){y("FirestoreClient","Received user=",t.uid),r.user=t,r._f(t),r.C.resolve()}))}return t.prototype.getConfiguration=function(){return Object(h.b)(this,void 0,void 0,(function(){return Object(h.d)(this,(function(t){switch(t.label){case 0:return[4,this.C.promise];case 1:return[2,(t.sent(),{_s:this._s,yu:this.yu,clientId:this.clientId,credentials:this.credentials,Jl:this.user,pl:100})]}}))}))},t.prototype.ff=function(t){var e=this;this._f=t,this.C.promise.then((function(){return e._f(e.user)}))},t.prototype.df=function(){if(this._s.wf)throw new q(D.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this._s.Ef();var e=new rr;return this._s.Tf((function(){return Object(h.b)(t,void 0,void 0,(function(){var t,n;return Object(h.d)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.S(),e.resolve(),[3,6];case 5:return t=r.sent(),n=vr(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();function la(t,e){return Object(h.b)(this,void 0,void 0,(function(){var n,r,i=this;return Object(h.d)(this,(function(o){switch(o.label){case 0:return t._s.Af(),y("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.Jl,t.ff((function(n){r.isEqual(n)||(r=n,t._s.po((function(){return Object(h.b)(i,void 0,void 0,(function(){return Object(h.d)(this,(function(t){switch(t.label){case 0:return[4,Xi(e.bh,n)];case 1:return t.sent(),[2]}}))}))})))})),e.persistence.Po((function(){return t.terminate()})),t.mf=e,[2]}}))}))}function pa(t,e){return Object(h.b)(this,void 0,void 0,(function(){var n,r;return Object(h.d)(this,(function(i){switch(i.label){case 0:return t._s.Af(),[4,da(t)];case 1:return n=i.sent(),y("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.ff((function(n){return t._s.po((function(){return function(t,e){return Object(h.b)(this,void 0,void 0,(function(){var n,r;return Object(h.d)(this,(function(i){switch(i.label){case 0:return(n=O(t))._s.Af(),y("RemoteStore","RemoteStore received new credentials"),r=$o(n),n.Nh.add(3),[4,Qo(n)];case 1:return i.sent(),r&&n.Oh.set("Unknown"),[4,n.Dh.n_(e)];case 2:return i.sent(),n.Nh.delete(3),[4,Ho(n)];case 3:return i.sent(),[2]}}))}))}(e.yl,n)}))})),t.If=e,[2]}}))}))}function da(t){return Object(h.b)(this,void 0,void 0,(function(){return Object(h.d)(this,(function(e){switch(e.label){case 0:return t.mf?[3,2]:(y("FirestoreClient","Using default OfflineComponentProvider"),[4,la(t,new hu)]);case 1:e.sent(),e.label=2;case 2:return[2,t.mf]}}))}))}function va(t){return Object(h.b)(this,void 0,void 0,(function(){return Object(h.d)(this,(function(e){switch(e.label){case 0:return t.If?[3,2]:(y("FirestoreClient","Using default OnlineComponentProvider"),[4,pa(t,new pu)]);case 1:e.sent(),e.label=2;case 2:return[2,t.If]}}))}))}function ya(t){return da(t).then((function(t){return t.persistence}))}function ga(t){return da(t).then((function(t){return t.bh}))}function ba(t){return va(t).then((function(t){return t.yl}))}function ma(t){return va(t).then((function(t){return t._a}))}function wa(t){return Object(h.b)(this,void 0,void 0,(function(){var e,n;return Object(h.d)(this,(function(r){switch(r.label){case 0:return[4,va(t)];case 1:return e=r.sent(),[2,((n=e.gl).jh=Ps.bind(null,e._a),n.Hh=Rs.bind(null,e._a),n)]}}))}))}function _a(t,e,n){var r=this;void 0===n&&(n={});var i=new rr;return t._s.Ps((function(){return Object(h.b)(r,void 0,void 0,(function(){var r;return Object(h.d)(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new du({next:function(o){e.Ps((function(){return ms(t,u)}));var s=o.docs.has(n);!s&&o.fromCache?i.reject(new q(D.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&o.fromCache&&r&&"server"===r.source?i.reject(new q(D.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),u=new Is(Wt(n.path),o,{includeMetadataChanges:!0,nl:!0});return bs(t,u)},[4,wa(t)];case 1:return[2,r.apply(void 0,[o.sent(),t._s,e,n,i])]}}))}))})),i.promise}function Ea(t,e,n){var r=this;void 0===n&&(n={});var i=new rr;return t._s.Ps((function(){return Object(h.b)(r,void 0,void 0,(function(){var r;return Object(h.d)(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new du({next:function(n){e.Ps((function(){return ms(t,u)})),n.fromCache&&"server"===r.source?i.reject(new q(D.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),u=new Is(n,o,{includeMetadataChanges:!0,nl:!0});return bs(t,u)},[4,wa(t)];case 1:return[2,r.apply(void 0,[o.sent(),t._s,e,n,i])]}}))}))})),i.promise}var Ia=function(){function t(){var t=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.Gu=new Mo(this,"async_queue_retry"),this.vf=function(){var e=Lo();e&&y("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Gu.qu()};var e=Lo();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.vf)}return Object.defineProperty(t.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),t.prototype.Ps=function(t){this.enqueue(t)},t.prototype.Tf=function(t){this.Sf(),this.Df(t)},t.prototype.Ef=function(){if(!this.yf){this.yf=!0;var t=Lo();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf)}},t.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise((function(t){})):this.Df(t)},t.prototype.po=function(t){var e=this;this.Ps((function(){return e.Pf.push(t),e.Cf()}))},t.prototype.Cf=function(){return Object(h.b)(this,void 0,void 0,(function(){var t,e=this;return Object(h.d)(this,(function(n){switch(n.label){case 0:if(0===this.Pf.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return n.sent(),this.Pf.shift(),this.Gu.reset(),[3,4];case 3:if(!cr(t=n.sent()))throw t;return y("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.Pf.length>0&&this.Gu.Lu((function(){return e.Cf()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Df=function(t){var e=this,n=this.Rf.then((function(){return e.pf=!0,t().catch((function(t){throw e.Vf=t,e.pf=!1,m("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.pf=!1,t}))}));return this.Rf=n,n},t.prototype.Tr=function(t,e,n){var r=this;this.Sf(),this.bf.indexOf(t)>-1&&(e=0);var i=dr.Ts(this,t,e,n,(function(t){return r.xf(t)}));return this.gf.push(i),i},t.prototype.Sf=function(){this.Vf&&E()},t.prototype.Af=function(){},t.prototype.Nf=function(){return Object(h.b)(this,void 0,void 0,(function(){var t;return Object(h.d)(this,(function(e){switch(e.label){case 0:return[4,t=this.Rf];case 1:e.sent(),e.label=2;case 2:if(t!==this.Rf)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.$f=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].fs===t)return!0;return!1},t.prototype.Ff=function(t){var e=this;return this.Nf().then((function(){e.gf.sort((function(t,e){return t.ds-e.ds}));for(var n=0,r=e.gf;n<r.length;n++){var i=r[n];if(i.Rs(),"all"!==t&&i.fs===t)break}return e.Nf()}))},t.prototype.Of=function(t){this.bf.push(t)},t.prototype.xf=function(t){var e=this.gf.indexOf(t);this.gf.splice(e,1)},t}();function Oa(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}!function(){function t(){this.kf={},this.Mf=new rr,this.Lf={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}t.prototype.onProgress=function(t,e,n){this.kf={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this.Mf.promise.catch(t)},t.prototype.then=function(t,e){return this.Mf.promise.then(t,e)},t.prototype.ql=function(t){this.Ul(t),this.kf.complete&&this.kf.complete(),this.Mf.resolve(t)},t.prototype.Kl=function(t){this.Lf.taskState="Error",this.kf.next&&this.kf.next(this.Lf),this.kf.error&&this.kf.error(t),this.Mf.reject(t)},t.prototype.Ul=function(t){this.Lf=t,this.kf.next&&this.kf.next(t)}}();var Ta=-1,ja=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).Bf=new Ia,r.w_="name"in e?e.name:"[DEFAULT]",r}return Object(h.c)(e,t),e.prototype.b_=function(){return this.qf||Aa(this),this.qf.terminate()},e}(Au);function Na(t){return t.qf||Aa(t),t.qf.df(),t.qf}function Aa(t){var e=t.p_(),n=function(t,e,n){return new f(t,e,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling)}(t.I_,t.w_,e);t.qf=new fa(t.m_,t.Bf,n)}function Sa(t,e,n){var r=this,i=new rr;return t._s.enqueue((function(){return Object(h.b)(r,void 0,void 0,(function(){var r;return Object(h.d)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,la(t,n)];case 1:return o.sent(),[4,pa(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===D.FAILED_PRECONDITION||t.code===D.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return i.promise}))}function xa(t){if(t.R_||t.P_)throw new q(D.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Da=function(){function t(){}return t.prototype.Uf=function(t,e){switch(void 0===e&&(e="none"),ut(t)){case 0:return null;case 1:return t.booleanValue;case 2:return $(t.integerValue||t.doubleValue);case 3:return this.Qf(t.timestampValue);case 4:return this.Kf(t,e);case 5:return t.stringValue;case 6:return this.Wf(tt(t.bytesValue));case 7:return this.jf(t.referenceValue);case 8:return this.Gf(t.geoPointValue);case 9:return this.zf(t.arrayValue,e);case 10:return this.Hf(t.mapValue,e);default:throw E()}},t.prototype.Hf=function(t,e){var n=this,r={};return X(t.fields||{},(function(t,i){r[t]=n.Uf(i,e)})),r},t.prototype.Gf=function(t){return new Lu($(t.latitude),$(t.longitude))},t.prototype.zf=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.Uf(t,e)}))},t.prototype.Kf=function(t,e){switch(e){case"previous":var n=nt(t);return null==n?null:this.Uf(n,e);case"estimate":return this.Qf(it(t));default:return null}},t.prototype.Qf=function(t){var e=Z(t);return new F(e.seconds,e.nanos)},t.prototype.Jf=function(t,e){var n=G.ot(t);I(hr(n));var r=new l(n.get(1),n.get(3)),i=new Y(n.Y(5));return r.isEqual(e)||m("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}(),ka=function(){function t(t,e,n,r,i){this.Yf=t,this.Xf=e,this.S_=n,this.Zf=r,this.v_=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Su(this.Yf,this.v_,this.S_)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this.Zf},t.prototype.data=function(){if(this.Zf){if(this.v_){var t=new Pa(this.Yf,this.Xf,this.S_,this.Zf,null);return this.v_.fromFirestore(t)}return this.Xf.Uf(this.Zf.bt())}},t.prototype.get=function(t){if(this.Zf){var e=this.Zf.data().field(Ca("DocumentSnapshot.get",t));if(null!==e)return this.Xf.Uf(e)}},t}(),Pa=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(h.c)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(ka);function Ca(t,e){return"string"==typeof e?sa(t,e):e instanceof gu?e.d_.f_:e.f_}function Ra(t){if(Zt(t)&&0===t.xt.length)throw new q(D.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var La=function(){};function Va(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o.td(t)}return t}var Ma=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).ed=e,i.nd=n,i.sd=r,i.type="where",i}return Object(h.c)(e,t),e.prototype.td=function(t){var e=Bu(t.firestore),n=function(t,e,n,r,i,o,u){var s;if(i.ut()){if("array-contains"===o||"array-contains-any"===o)throw new q(D.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Ha(u,o);for(var a=[],c=0,h=u;c<h.length;c++){var f=h[c];a.push(Ga(r,t,f))}s={arrayValue:{values:a}}}else s=Ga(r,t,u)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Ha(u,o),s=$u(n,"where",u,"in"===o||"not-in"===o);var l=Pt.create(i,o,s);return function(t,e){if(e.Ct()){var n=te(t);if(null!==n&&!n.isEqual(e.field))throw new q(D.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=$t(t);null!==r&&Qa(t,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new q(D.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new q(D.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,l),l}(t.C_,0,e,t.firestore.I_,this.ed,this.nd,this.sd);return new xu(t.firestore,t.v_,function(t,e){var n=t.filters.concat([e]);return new Kt(t.path,t.collectionGroup,t.xt.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,n))},e}(La),Ua=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).ed=e,r.rd=n,r.type="orderBy",r}return Object(h.c)(e,t),e.prototype.td=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new q(D.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new q(D.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Gt(e,n);return function(t,e){if(null===$t(t)){var n=te(t);null!==n&&Qa(t,n,e.field)}}(t,r),r}(t.C_,this.ed,this.rd);return new xu(t.firestore,t.v_,function(t,e){var n=t.xt.concat([e]);return new Kt(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,e))},e}(La),Fa=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.od=n,i.ad=r,i}return Object(h.c)(e,t),e.prototype.td=function(t){return new xu(t.firestore,t.v_,ie(t.C_,this.od,this.ad))},e}(La),qa=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.ud=n,i.hd=r,i}return Object(h.c)(e,t),e.prototype.td=function(t){var e=Ba(t,this.type,this.ud,this.hd);return new xu(t.firestore,t.v_,function(t,e){return new Kt(t.path,t.collectionGroup,t.xt.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t.C_,e))},e}(La),za=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.ud=n,i.hd=r,i}return Object(h.c)(e,t),e.prototype.td=function(t){var e=Ba(t,this.type,this.ud,this.hd);return new xu(t.firestore,t.v_,function(t,e){return new Kt(t.path,t.collectionGroup,t.xt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t.C_,e))},e}(La);function Ba(t,e,n,r){if(n[0]instanceof gu&&(n[0]=n[0].d_),n[0]instanceof ka)return function(t,e,n,r,i){if(!r)throw new q(D.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],u=0,s=ne(t);u<s.length;u++){var a=s[u];if(a.field.ut())o.push(vt(e,r.key));else{var c=r.field(a.field);if(et(c))throw new q(D.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=a.field.rt();throw new q(D.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new zt(o,i)}(t.C_,t.firestore.I_,e,n[0].Zf,r);var i=Bu(t.firestore);return function(t,e,n,r,i,o){var u=t.xt;if(i.length>u.length)throw new q(D.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var s=[],a=0;a<i.length;a++){var c=i[a];if(u[a].field.ut()){if("string"!=typeof c)throw new q(D.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!ee(t)&&-1!==c.indexOf("/"))throw new q(D.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(G.ot(c));if(!Y.wt(h))throw new q(D.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var f=new Y(h);s.push(vt(e,f))}else{var l=$u(n,r,c);s.push(l)}}return new zt(s,o)}(t.C_,t.firestore.I_,i,e,n,r)}function Ga(t,e,n){if(n instanceof gu&&(n=n.d_),"string"==typeof n){if(""===n)throw new q(D.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!ee(e)&&-1!==n.indexOf("/"))throw new q(D.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(G.ot(n));if(!Y.wt(r))throw new q(D.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return vt(t,new Y(r))}if(n instanceof Su)return vt(t,n.S_);throw new q(D.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Iu(n)+".")}function Ha(t,e){if(!Array.isArray(t)||0===t.length)throw new q(D.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new q(D.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Qa(t,e,n){if(!n.isEqual(e))throw new q(D.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Ya(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Ka=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(h.c)(e,t),e.prototype.Wf=function(t){return new k(t)},e.prototype.jf=function(t){var e=this.Jf(t,this.firestore.I_);return new Su(this.firestore,null,e)},e}(Da),Xa=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Wa=function(t){function e(e,n,r,i,o,u){var s=this;return(s=t.call(this,e,n,r,i,u)||this).Yf=e,s.ld=e,s.metadata=o,s}return Object(h.c)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this.Zf){if(this.v_){var e=new Ja(this.Yf,this.Xf,this.S_,this.Zf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Xf.Uf(this.Zf.bt(),t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Zf){var n=this.Zf.data().field(Ca("DocumentSnapshot.get",t));if(null!==n)return this.Xf.Uf(n,e.serverTimestamps)}},e}(ka),Ja=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(h.c)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(Wa),Za=function(){function t(t,e,n,r){this.Yf=t,this.Xf=e,this._d=r,this.metadata=new Xa(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._d.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._d.docs.forEach((function(r){t.call(e,new Ja(n.Yf,n.Xf,r.key,r,new Xa(n._d.De.has(r.key),n._d.fromCache),n.query.v_))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._d.xe)throw new q(D.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.fd&&this.dd===e||(this.fd=function(t,e){if(t._d.Se.et()){var n=0;return t._d.docChanges.map((function(e){var r=new Ja(t.Yf,t.Xf,e.doc.key,e.doc,new Xa(t._d.De.has(e.doc.key),t._d.fromCache),t.query.v_);return e.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}}))}var r=t._d.Se;return t._d.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new Ja(t.Yf,t.Xf,e.doc.key,e.doc,new Xa(t._d.De.has(e.doc.key),t._d.fromCache),t.query.v_),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:$a(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this.dd=e),this.fd},t}();function $a(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return E()}}function tc(t,e){return t instanceof Wa&&e instanceof Wa?t.Yf===e.Yf&&t.S_.isEqual(e.S_)&&(null===t.Zf?null===e.Zf:t.Zf.isEqual(e.Zf))&&t.v_===e.v_:t instanceof Za&&e instanceof Za&&t.Yf===e.Yf&&Ru(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._d.isEqual(e._d)}var ec=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(h.c)(e,t),e.prototype.Wf=function(t){return new k(t)},e.prototype.jf=function(t){var e=this.Jf(t,this.firestore.I_);return new Su(this.firestore,null,e)},e}(Da);function nc(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Ou(t,Su);var o=Ou(t.firestore,ja),u=Bu(o);return e instanceof gu&&(e=e.d_),ic(o,[("string"==typeof e||e instanceof vu?Zu(u,"updateDoc",t.S_,e,n,r):Ju(u,"updateDoc",t.S_,e)).F_(t.S_,Se.exists(!0))])}function rc(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t instanceof gu&&(t=t.d_);var u={includeMetadataChanges:!1},s=0;"object"!=typeof i[s]||Oa(i[s])||(u=i[s],s++);var a,c,f,l={includeMetadataChanges:u.includeMetadataChanges};if(Oa(i[s])){var d=i[s];i[s]=null===(e=d.next)||void 0===e?void 0:e.bind(d),i[s+1]=null===(n=d.error)||void 0===n?void 0:n.bind(d),i[s+2]=null===(r=d.complete)||void 0===r?void 0:r.bind(d)}if(t instanceof Su)c=Ou(t.firestore,ja),f=Wt(t.S_.path),a={next:function(e){i[s]&&i[s](oc(c,t,e))},error:i[s+1],complete:i[s+2]};else{var p=Ou(t,xu);c=Ou(p.firestore,ja),f=p.C_;var v=new ec(c);a={next:function(t){i[s]&&i[s](new Za(c,v,p,t))},error:i[s+1],complete:i[s+2]},Ra(t.C_)}return function(t,e,n,r){var i=this,o=new du(r),u=new Is(e,o,n);return t._s.Ps((function(){return Object(h.b)(i,void 0,void 0,(function(){var e;return Object(h.d)(this,(function(n){switch(n.label){case 0:return e=bs,[4,wa(t)];case 1:return[2,e.apply(void 0,[n.sent(),u])]}}))}))})),function(){o.i_(),t._s.Ps((function(){return Object(h.b)(i,void 0,void 0,(function(){var e;return Object(h.d)(this,(function(n){switch(n.label){case 0:return e=ms,[4,wa(t)];case 1:return[2,e.apply(void 0,[n.sent(),u])]}}))}))}))}}(Na(c),f,l,a)}function ic(t,e){return function(t,e){var n=this,r=new rr;return t._s.Ps((function(){return Object(h.b)(n,void 0,void 0,(function(){var n;return Object(h.d)(this,(function(i){switch(i.label){case 0:return n=Ls,[4,ma(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(Na(t),e)}function oc(t,e,n){var r=n.docs.get(e.S_),i=new ec(t);return new Wa(t,i,e.S_,r,new Xa(n.hasPendingWrites,n.fromCache),e.v_)}var sc=function(){function t(t,e){this.Yf=t,this.wd=e,this.Ed=[],this.Td=!1,this.Id=Bu(t)}return t.prototype.set=function(t,e,n){this.md();var r=uc(t,this.Yf),i=Ya(r.v_,e,n),o=Gu(this.Id,"WriteBatch.set",r.S_,i,null!==r.v_,n);return this.Ed.push(o.F_(r.S_,Se.Kt())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.md();var o,u=uc(t,this.Yf);return e instanceof gu&&(e=e.d_),o="string"==typeof e||e instanceof vu?Zu(this.Id,"WriteBatch.update",u.S_,e,n,r):Ju(this.Id,"WriteBatch.update",u.S_,e),this.Ed.push(o.F_(u.S_,Se.exists(!0))),this},t.prototype.delete=function(t){this.md();var e=uc(t,this.Yf);return this.Ed=this.Ed.concat(new He(e.S_,Se.Kt())),this},t.prototype.commit=function(){return this.md(),this.Td=!0,this.Ed.length>0?this.wd(this.Ed):Promise.resolve()},t.prototype.md=function(){if(this.Td)throw new q(D.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function uc(t,e){if(t instanceof gu&&(t=t.d_),t.firestore!==e)throw new q(D.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var ac=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).Yf=e,r}return Object(h.c)(e,t),e.prototype.get=function(e){var n=this,r=uc(e,this.Yf),i=new ec(this.Yf);return t.prototype.get.call(this,e).then((function(t){return new Wa(n.Yf,i,r.S_,t.Zf,new Xa(!1,!1),r.v_)}))},e}(function(){function t(t,e){this.Yf=t,this.Ad=e,this.Id=Bu(t)}return t.prototype.get=function(t){var e=this,n=uc(t,this.Yf),r=new Ka(this.Yf);return this.Ad.ef([n.S_]).then((function(t){if(!t||1!==t.length)return E();var i=t[0];if(i instanceof jt)return new ka(e.Yf,r,n.S_,null,n.v_);if(i instanceof Tt)return new ka(e.Yf,r,i.key,i,n.v_);throw E()}))},t.prototype.set=function(t,e,n){var r=uc(t,this.Yf),i=Ya(r.v_,e,n),o=Gu(this.Id,"Transaction.set",r.S_,i,null!==r.v_,n);return this.Ad.set(r.S_,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,u=uc(t,this.Yf);return e instanceof gu&&(e=e.d_),o="string"==typeof e||e instanceof vu?Zu(this.Id,"Transaction.update",u.S_,e,n,r):Ju(this.Id,"Transaction.update",u.S_,e),this.Ad.update(u.S_,o),this},t.prototype.delete=function(t){var e=uc(t,this.Yf);return this.Ad.delete(e.S_),this},t}());function cc(){if("undefined"==typeof Uint8Array)throw new q(D.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function hc(){if("undefined"==typeof atob)throw new q(D.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var fc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(h.c)(e,t),e.fromBase64String=function(t){return hc(),new e(k.fromBase64String(t))},e.fromUint8Array=function(t){return cc(),new e(k.fromUint8Array(t))},e.prototype.toBase64=function(){return hc(),this.d_.toBase64()},e.prototype.toUint8Array=function(){return cc(),this.d_.toUint8Array()},e.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(gu),lc=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){xa(t=Ou(t,ja));var n=Na(t),r=t.p_(),i=new pu;return Sa(n,i,new fu(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t.d_,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){xa(t=Ou(t,ja));var e=Na(t),n=t.p_(),r=new pu;return Sa(e,r,new lu(r,n.cacheSizeBytes))}(t.d_)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t.R_&&!t.P_)throw new q(D.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new rr;return t.Bf.Tf((function(){return Object(h.b)(e,void 0,void 0,(function(){var e;return Object(h.d)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Object(h.b)(this,void 0,void 0,(function(){var e;return Object(h.d)(this,(function(n){switch(n.label){case 0:return sr.Kn()?(e=t+"main",[4,sr.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(zi(t.I_,t.w_))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t.d_)},t}(),pc=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n)||this).Rd=r,i.INTERNAL={delete:function(){return i.terminate()}},e instanceof l||(i.Pd=e),i}return Object(h.c)(e,t),Object.defineProperty(e.prototype,"I_",{get:function(){return this.d_.I_},enumerable:!1,configurable:!0}),e.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.d_.V_()),t)).merge,this.d_.g_(t)},e.prototype.useEmulator=function(t,e){!function(t,e,n){var r=(t=Ou(t,Au)).V_();"firestore.googleapis.com"!==r.host&&r.host!==e&&w("Host has been set in both settings() and useEmulator(), emulator host will be used"),t.g_(Object.assign(Object.assign({},r),{host:e+":"+n,ssl:!1}))}(this.d_,t,e)},e.prototype.enableNetwork=function(){return function(t){var e=this;return t._s.enqueue((function(){return Object(h.b)(e,void 0,void 0,(function(){var e,n;return Object(h.d)(this,(function(r){switch(r.label){case 0:return[4,ya(t)];case 1:return e=r.sent(),[4,ba(t)];case 2:return n=r.sent(),[2,(e.yo(!0),function(t){var e=O(t);return e.Nh.delete(0),Ho(e)}(n))]}}))}))}))}(Na(Ou(this.d_,ja)))},e.prototype.disableNetwork=function(){return function(t){var e=this;return t._s.enqueue((function(){return Object(h.b)(e,void 0,void 0,(function(){var e,n;return Object(h.d)(this,(function(r){switch(r.label){case 0:return[4,ya(t)];case 1:return e=r.sent(),[4,ba(t)];case 2:return n=r.sent(),[2,(e.yo(!1),function(t){return Object(h.b)(this,void 0,void 0,(function(){var e;return Object(h.d)(this,(function(n){switch(n.label){case 0:return(e=O(t)).Nh.add(0),[4,Qo(e)];case 1:return n.sent(),e.Oh.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(Na(Ou(this.d_,ja)))},e.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&wu("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Rd.enableMultiTabIndexedDbPersistence(this):this.Rd.enableIndexedDbPersistence(this,n)},e.prototype.clearPersistence=function(){return this.Rd.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.Pd&&(this.Pd._removeServiceInstance("firestore"),this.Pd._removeServiceInstance("firestore-exp")),this.d_._delete()},e.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new rr;return t._s.Ps((function(){return Object(h.b)(e,void 0,void 0,(function(){var e;return Object(h.d)(this,(function(r){switch(r.label){case 0:return e=zs,[4,ma(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(Na(Ou(this.d_,ja)))},e.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new du(e);return t._s.Ps((function(){return Object(h.b)(n,void 0,void 0,(function(){var e;return Object(h.d)(this,(function(n){switch(n.label){case 0:return e=function(t,e){O(t).Wh.add(e),e.next()},[4,wa(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.i_(),t._s.Ps((function(){return Object(h.b)(n,void 0,void 0,(function(){var e;return Object(h.d)(this,(function(n){switch(n.label){case 0:return e=function(t,e){O(t).Wh.delete(e)},[4,wa(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))}))}}(Na(t=Ou(t,ja)),Oa(e)?e:{next:e})}(this.d_,t)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.Pd)throw new q(D.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Pd},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new Ac(this,ku(this.d_,t))}catch(t){throw wc(t,"collection()","Firestore.collection()")}},e.prototype.doc=function(t){try{return new mc(this,Pu(this.d_,t))}catch(t){throw wc(t,"doc()","Firestore.doc()")}},e.prototype.collectionGroup=function(t){try{return new Tc(this,function(t,e){if(t=Ou(t,Au),bu("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new q(D.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new xu(t,null,function(t){return new Kt(G.ct(),t)}(e))}(this.d_,t))}catch(t){throw wc(t,"collectionGroup()","Firestore.collectionGroup()")}},e.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new rr;return t._s.Ps((function(){return Object(h.b)(n,void 0,void 0,(function(){var n;return Object(h.d)(this,(function(i){switch(i.label){case 0:return[4,function(t){return va(t).then((function(t){return t.Sh}))}(t)];case 1:return n=i.sent(),new ha(t._s,n,e,r).run(),[2]}}))}))})),r.promise}(Na(t),(function(n){return e(new ac(t,n))}))}(this.d_,(function(n){return t(new yc(e,n))}))},e.prototype.batch=function(){var t=this;return Na(this.d_),new gc(new sc(this.d_,(function(e){return ic(t.d_,e)})))},e.prototype.loadBundle=function(t){throw new q(D.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},e.prototype.namedQuery=function(t){throw new q(D.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},e}(gu),dc=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(h.c)(e,t),e.prototype.Wf=function(t){return new fc(new k(t))},e.prototype.jf=function(t){var e=this.Jf(t,this.firestore.I_);return mc.yd(e,this.firestore,null)},e}(Da);function vc(t){var e;e=t,d.setLogLevel(e)}var yc=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).Yf=e,r.Xf=new dc(e),r}return Object(h.c)(e,t),e.prototype.get=function(t){var e=this,n=Sc(t);return this.d_.get(n).then((function(t){return new Ic(e.Yf,new Wa(e.Yf.d_,e.Xf,t.S_,t.Zf,t.metadata,n.v_))}))},e.prototype.set=function(t,e,n){var r=Sc(t);return n?(mu("Transaction.set",n),this.d_.set(r,e,n)):this.d_.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var u=Sc(t);return 2===arguments.length?this.d_.update(u,e):(r=this.d_).update.apply(r,Object(h.g)([u,e,n],i)),this},e.prototype.delete=function(t){var e=Sc(t);return this.d_.delete(e),this},e}(gu),gc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(h.c)(e,t),e.prototype.set=function(t,e,n){var r=Sc(t);return n?(mu("WriteBatch.set",n),this.d_.set(r,e,n)):this.d_.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var u=Sc(t);return 2===arguments.length?this.d_.update(u,e):(r=this.d_).update.apply(r,Object(h.g)([u,e,n],i)),this},e.prototype.delete=function(t){var e=Sc(t);return this.d_.delete(e),this},e.prototype.commit=function(){return this.d_.commit()},e}(gu),bc=function(t){function e(e,n,r){var i=this;return(i=t.call(this,r)||this).Yf=e,i.Xf=n,i}return Object(h.c)(e,t),e.prototype.fromFirestore=function(t,e){var n=new Ja(this.Yf.d_,this.Xf,t.S_,t.Zf,t.metadata,null);return this.d_.fromFirestore(new Oc(this.Yf,n),null!=e?e:{})},e.prototype.toFirestore=function(t,e){return e?this.d_.toFirestore(t,e):this.d_.toFirestore(t)},e.gd=function(t,n){var r=e.Vd,i=r.get(t);i||(i=new WeakMap,r.set(t,i));var o=i.get(n);return o||(o=new e(t,new dc(t),n),i.set(n,o)),o},e}(gu);bc.Vd=new WeakMap;var mc=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Xf=new dc(e),r}return Object(h.c)(e,t),e.pd=function(t,n,r){if(t.length%2!=0)throw new q(D.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.rt()+" has "+t.length);return new e(n,new Su(n.d_,r,new Y(t)))},e.yd=function(t,n,r){return new e(n,new Su(n.d_,r,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new Ac(this.firestore,this.d_.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.d_.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new Ac(this.firestore,ku(this.d_,t))}catch(t){throw wc(t,"collection()","DocumentReference.collection()")}},e.prototype.isEqual=function(t){return t instanceof gu&&(t=t.d_),t instanceof Su&&Cu(this.d_,t)},e.prototype.set=function(t,e){e=mu("DocumentReference.set",e);try{return function(t,e,n){t=Ou(t,Su);var r=Ou(t.firestore,ja),i=Ya(t.v_,e,n);return ic(r,[Gu(Bu(r),"setDoc",t.S_,i,null!==t.v_,n).F_(t.S_,Se.Kt())])}(this.d_,t,e)}catch(t){throw wc(t,"setDoc()","DocumentReference.set()")}},e.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?nc(this.d_,t):nc.apply(void 0,Object(h.g)([this.d_,t,e],n))}catch(t){throw wc(t,"updateDoc()","DocumentReference.update()")}},e.prototype.delete=function(){return ic(Ou((t=this.d_).firestore,ja),[new He(t.S_,Se.Kt())]);var t},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=_c(e),i=Ec(e,(function(e){return new Ic(t.firestore,new Wa(t.firestore.d_,t.Xf,e.S_,e.Zf,e.metadata,t.d_.v_))}));return rc(this.d_,r,i)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Ou(t,Su);var e=Ou(t.firestore,ja),n=Na(e),r=new ec(e);return function(t,e){var n=this,r=new rr;return t._s.Ps((function(){return Object(h.b)(n,void 0,void 0,(function(){var n;return Object(h.d)(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(h.b)(this,void 0,void 0,(function(){var r,i;return Object(h.d)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=O(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Tc.Ho(t,e)}))}(t,e)];case 1:return(i=o.sent())instanceof Tt?n.resolve(i):i instanceof jt?n.resolve(null):n.reject(new q(D.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=vr(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}}))}))},[4,ga(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t.S_).then((function(n){return new Wa(e,r,t.S_,n,new Xa(n instanceof Tt&&n.Vt,!0),t.v_)}))}(this.d_):"server"===(null==t?void 0:t.source)?function(t){t=Ou(t,Su);var e=Ou(t.firestore,ja);return _a(Na(e),t.S_,{source:"server"}).then((function(n){return oc(e,t,n)}))}(this.d_):function(t){t=Ou(t,Su);var e=Ou(t.firestore,ja);return _a(Na(e),t.S_).then((function(n){return oc(e,t,n)}))}(this.d_)).then((function(t){return new Ic(e.firestore,new Wa(e.firestore.d_,e.Xf,t.S_,t.Zf,t.metadata,e.d_.v_))}))},e.prototype.withConverter=function(t){return new e(this.firestore,this.d_.withConverter(bc.gd(this.firestore,t)))},e}(gu);function wc(t,e,n){return t.message=t.message.replace(e,n),t}function _c(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Oa(r))return r}return{}}function Ec(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=Oa(t[0])?t[0]:Oa(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var Ic=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).Yf=e,r}return Object(h.c)(e,t),Object.defineProperty(e.prototype,"ref",{get:function(){return new mc(this.Yf,this.d_.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this.d_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this.d_.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(t){return this.d_.data(t)},e.prototype.get=function(t,e){return this.d_.get(t,e)},e.prototype.isEqual=function(t){return tc(this.d_,t.d_)},e}(gu),Oc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(h.c)(e,t),e.prototype.data=function(t){return this.d_.data(t)},e}(Ic),Tc=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Xf=new dc(e),r}return Object(h.c)(e,t),e.prototype.where=function(t,n,r){try{return new e(this.firestore,Va(this.d_,function(t,e,n){var r=e,i=Ca("where",t);return new Ma(i,r,n)}(t,n,r)))}catch(t){throw wc(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.orderBy=function(t,n){try{return new e(this.firestore,Va(this.d_,function(t,e){void 0===e&&(e="asc");var n=e,r=Ca("orderBy",t);return new Ua(r,n)}(t,n)))}catch(t){throw wc(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.limit=function(t){try{return new e(this.firestore,Va(this.d_,function(t){return Tu("limit",t),new Fa("limit",t,"F")}(t)))}catch(t){throw wc(t,"limit()","Query.limit()")}},e.prototype.limitToLast=function(t){try{return new e(this.firestore,Va(this.d_,function(t){return Tu("limitToLast",t),new Fa("limitToLast",t,"L")}(t)))}catch(t){throw wc(t,"limitToLast()","Query.limitToLast()")}},e.prototype.startAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Va(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new qa("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw wc(t,"startAt()","Query.startAt()")}},e.prototype.startAfter=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Va(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new qa("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw wc(t,"startAfter()","Query.startAfter()")}},e.prototype.endBefore=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Va(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new za("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw wc(t,"endBefore()","Query.endBefore()")}},e.prototype.endAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Va(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new za("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw wc(t,"endAt()","Query.endAt()")}},e.prototype.isEqual=function(t){return Ru(this.d_,t.d_)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Ou(t,xu);var e=Ou(t.firestore,ja),n=Na(e),r=new ec(e);return function(t,e){var n=this,r=new rr;return t._s.Ps((function(){return Object(h.b)(n,void 0,void 0,(function(){var n;return Object(h.d)(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(h.b)(this,void 0,void 0,(function(){var r,i,o,u,s;return Object(h.d)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,ro(t,e,!0)];case 1:return s=a.sent(),r=new Ss(e,s.Rc),i=r.fl(s.documents),o=r.wi(i,!1),n.resolve(o.snapshot),[3,3];case 2:return u=a.sent(),s=vr(u,"Failed to execute query '"+e+" against cache"),n.reject(s),[3,3];case 3:return[2]}}))}))},[4,ga(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t.C_).then((function(n){return new Za(e,r,t,n)}))}(this.d_):"server"===(null==t?void 0:t.source)?function(t){t=Ou(t,xu);var e=Ou(t.firestore,ja),n=Na(e),r=new ec(e);return Ea(n,t.C_,{source:"server"}).then((function(n){return new Za(e,r,t,n)}))}(this.d_):function(t){t=Ou(t,xu);var e=Ou(t.firestore,ja),n=Na(e),r=new ec(e);return Ra(t.C_),Ea(n,t.C_).then((function(n){return new Za(e,r,t,n)}))}(this.d_)).then((function(t){return new Nc(e.firestore,new Za(e.firestore.d_,e.Xf,e.d_,t._d))}))},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=_c(e),i=Ec(e,(function(e){return new Nc(t.firestore,new Za(t.firestore.d_,t.Xf,t.d_,e._d))}));return rc(this.d_,r,i)},e.prototype.withConverter=function(t){return new e(this.firestore,this.d_.withConverter(bc.gd(this.firestore,t)))},e}(gu),jc=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).Yf=e,r}return Object(h.c)(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this.d_.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new Oc(this.Yf,this.d_.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this.d_.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this.d_.newIndex},enumerable:!1,configurable:!0}),e}(gu),Nc=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).Yf=e,r}return Object(h.c)(e,t),Object.defineProperty(e.prototype,"query",{get:function(){return new Tc(this.Yf,this.d_.query)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this.d_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.d_.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this.d_.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var t=this;return this.d_.docs.map((function(e){return new Oc(t.Yf,e)}))},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(t){var e=this;return this.d_.docChanges(t).map((function(t){return new jc(e.Yf,t)}))},e.prototype.forEach=function(t,e){var n=this;this.d_.forEach((function(r){t.call(e,new Oc(n.Yf,r))}))},e.prototype.isEqual=function(t){return tc(this.d_,t.d_)},e}(gu),Ac=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r.d_=n,r}return Object(h.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.d_.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.d_.parent;return t?new mc(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new mc(this.firestore,void 0===t?Pu(this.d_):Pu(this.d_,t))}catch(t){throw wc(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=Ou(t.firestore,ja),r=Pu(t),i=Ya(t.v_,e);return ic(n,[Gu(Bu(t.firestore),"addDoc",r.S_,i,null!==t.v_,{}).F_(r.S_,Se.exists(!1))]).then((function(){return r}))}(this.d_,t).then((function(t){return new mc(e.firestore,t)}))},e.prototype.isEqual=function(t){return Cu(this.d_,t.d_)},e.prototype.withConverter=function(t){return new e(this.firestore,this.d_.withConverter(bc.gd(this.firestore,t)))},e}(Tc);function Sc(t){return t instanceof gu&&(t=t.d_),Ou(t,Su)}var xc=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,new(vu.bind.apply(vu,Object(h.g)([void 0],e))))||this}return Object(h.c)(e,t),e.documentId=function(){return new e(Q.ht().rt())},e.prototype.isEqual=function(t){return t instanceof gu&&(t=t.d_),t instanceof vu&&this.d_.f_.isEqual(t.f_)},e}(gu),Dc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(h.c)(e,t),e.serverTimestamp=function(){var t=new Yu("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new Hu("deleteField");return t._methodName="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ku("arrayUnion",t)}.apply(void 0,t);return r._methodName="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Xu("arrayRemove",t)}.apply(void 0,t);return r._methodName="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(t){return new Wu("increment",t)}(t);return n._methodName="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},e}(gu)}).call(this,n(168))},432:function(t,e,n){"use strict";n.r(e);var r,o=n(368),c=(n(373),n(372),n(403),n(425)),h=n(399),f={Firestore:c.e,GeoPoint:c.j,Timestamp:c.c,Blob:c.d,Transaction:c.o,WriteBatch:c.a,DocumentReference:c.b,DocumentSnapshot:c.k,Query:c.m,QueryDocumentSnapshot:c.r,QuerySnapshot:c.q,CollectionReference:c.n,FieldPath:c.p,FieldValue:c.l,setLogLevel:c.g,CACHE_SIZE_UNLIMITED:c.i};(function(t,e){t.INTERNAL.registerComponent(new h.a("firestore",(function(t){return function(t,s){return new c.e(t,new c.h(t,s),new c.f)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},f)))})(r=o.a),r.registerVersion("@firebase/firestore","2.1.7")}}]);